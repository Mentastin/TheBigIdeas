\chapter{Measurement theory}

\chapter{Postulates}

\section{States, observables and measurement}
\subsection{States}
\begin{definition}
A \udef{state} on a Hilbert space is a positive trace class operator with trace $1$.
\end{definition}

\begin{proposition}
Let $\rho$ be a state. The following are equivalent:
\begin{enumerate}
\item $\rho$ is extremal;
\item $\rho$ is a projector;
\item $\rho = \rho^2$;
\item $\Tr[\rho^2] = 1$;
\item $\norm{\rho} = 1$;
\item $S(\rho) \defeq -\Tr[\rho\ln\rho] = 0$.
\end{enumerate}
\end{proposition}
The quantity $S(\rho) \defeq -\Tr[\rho\ln\rho]$ is called the \udef{von Neumann entropy}.

\subsection{Effects}
\begin{definition}
An \udef{effect} on a Hilbert space is a bounded operator in $[0,\id]$.
\end{definition}

\chapter{Quantum theory}
\section{Quantum statistics}
\begin{definition}
Let $\hilbert$ be a Hilbert space, $A$ a symmetric operator on $\hilbert$ and $\psi$ a unit vector in $\dom(A)$. Then we define
\begin{itemize}
\item the \udef{expectation value} of $A$ at $\psi$ is defined as $\expval{A}_\psi \defeq Q_A(\psi) = \braket[A]{\psi}{\psi}$;
\item the \udef{uncertainty} or \udef{standard deviation} of $A$ at $\psi$ is defined as
\[ \var_\psi A \defeq \norm{\big(A - \expval{A}_\psi\id\big)\psi}. \]
\end{itemize}
\end{definition}
The expectation value $\expval{A}_\psi$ is always real (by \zref{m-symmetricRealQuadraticForm}).

\begin{lemma}
$\expval{A}_\psi = \braket[A]{\psi}{\psi} = \Tr\big(A\ketbra{\psi}{\psi}\big)$.
\end{lemma}

\begin{lemma}
Let $\hilbert$ be a Hilbert space, $A$ a symmetric operator on $\hilbert$ and $\psi$ a unit vector in $\dom(A)$. Then $\var_\psi A = 0$ \textup{if and only if} $\psi$ is an eigenvalue of $A$.

In this case the eigenvalue of $\psi$ is $\expval{A}_\psi$.
\end{lemma}
\begin{proof}
Assume $\var_\psi A = \norm{\big(A - \expval{A}_\psi\id\big)\psi} = 0$. Then $\big(A - \expval{A}_\psi\id\big)\psi = 0$, or $A\psi = \expval{A}_\psi\psi$, which means that $\psi$ is an eigenvector with eigenvalue $\expval{A}_\psi$.

Conversely, suppose $\psi$ is an eigenvector of $A$ with eigenvalue $\lambda$, i.e.\ $A\psi = \lambda \psi$. Then
\[ \expval{A}_\psi = \inner{\psi, A\psi} = \inner{\psi, \lambda\psi} = \lambda\inner{\psi,\psi} = \lambda. \]
Thus $A\psi = \expval{A}_\psi\psi$ and $\var_\psi A = 0$.
\end{proof}

\begin{lemma}
Let $\hilbert$ be a Hilbert space, $A$ a symmetric operator on $\hilbert$ and $\psi$ a unit vector in $\dom(A)$. Then
\[ \big(\var_\psi A\big)^2 = \inner{\big(A - \expval{A}_\psi\id\big)\psi, \big(A - \expval{A}_\psi\id\big)\psi} = \inner{A\psi,A\psi} - \expval{A}_\psi^2. \]
If $\psi$ is also in $\dom(A^2)$, then
\[ \big(\var_\psi A\big)^2 = \expval{(A - \expval{A}_\psi\id)^2}_\psi = \expval{A^2}_\psi - \expval{A}_\psi^2. \]
\end{lemma}
\begin{proof}
We calculate (using symmetry, the fact that $\expval{A}_\psi$ is real and the fact that $\psi$ is a unit vector)
\begin{align*}
\big(\var_\psi A\big)^2 &= \inner{\big(A - \expval{A}_\psi\id\big)\psi, \big(A - \expval{A}_\psi\id\big)\psi} \\
&= \inner{A\psi,A\psi} - \inner{A\psi, \expval{A}_\psi\psi} - \inner{\expval{A}_\psi\psi, A\psi} + \inner{\expval{A}_\psi\psi, \expval{A}_\psi\psi} \\
&= \inner{A\psi,A\psi} - \expval{A}_\psi\inner{\psi, A\psi} - \expval{A}_\psi\inner{\psi, A\psi} + \expval{A}_\psi^2\cancel{\inner{\psi, \psi}} \\
&= \inner{A\psi,A\psi} - \expval{A}_\psi^2 - \expval{A}_\psi^2 + \expval{A}_\psi^2 \\
&= \inner{A\psi,A\psi} - \expval{A}_\psi^2.
\end{align*}

Now assume $\psi\in \dom(A^2)$. Then $\psi\in \dom\big((A- \expval{A}_\psi\id)^2\big)$ and thus $(A- \expval{A}_\psi\id)\psi \in \dom\big(A- \expval{A}_\psi\id\big)$. The first equality follows by symmetry. For the second equality we have a similar reasoning starting from the equation above.
\end{proof}

\subsection{Uncertainty relations}
\begin{theorem}[Heisenberg's uncertainty principle]
Let $\hilbert$ be a Hilbert space and $A,B$ symmetric operators on $\hilbert$. Let $\psi$ be a unit vector in $\dom(AB)\cap \dom(BA)$. Then
\[ (\var_\psi A)(\var_\psi B) \geq \frac{1}{2}\big|\expval{\commutator{A,B}}_\psi\big|. \]
\end{theorem}
\begin{proof}
By the Cauchy-Schwarz inequality, \zref{m-CauchySchwarz}, we have
\begin{align*}
(\var_\psi A)(\var_\psi B) &= \norm{\big(A - \expval{A}_\psi\id\big)\psi}\;\norm{\big(B - \expval{B}_\psi\id\big)\psi} \\
&\geq |\inner{\big(A - \expval{A}_\psi\id\big)\psi, \big(B - \expval{B}_\psi\id\big)\psi}| \\
&\geq |\Im\inner{\big(A - \expval{A}_\psi\id\big)\psi, \big(B - \expval{B}_\psi\id\big)\psi}| \\
&= |\Im\Big(\inner{A\psi, B\psi} - \inner{A\psi, \expval{B}_\psi\psi} - \inner{\expval{A}_\psi\psi, B\psi} + \inner{\expval{A}_\psi\psi, \expval{B}_\psi\psi}\Big)| \\
&= |\Im\Big(\inner{A\psi, B\psi} - \cancel{\expval{A}_\psi\expval{B}_\psi}\Big)| \\
&= \frac{1}{2}|\inner{A\psi, B\psi} - \overline{\inner{A\psi, B\psi}}| = \frac{1}{2}|\inner{A\psi, B\psi} - \inner{B\psi, A\psi}|.
\end{align*}
Since $\psi \in \dom(AB)$, we have $B\psi\in \dom(A)$. Similarly $A\psi\in \dom(B)$. Thus, by symmetry, we have 
\[ \frac{1}{2}|\inner{A\psi, B\psi} - \inner{B\psi, A\psi}| = \frac{1}{2}|\inner{\psi, AB\psi} - \inner{\psi, BA\psi}| = \frac{1}{2}|\inner{\psi, \commutator{A,B}\psi}| = \frac{1}{2}\big|\expval{\commutator{A,B}}_\psi\big|. \]
\end{proof}

\section{Time evolution}
\subsection{The Schrödinger equation}
\[ H = i\hbar\od{}{t} \]

\begin{lemma}
$U = e^{Ht / i\hbar} = e^{-iHt/\hbar}$.
\end{lemma}


\subsection{Schrödinger and Heisenberg pictures}
\begin{lemma}
Let $\mathcal{H}$ be a Hilbert space and $\{e_i\}$ an orthonormal basis. Let $U$ be a unitary operator on $\mathcal{H}$. Then $\{Ue_i\}$ is also an orthonormal basis for $\mathcal{H}$.
\end{lemma}
$\{e_i\}$ gives Schrödinger and $\{Ue_i\}$ gives Heisenberg.



\subsection{Adiabatic theorem}

\begin{theorem}
Let $\mathcal{H}$ be a Hilbert space and consider a path $H: \interval{0,1}\to \SelfAdjoints(\mathcal{H}): s\mapsto H(s)$ of self-adjoint operators on the Hilbert space.

Take $\epsilon >0$. If the Hamiltonian of a system is given by $H(\epsilon t)$ for times $t\in \interval{0,\epsilon^{-1}}$. Then the state $\rho$ of the system satisfies
\[ i\epsilon \od{\rho(s)}{s} = \big[H(s), \rho(s)\big], \]
where $s = \epsilon t \in \interval{0,1}$.

Assume $\lambda(s)\in \spec\big(H(s)\big)$ is an isolated point of the spectrum for all $s\in \interval{0,1}$. It is an eigenvalue and let $P(s)$ be the orthogonal projector onto the eigenspace. Set $\Delta(s) \defeq \inf d\big(\lambda, \spec(H(s))\setminus\{\lambda(s)\}\big)$.

Assume $\rho(0) \leq P(0)$. Consider the fidelity $F(s) \defeq \Tr\big(P(s)\rho(s)\big)$. Then
\[ F(1) \geq 1 - \epsilon O\left(\frac{\norm{H'}^2}{\Delta^3} + \frac{\norm{H^{\prime\prime}}}{\Delta^2}\right). \]
\end{theorem}
\begin{proof}
We first write down a differential equation for the fidelity (where $\prime = \od{}{s}$)
\[ \od{F(s)}{s} = \Tr(P'\rho) + \Tr(P\rho'). \]
The second term is zero because $P$ commutes with $H$:
\begin{align*}
\Tr(P\rho') &= -\epsilon^{-1}i\Tr\Big(P\big[H, \rho\big]\Big) \\
&= -\epsilon^{-1}i\Tr\Big(P(H\rho - \rho H)\Big) \\
&= -\epsilon^{-1}i\Tr\Big(PH\rho\Big) +\epsilon^{-1}i\Tr\Big(\rho HP\Big) \\
&= -\epsilon^{-1}i\Tr\Big(PH\rho\Big) +\epsilon^{-1}i\Tr\Big(\rho PH\Big) \\
&= -\epsilon^{-1}i\Tr\Big(\big[PH, \rho\big]\Big) = 0,
\end{align*}
by \zref{m-traceCommutatorCompactSA}.

Now set $Q(s) = \id - P(s)$ and consider the pseudoinverse $(H-\lambda\id)^+$ (TODO by continuous functional calculus?). Then $(H-\lambda\id)(H-\lambda\id)^+ = Q = (H-\lambda\id)^+(H-\lambda\id)$ by continuous functional calculus (TODO ref). Now we can expand $P' = PP'Q + QP'P$ (by \zref{m-derivativeIdempotentOffDiagonal}), so
\begin{align*}
\od{F(s)}{s} &= \Tr(P'\rho) \\
&= \Tr(PP'Q\rho + QP'P\rho) \\
&= \Tr\Big(PP'(H-\lambda\id)^+(H-\lambda\id)\rho + (H-\lambda\id)(H-\lambda\id)^+P'P\rho\Big) \\
&= \Tr\Big(P'(H-\lambda\id)^+(H-\lambda\id)\rho P + (H-\lambda\id)^+P'P\rho (H-\lambda\id)\Big) \\
&= \Tr\Big(P'(H-\lambda\id)^+\big(H\rho P - \rho \lambda P\big) + (H-\lambda\id)^+P' \big(P\rho H - \lambda P\rho \big)\Big) \\
&= \Tr\Big(P'(H-\lambda\id)^+\big(H\rho - \rho H\big)P + (H-\lambda\id)^+P'P\big(\rho H - H\rho \big)\Big) \\
&= \Tr\Big(P'(H-\lambda\id)^+\big[H,\rho\big]P - (H-\lambda\id)^+P'P\big[H, \rho\big]\Big) \\
&= \Tr\Big(PP'(H-\lambda\id)^+\big[H,\rho\big] - (H-\lambda\id)^+P'P\big[H, \rho\big]\Big) \\
&= \Tr\Big(P'Q(H-\lambda\id)^+\big[H,\rho\big] - (H-\lambda\id)^+QP'\big[H, \rho\big]\Big) \\
&= \Tr\Big(P'(H-\lambda\id)^+\big[H,\rho\big] - (H-\lambda\id)^+P'\big[H, \rho\big]\Big) \\
&= \Tr\Big(\big[P', (H-\lambda\id)^+\big]\cdot\big[H,\rho\big]\Big) \\
&= i\epsilon\Tr\Big(\big[P', (H-\lambda\id)^+\big]\rho'\Big) 
\end{align*}
Integrating this w.r.t. $s$ gives
\[ F(1) - F(0) = i\epsilon\int_0^1 \Tr\Big(\big[P', (H-\lambda\id)^+\big]\rho'\Big)  \diff{s}. \]
We fill in that $F(0) = 1$ and perform integration by parts to obtain
\begin{align*}
F(1) &= 1 + i\epsilon\int_0^1 \Tr\Big(\big[P', (H-\lambda\id)^+\big]\rho'\Big)  \diff{s} \\
&= 1 + i\epsilon\Tr\Big(\big[(H-\lambda\id)^+, P'\big]\rho\Big)_0^1 - i\epsilon\int_0^1 \Tr\Big(\big[(H-\lambda\id)^+, P'\big]'\rho\Big)  \diff{s}
\end{align*}
\end{proof}


\begin{proposition}
Let $\mathcal{H}$ be a Hilbert space, $H: \interval{0,1}\to \SelfAdjoints(\mathcal{H})$ and $P(s)$ the projector on an eigenspace associated to some subset of the spectrum $\sigma'$ that is separated from the rest by a gap $g(s)$. Let $\rho(s)$ be the solution the the Heisenberg equation
\[ i\epsilon \od{\rho(s)}{s} = [H(s), \rho(s)] \qquad \rho(0)= P(0). \]
Then we can write
\[ \rho(s) = \sum_{n=0}^N \epsilon^nB_n(s) - \epsilon^N\int_0^s U_\epsilon(s,r)\dot{B}_N(r)U_\epsilon(r,s) \diff{r}, \]
where the $B_n$ satisfy the recursion relation
\[ \begin{cases}
B_0(s) = P(s) \\
B_n(s) = \frac{1}{2\pi}\int_\Gamma R_H(z)\big[P, \dot{B}_{n-1}\big]R_H(z) \diff{z} + S_n - 2PS_nP
\end{cases}, \]
where $\Gamma$ is some Jordan curve that contains $\sigma'$, but not the rest of the spectrum,
\[ S_n \defeq \sum_{m=1}^{n-1}B_mB_{n-m} \]
and $U_\epsilon(s,t)$ is the propagator that satisfies
\[ \begin{cases}
i\epsilon \pd{}{s}U_\epsilon(s,r) = HU_\epsilon(s,r) \\
U_\epsilon(r,r) = \id.
\end{cases} \]
\end{proposition}

\begin{lemma}
Let $\mathcal{H}$ be a Hilbert space and $H: \interval{0,1}\to \SelfAdjoints(\mathcal{H})$ a function that belongs to the Gevrey class $G^\alpha(R)$. Then
\[ \norm{\od[k]{B_n(s)}{s}} \leq L(n,k) \defeq \frac{1}{(10n + 0.3)^2}g^{-2n-k}\big(2CR(k+3n)\big)^{k+3n}. \]
\end{lemma}
\begin{proof}

\end{proof}

\chapter{Approximations}
\section{Approximating eigenvectors}
\subsection{Power series expansion of a non-degenerate level}

\section{Approximating evolutions}

\chapter{Investigations of systems}
\section{Stepped potentials}
(Use density to solve general potentials?)
\section{Coulomb interaction}
\section{Harmonic oscillator}
\subsection{Creation and annihilation operators}

\begin{lemma}

\end{lemma}

\subsection{Gibbs state}

\begin{proposition}
Let $H = \hbar \omega\big(a^*a + \frac{1}{2}\big)$ be the Hamiltonian of a harmonic oscillator, with $\omega > 0$. Consider the Gibbs state
\[ \rho = \frac{e^{-\beta H}}{\mathcal{Z}}, \]
with inverse temperature $\beta > 0$.
Then
\begin{enumerate}
\item the Gibbs state exists;
\item the the partition function is given by $\mathcal{Z} = \frac{1}{2\sinh\big(\frac{\beta \hbar\omega}{2}\big)}$;
\item the Gibbs state can be expanded as
\[ \rho = \big(1 - e^{-\beta\hbar\omega}\big)\sum_{n\in\N}e^{-n\beta\hbar\omega}\ketbra{n}{n}, \]
where the sum converges (TODO: weakly or strongly??).
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Since $\beta H$ is a positive self-adjoint operator, $-\beta H$ is dissipative by \zref{m-negativeOperatorsDissipative}, and thus the existence of $e^{-\beta H}$ is given by \zref{m-LumerPhillips} and the fact that $\lambda \in \res(-\beta H)$ for all $\lambda >0$, so $\lambda\id + \beta H$ is surjective.

The existence of the Gibbs state will then follow if we can show that $e^{-\beta H}$ is trace-class. This is given by (2).

(2) We use \zref{m-eigenvectorsGenerator} to calculate
\begin{align*}
\Tr\big(e^{-\beta H}\big) &= \sum_{n\in\N}\braket[e^{-\beta H}]{n}{n} \\
&= \sum_{n\in\N}\braket[e^{-\beta \hbar \omega\big(n + \frac{1}{2}\big)}]{n}{n} \\
&= e^{- \frac{\beta\hbar\omega}{2}}\sum_{n\in\N}\big(e^{-\beta \hbar \omega}\big)^n \\
&= e^{- \frac{\beta\hbar\omega}{2}}\frac{1}{1 - e^{-\beta \hbar \omega}} \\
&= \frac{1}{e^{\frac{\beta\hbar\omega}{2}} - e^{- \frac{\beta\hbar\omega}{2}}} = \frac{1}{2\sinh\big(\frac{\beta \hbar\omega}{2}\big)}.
\end{align*}

(3) TODO.
\end{proof}