\url{https://arxiv.org/pdf/1912.10642.pdf}
\url{https://arxiv.org/pdf/0810.1279.pdf}
\url{http://katmat.math.uni-bremen.de/acc/acc.pdf}

\chapter{Basic concepts}
\section{Categories}
\subsection{Definitions and examples}
\begin{definition}
A \udef{category} $\cat{C}$ consists of
\begin{enumerate}
\item a class, denoted $\ob(\cat{C})$, of \udef{objects} $X,Y,Z,\ldots$
\item a class, denoted $\mor(\cat{C})$, of \udef{morphisms} or \udef{arrows} $f,g,h,\ldots$
\item a partial binary function $\circ: \mor(\cat{C}) \times \mor(\cat{C}) \not\to \mor(\cat{C})$ of \udef{composition}
\item functions $\dom: \mor(\cat{C}) \to \ob(\cat{C})$ and $\codom: \mor(\cat{C}) \to \ob(\cat{C})$; we call $\dom(f)$ the \udef{domain} and $\codom(f)$ the \udef{codomain} of the morphism $f$; we write
\[ f: X \to Y \qquad\text{or}\qquad \begin{tikzcd}
X \rar{f} & Y
\end{tikzcd}  \]
to mean $f$ is a morphism with $\dom(f) = X$ and $\codom(f) = Y$;
\item a function $\id: \ob(\cat{C}) \to \mor(\cat{C}): X\mapsto (\id_X: X\to X)$, whose images are called \udef{identity morphisms};
\end{enumerate}
such that
\begin{itemize}
\item $g\circ f$ is defined \emph{if and only if} $\codom(f) = \dom(g)$; in this case
\[ g\circ f: \dom(f) \to \codom(g); \]
\item for any $f: X\to Y$, we have $\id_Y\circ f = f\circ \id_X = f$;
\item $\circ$ is associative.
\end{itemize}
We also write $gf$ or $g\cdot f$ instead of $gf$.
\end{definition}

Two arrows are called \udef{parallel} if they have the same domain and codomain.

TODO: we may characterise categories as typed associative classes.

\begin{example}
The terminology suggests that we can think of the objects as sets and the morphisms as functions. We will indeed often consider categories where the objects are sets (potentially with extra structure) and the morphisms are (a certain class of) functions (e.g.\ structure preserving functions).

Some examples of such categories are
\begin{itemize}
\item All sets are objects in the category $\cat{Set}$ and all functions are morphisms.
\item The category $\cat{Poset}$ has partially ordered sets as objects and order-preserving functions as morphisms.
\item A set may be identified with the set of its singleton subsets. One way to make this a category is by considering only the identity functions of the form
\[ \id_{\{a\}}: \{a\} \to \{a\}: a\mapsto a. \]
A category is \udef{discrete} if every morphism is an identity.
\end{itemize}

There are also categories that are not of this type:
\begin{itemize}
\item A preorder $(P, \precsim)$ can be regarded as a category. The elements of $P$ are the objects of the category and for $x,y\in P$ there exists a unique morphism $x\to y$ if and only if $x\precsim y$. Transitivity implies the existence of composites and reflexivity the existence of identity morphisms.
\item In particular (TODO: Von Neumann??) ordinals are preorders and thus define categories. We use the notation $\mathbb{0}, \mathbb{1}, \mathbb{2}, \ldots$ for the categories defined by $0,1,2,\ldots$. Also $\bbomega$ is the category defined by $\omega$.
\end{itemize}
\end{example}

If the category is small enough, we can depict it using a diagram. Points are objects and arrows are morphisms.

\begin{example}
\begin{align*}
\mathbb{1}&: \begin{tikzcd}
0 \arrow[loop left]
\end{tikzcd} \\
\mathbb{2}&: \begin{tikzcd}[ampersand replacement=\&]
0 \arrow[loop left] \ar[r] \& 1 \arrow[loop right]
\end{tikzcd} & &\text{\udef{walking arrow} or \udef{free arrow}} \\
\mathbb{I}&: \begin{tikzcd}[ampersand replacement=\&]
0 \arrow[loop left] \ar[r, shift left] \& 1 \ar[l, shift left] \arrow[loop right]
\end{tikzcd} & &\text{\udef{walking isomorphism} or \udef{free isomorphism}} \\
\mathbb{3}&: \begin{tikzcd}[ampersand replacement=\&]
0 \arrow[loop left] \ar[r] \ar[rr, bend left] \& 1 \ar[r] \arrow[loop below] \& 2 \arrow[loop right]
\end{tikzcd}
\end{align*}
\end{example}

\subsection{Hom sets and sizes of categories}
\begin{definition}
A category $\cat{C}$ is \udef{small} if its collection of morphisms is a set.

A category $\cat{C}$ is \udef{locally small} for any objects $X,Y$ if the collection of morphisms from $X$ to $Y$ is a set. This set is called a \udef{hom-set} and is denoted $\Hom(X,Y)$ or $\cat{C}(X,Y)$.
\end{definition}

\begin{lemma}
If $\cat{C}$ is a small category, then $\ob(\cat{C})$ is a set.
\end{lemma}
\begin{proof}
TODO: replacement with $X\mapsto \id_X$.
\end{proof}

\subsubsection{Thin categories}
\begin{definition}
A category with at most one morphism in each category is called \udef{thin}.
\end{definition}

\begin{lemma}
A small category
\begin{itemize}
\item with at most one element in every hom-set defines a preorder;
\item such that for all objects $X,Y$, the set $\Hom(X,Y)\cup \Hom(Y,X)$ is at most a singleton defines a partial order.
\end{itemize}
\end{lemma}
We call such categories \udef{preorder categories} and \udef{poset categories}.

\subsubsection{Skeletal categories}
\begin{definition}
The \udef{isomorphism class} of an object in a category is the collection of objects isomorphic to the object.

A category $\cat{C}$ is \udef{skeletal} if it contains one object in each isomorphism class.
\end{definition}
\begin{lemma}
Let $\cat{C}$ be a category.
There is a unique - up to isomorphism - skeletal category equivalent to $\cat{C}$.
\end{lemma}
This category is called the \udef{skeleton} of $\cat{C}$, denoted $\cat{skC}$.
\begin{proof}
TODO
\end{proof}

\subsubsection{Initial, terminal and zero objects}
\begin{definition}
Let $\cat{C}$ be a category.
\begin{itemize}
\item An object $X\in\ob(\cat{C})$ is called \udef{initial} if $\cat{C}(X,Y)$ contains one element for each $Y\in\ob(\cat{C})$.
\item An object $Y\in\ob(\cat{C})$ is called \udef{terminal} if $\cat{C}(X,Y)$ contains one element for each $X\in\ob(\cat{C})$.
\item An object $Z\in\ob(\cat{C})$ is called a \udef{zero object} if $Z$ is both initial and terminal.
\end{itemize}
\end{definition}
Initial and terminal objects are dual notions.

\begin{proposition} \label{initialTerminalIsomorphisms}
Let $\cat{C}$ be a category.
\begin{enumerate}
\item Any two initial objects are isomorphic.
\item Any two terminal objects are isomorphic.
\item Any object isomorphic with an initial object is also initial.
\item Any object isomorphic with a terminal object is also terminal.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Let $X_1,X_2$ be initial objects let $f:X_1\to X_2$ and $g:X_2\to X_1$ be the unique morphisms with these domains / codomains. Then $g\circ f: X_1 \to X_1 \in \cat{C}(X_1, X_1) = \{\id_{X_1}\}$. Similarly $f$ is also a left inverse of $g$. Thus $X_1$ and $X_2$ are isomorphic.

(2) The case for terminal objects is dual.

(3) Let $A$ be an initial object and $\begin{tikzcd}
X \arrow[r, shift left, "f"] & \arrow[l, shift left, "f^{-1}"] A
\end{tikzcd}$ isomorphisms. For any object $B\in \cat{C}$, there exists a morphism $g: A\to B$ and thus also a morphism $gf: X\to B$. This morphism is unique in $\cat{C}(X, B)$: take $g': X\to B$. Then $g'f^{-1}: A\to B$, so $g'f^{-1} = g$ and thus $g' = g'f^{-1}f = gf$. So $X$ is an initial object.

(4) The case for terminal objects is dual.
\end{proof}

\subsubsection{Constant and coconstant morphisms}
\begin{definition}
Let $\cat{C}$ be a category and $f\in\mor(\cat{C})$ a morphism. Then $f$ is called
\begin{itemize}
\item \udef{constant} if $fg = fh$, for all $g,h\in\mor(\cat{C})$ such that $fg$ and $fh$ are defined;
\item \udef{coconstant} if $gf = hf$, for all $g,h\in\mor(\cat{C})$ such that $gf$ and $hf$ are defined;
\item a \udef{zero morphism} if it is constant and coconstant.
\end{itemize}
\end{definition}

\begin{proposition}
Let $\cat{C}$ be a category.
\begin{enumerate}
\item Every hom-set contains at most one zero morphism.
\item The composition of a zero morphism and any other morphism is a zero morphism.
\end{enumerate}
\end{proposition}
\begin{proof}
TODO
\end{proof}

\begin{proposition}
Let $\cat{C}$ be a category and $f:A\to B$ a morphism.
\begin{enumerate}
\item If $\cat{C}$ has an initial object $0$ and $f$ factorises as $f: A\to 0 \to B$, then $f$ is constant.
\item If $\cat{C}$ has a terminal object $1$ and $f$ factorises as $f: A\to 1 \to B$, then $f$ is coconstant.
\item If $\cat{C}$ has a zero object $0$, then 
\begin{enumerate}
\item $f$ is a zero morphism \textup{if and only if} $f$ factorises as $f: A\to 0\to B$;
\item every hom-set contains exactly one zero morphism.
\end{enumerate}
\end{enumerate}
\end{proposition}
\begin{proof}
TODO
\end{proof}

\subsection{(Commuting) diagrams}
Informally a diagram in a category is a drawing with points and arrows.

We always assume that all identity arrows and composite arrows are present in the diagram, even if they are rarely drawn.

We say that such a diagram commutes if, for any two points $x,y$ in the diagram, every path from $x$ to $y$ defines the same morphism.

\begin{example}
Let $(N_1, 0_1, S_1)$ and $(N_2, 0_2, S_2)$ be Peano systems and $\pi$ the unique isomorphism defined in \ref{existenceUniquenessPeano}. The condition
\[ \forall n\in N_1: \pi(S_1n) = S_2\pi(n) \]
is equivalent to saying
\[ \begin{tikzcd}
N_1 \ar[r, "\pi"] \ar[d, "S_1"] & N_2 \ar[d, "S_2"] \\
N_1 \ar[r, "\pi"] & N_2
\end{tikzcd} \qquad \text{commutes.} \]
The two paths in the diagram correspond to the two sides of the equation.
\end{example}

More formally we have the following definition:
\begin{definition}
Let $J$ be a category.
A \udef{diagram} of type (or shape) $\cat{J}$ in a category $\cat{C}$ is a (covariant) functor
\[ D: \cat{J} \to \cat{C}. \]
The category $\cat{J}$ is called the \udef{index category} or \udef{scheme} of the diagram $D$.

Usually we are interested in diagrams where $\cat{J}$ is small or even finite. In these cases we call the diagram \udef{small} or \udef{finite}.

If the index category $\cat{J}$ is a preordered set, then we call the diagram a \udef{commutative diagram}.

Let $\cat{I}$ be a subcategory of $\cat{J}$. Then the functor $D$ restricted to $\cat{I}$ is a \udef{subdiagram} of $D$.
\end{definition}
To actually draw such a diagram, you draw each object and morphism in the index category and name it using its image under $D$.

There is no requirement of injectivity, so the same object or morphism in $\cat{C}$ may appear several times in the diagram.

Every path in the index category with the same start $X$ and end $Y$ defines a morphism in the hom-set $\Hom(X,Y)$. In a preorder category there is at most one morphism in each hom-set, so each such path must correspond to the same morphism. Thus the informal and formal definitions of commutative diagram agree.

\begin{example}
The commutative square shown in the last example has the shape
\[ \mathbb{S}: \begin{tikzcd}
\boldsymbol{1} \ar[loop left] \ar[r] \ar[dr] \ar[d] & \boldsymbol{2} \ar[d] \ar[loop right] \\
\boldsymbol{3} \ar[loop left] \ar[r] & \boldsymbol{4} \ar[loop right]
\end{tikzcd}. \]
All morphisms in the category have been drawn. We also call this preorder category the \udef{commutative square}.
\end{example}

Any two paths in a commutative diagram with the same start and end yield an equation of morphism. Constructing proofs with these equations is known as \udef{diagram chasing} or \udef{abstract nonsense}.

\begin{example}
Warning! When drawing the diagram, you draw the index category and label with the object category. You do not draw the image in the object category! This is not necessarily a preorder category when the index category is a preorder category. In fact it is not necessarily even a category. So, for example, the functor $F$ that maps
\[ \begin{tikzcd}
X_1 \dar{f} & X_2 \dar{g} \\ Y_1 & Y_2
\end{tikzcd} \qquad\text{to}\qquad \begin{tikzcd}
X = F(X_1) = F(X_2) \ar[d, shift right, swap, "f' = F(f)"] \ar[d, shift left, "g' = F(g)"] \\ Y = F(Y_1) = F(Y_2)
\end{tikzcd}  \]
should be drawn as
\[ \begin{tikzcd}
X \dar{f'} & X \dar{g'} \\ Y & Y
\end{tikzcd}, \qquad\text{not}\qquad \begin{tikzcd}
X \ar[d, swap, shift right, "f'"] \ar[d, shift left, "g'"] \\ Y
\end{tikzcd} \]
\end{example}

TODO!! Diagrams a graph homomorphism!!!!!! Commuting diagrams are then functors from the transitive closure (which is a preorder category).

\subsubsection{Diagram chasing results}
\begin{lemma} \label{commutingRectangle}
Consider the diagram
\[ \begin{tikzcd}
X \rar{f}\dar{k} & Y \rar{g}\dar{h} & Z\dar{l} \\
A \rar{p} & B \rar{q} & C
\end{tikzcd}. \]
Suppose the left and right squares commute (as subdiagrams), then the whole diagram commutes.
\end{lemma}
\begin{proof}
There are two pairs of nodes that may have more than one morphism between them: $(X,C)$ and $(A,Z)$. We show that there is only one morphism in $\Hom(X,C)$. The other case is similar.

The question boils down to whether $qhf = qpk$. Now we know that $hf = pk$ because the left square commutes, so the identity is automatic.
\end{proof}

\subsection{Categories and associative classes}
\begin{lemma}
Let $\cat{C}$ be a category. We may view $\cat{C}$ as an associative class $\sSet{\mor(\cat{C})\uplus \{u\}, \widehat{\circ}}$, where
\[ \widehat{\circ}: (\mor(\cat{C})\uplus \{u\}) \times (\mor(\cat{C})\uplus \{u\}) \to (\mor(\cat{C})\uplus \{u\}): (f,g) \mapsto \begin{cases}
u & (\text{$f=u$ or $g=u$ or $fg$ is undefined}) \\
fg & (\text{otherwise}).
\end{cases} \]
\end{lemma}
This means we can use the results about associative classes in this context.

\subsubsection{Duality}
Intuitively category-theoretic duality is obtained by ``flipping all the arrows''.
\begin{definition}
Let $\cat{C}$ be a category. The \udef{opposite category} $\cat{C^{op}}$ is obtained by
\begin{itemize}
\item replacing the composition $\circ$ with its dual $\circ^d$;
\item swapping the domain and codomain functions
\[ \dom_{\cat{C^{op}}} \defeq \codom_{\cat{C}} \qquad \text{and} \qquad \codom_{\cat{C^{op}}} = \dom_{\cat{C}}.  \]
\end{itemize}
In particular $\ob(\cat{C}) = \ob(\cat{C^{op}})$ and $\mor(\cat{C}) = \mor(\cat{C^{op}})$.
\end{definition}
As we often suppress the composition $\circ$, and both the original and dual category have the same objects, it may sometimes be unclear in which category we are working. We then may write $f^o$ the emphasis that we are working in the dual category.

\begin{lemma}
The category $(\cat{C}^{op})^{op}$ is again the category $\cat{C}$.
\end{lemma}


A statement about the category $\cat{C^{op}}$ can often be interpreted as a statement about $\cat{C}$. This is referred to as the ``dual statement''. In other words: a statement in $\cat{C}$ is true if and only if the dual statement is true in $\cat{C^{op}}$.

If we prove that something is true in a collection of categories including $\cat{C}$ and $\cat{C^{op}}$, we have in effect proven both the statement and the dual statement. We then say the second follows from the first by duality.


\subsubsection{Mono- and epimorphisms}
\begin{definition}
Let $\cat{C}$ be a category. Then a morphism $f \in \mor(\cat{C})$ is called
\begin{itemize}
\item a \udef{monomorphism} or \udef{monic} if it is left-cancellative.
\item an \udef{epimorphism} or \udef{epic} if it is right-cancellative.
\end{itemize}
\end{definition}

\begin{lemma}
Let $\cat{C}$ be a category.
\begin{enumerate}
\item If $0$ is an initial object, then any morphism $f: A\to 0$ is epic.
\item If $1$ is a terminal object, then any morphism $f: 1\to A$ is monic.
\end{enumerate}
\end{lemma}

??? TODO ???:

$f: A\to B$ monic iff for all $X, g_1, g_2$
\[ \begin{tikzcd}[row sep=small]
& A & \\
X \arrow[ur, "g_1"] \arrow[dr, "g_2"] & \arrow[r, "f"] & B \\
& A  &
\end{tikzcd} \qquad \text{commutes.} \]

\begin{proposition}
Let $\cat{C}$ be a category and $e\in\mor(\cat{C})$ a morphism. Then the following are equivalent:
\begin{enumerate}
\item $e$ is an identity;
\item $e$ is a monic idempotent;
\item $e$ is an epic idempotent. 
\end{enumerate}
\end{proposition}
TODO: make definition??
\begin{proof}
The directions $(1) \Rightarrow (2)$ and $(1) \Rightarrow (3)$ are clear.

For $(2)\Rightarrow (1)$, let $e$ be a monic idempotent. From idempotency, we have $\dom(e) = \codom(e)$. Call this object $A$. We have $e^2 = e = e1_A$. As $e$ is monic, this implies $e = 1_A$.

The direction $(3)\Rightarrow (1)$ is dual.
\end{proof}

\begin{proposition}
Let $\cat{C}$ be a category and $f: X\to Y$ a morphism. Then
\begin{enumerate}
\item $f$ is monic \textup{if and only if} the diagram
\[ \begin{tikzcd}
X \ar[r, "\id_X"] \ar[d, "\id_X"] & X \ar[d, "f"] \\
X \ar[r, "f"] & Y
\end{tikzcd} \]
is a pullback;
\item $f$ is epic \textup{if and only if} the diagram
\[ \begin{tikzcd}
X \ar[r, "f"] \ar[d, "f"] & Y \ar[d, "\id_Y"] \\
Y \ar[r, "\id_Y"] & Y
\end{tikzcd} \]
is a pushout.
\end{enumerate}
\end{proposition}

\subsection{Left and right inverses}
\begin{definition}
Let $\cat{C}$ be a category and $f:X\to Y$ a morphism.
\begin{itemize}
\item A \udef{left inverse} (or \udef{retraction}) of $f$ is a morphism $g: Y\to X$ such that
\[ g\circ f = \id_X. \]
In this case we call $f$ a \udef{split monomorphism} or \udef{split monic}.
\item A \udef{right inverse} (or \udef{section}) of $f$ is a morphism $h: Y\to X$ such that
\[ f\circ h = \id_Y. \]
In this case we call $f$ a \udef{split epimorphism} or \udef{split epic}.
\item A \udef{(two-sided) inverse} of $f$ is a morphism that is both a left and a right inverse. In this case we call $f$ an \udef{isomorphism}.
\end{itemize}
If an isomorphism exists from $X$ to $Y$ (or equivalently from $Y$ to $X$), we say $X$ and $Y$ are \udef{isomorphic}, and write $X\cong Y$.
\end{definition}

An \udef{endomorphism} is a morphism $f$ such that $\dom(f) = \codom(f)$. An \udef{automorphism} is an endomorphism that is an isomorphism.

Note that a left or right inverse in the sense of category theory is \emph{not the same} as in the sense of an associative class.

\begin{lemma}
Let $f:X\to Y$ be a morphism. If $g: Y\to X$ is a left inverse and $h: Y\to X$ a right inverse of $f$, then $g=h$ and $f$ is an isomorphism. In particular an isomorphism can have at most one inverse.
\end{lemma}
\begin{proof}
The proof is identical to \ref{leftRightInverse}:
\[ g = g\id_Y = g(fh) = (gf)h = \id_Xh = h. \]
\end{proof}

\begin{lemma}\mbox{}
\begin{enumerate}
\item Every split monomorphism is a monomorphism.
\item Every split epimorphism is a epimorphism.
\end{enumerate}
\end{lemma}
The converses are \emph{not true}.

\begin{lemma}
In the category $\cat{Set}$
\begin{enumerate}
\item every monomorphism is split;
\item the assertion that every epimorphism is split is equivalent to the axiom of choice.
\end{enumerate}
\end{lemma}
\begin{proof}
This is a restatement of \ref{injectiveInverse} and \ref{surjectiveInverse}.
\end{proof}

\begin{lemma} \label{singleSplitImpliesDoubleSplit}
If a monomorphism is split epic, it is also split monic, and thus an isomorphism.

If an epimorphism is split monic, it is also split epic, and thus an isomorphism.
\end{lemma}
\begin{proof}
Assume a morphism $f:X\to Y$ is monic and has a right inverse $r$. We claim $r$ is also a left inverse. Indeed
\[ fr = \id_Y \implies frf = \id_Yf = f\id_X \implies rf = \id_x  \]
where the second implication is because $f$ is monic. The second claim of the lemma follows by duality.
\end{proof}


\begin{lemma}
In a preorder category, every morphism that is monic or epic, is an isomorphism.

In a poset category, every morphism that is monic or epic, is an identity.
\end{lemma}

\begin{lemma}
Let $f:X\to Y$ and $g:Y\to X$ be morphisms in a category $\cat{C}$. Then
\begin{enumerate}
\item $g$ is a left inverse of $f$ if and only if the diagram
\[ \begin{tikzcd}
X \rar{f} \ar[rr, bend right, "\id_X"] & Y \rar{g} & X
\end{tikzcd} \qquad \text{commutes;} \]
\item $g$ is a right inverse of $f$ if and only if the diagram
\[ \begin{tikzcd}
Y \rar{g} \ar[rr, bend right, "\id_Y"] & X \rar{f} & Y
\end{tikzcd} \qquad \text{commutes.} \]
\end{enumerate}
\end{lemma}


\subsubsection{Groups and groupoids}
\begin{definition}
A \udef{groupoid} is a category in which every morphism is an isomorphism.

A \udef{group} is a groupoid with one object.
\end{definition}

\begin{lemma}
For any category $\cat{C}$ there exists a subcategory containing all the objects of $\cat{C}$ and only the morphisms of $\cat{C}$ that are isomorphisms. This subcategory is called the \udef{maximal groupoid} inside $\cat{C}$.
\end{lemma}

\subsubsection{The core of a category}
\begin{definition}
Let $\cat{C}$ be a category.
\begin{itemize}
\item The \udef{core} of $\cat{C}$ is the groupoid whose objects are the objects of $\cat{C}$ and whose morphisms are the isomorphisms of $\cat{C}$.
\end{itemize}
\end{definition}

Thus a category is a groupoid if and only if it equals its core.

\subsection{Subcategories}
\begin{definition}
Let $\cat{C}$ be a category. We call $\cat{D}$ a \udef{subcategory} of $\cat{C}$ if
\begin{itemize}
\item $\ob(\cat{D}) \subseteq \ob(\cat{C})$;
\item $\mor(\cat{D}) \subseteq \mor(\cat{C})$;
\item $\forall f\in \mor(\cat{D}): \; \dom(f)\in\ob(\cat{D}) \land \codom(f)\in\ob(\cat{D})$;
\item $\forall X\in \ob(\cat{D}): \; \id_X\in \mor(\cat{D})$;
\item $\forall f,g \in \mor(\cat{D}): \; fg \in \mor(\cat{D})$.
\end{itemize}
We call the subcategory \udef{full} if for all $X,Y\in \ob(\cat{D}): \; \cat{C}(X,Y) = \cat{D}(X,Y)$.
\end{definition}

\section{The category of sets}
\subsection{Elements}
\begin{definition}
Let $\cat{C}$ be a category with a terminal element $1$. A morphism $x: 1\to X$ is called an \udef{element}.
\end{definition}

\begin{proposition} \label{elementsInCategoryOfSets}
Let $X$ be an object in the category $\cat{S}$ and fix a terminal object $1$. Then there exists a bijection $X \cong (1\to X)$, where each element $x$ of $X$ is mapped to the constant function $\underline{x}$.
\end{proposition}

\subsection{Parts}
\begin{definition}
Let $\cat{C}$ be a category and $A\in\ob(\cat{C})$.
\begin{itemize}
\item A \udef{part} of $A$ is a monomorphism $i: B \hookrightarrow A$.
\item Let $i,j$ be two parts of $A$. We say $i$ is \udef{included} in $j$ if $i = k;j$ for some morphism $k$. We write $i\subseteq_A j$ (or $i\subseteq j$ if $A$ is clear from context).
\end{itemize}
An element $a$ is a \udef{member} of $j$, written $a\in_A j$ if $a\subseteq j$.
\end{definition}
Note that $k$ need not be mono.

In general $f \subseteq g \iff f\mathrel{L}g$. Thus inclusion is transitive.

\subsubsection{Characteristic functions}
\begin{definition}
Let $i$ be a part of $A$. Fix some object $X$ with a constant $\underline{x}: 1\to V$ Then $\chi: A \to X$ is an \udef{indicator} or \udef{characteristic function} if for all $f: B\to A$
\[ f\subseteq i \;\iff\; f;\chi = \underline{1};\underline{x}: B\to X.  \]
where $\underline{1}: B\to 1$ is the unique morphism to the terminal object.
\end{definition}

Assume the morphisms separated by elements.
\begin{proposition}
Let $\cat{C}$ be a category, $A\in\ob(\cat{C})$ and $f: X\to A,g: Y\to A$ morphisms with characteristic functions $\chi_f, \chi_g: A\to 2$. Then the following are equivalent:
\begin{enumerate}
\item $f \subseteq g$ and $g \subseteq f$;
\item $\chi_f = \chi_g$.
\end{enumerate}
\end{proposition}
\begin{proof}
$(1) \Rightarrow (2)$ For any element $a \in A$, we have $a \in f \iff a\in g$. Now $a\in f$ is equivalent to $a; \chi_f = \underline{T}:1\to A$. Similarly $a\in g$ is equivalent to $a; \chi_g = \underline{T}:1\to A$. So for all elements $a\in A$, we have $al \chi_f = a; \chi_g$. Thus $\chi_f = \chi_g$.

$(2) \Rightarrow (1)$ We have
\[ f \subseteq f \iff f;\chi_f = \underline{T} \iff f;\chi_g = \underline{T} \iff f \subseteq g. \]
Similarly, we have $g \subseteq f$.
\end{proof}

\begin{lemma}
Let $\cat{C}$ be a category, $1$ the terminal object and $2 = \{T,F\}$ an object. Then $\chi: A\to 2$ is the characteristic function of a part $j: U\hookrightarrow A$ \textup{if and only if} $j$ is the pullback of $\underline{T}: 1\to 2$ along $\chi$:
\[ \begin{tikzcd}
U \arrow[r] \arrow[d, hook, "j"] \pbCorner & 1 \arrow[d, "\underline{T}"] \\
A \arrow[r, "\chi"] & \{T,F\}
\end{tikzcd} \]
\end{lemma}
TODO: pullback preserves monomorphisms. Restatement of definition -> only monomorphisms have characteristic functions??

\begin{proposition}
Let $\cat{C}$ be a category, $1$ the terminal object and $2 = \{T,F\}$ an object. If $\chi: A\to 2$ is the characteristic function of a part $j: U\hookrightarrow A$ and $f: B\to A$ is a morphism, then $f;\chi$ is the characteristic function of the pullback of $j$ along $f$.
\end{proposition}
\begin{proof}
\[ \begin{tikzcd}
V \pbCorner \rar \arrow[d, hook] & U \arrow[r] \arrow[d, hook, "j"] \pbCorner & 1 \arrow[d, "\underline{T}"] \\
B \arrow[r, "f"] & A \arrow[r, "\chi"] & \{T,F\}
\end{tikzcd} \]
\end{proof}

\subsubsection{Intersection}
\begin{definition}
Let $i: X\to A$ and $j: Y\to A$ be monomorphisms. The \udef{intersection} of $i$ and $j$ is the pullback
\[ \begin{tikzcd}
X\cap Y \arrow[r] \arrow[d] \arrow[dr, "i\cap j"] & X \arrow[d, hook, "i"] \\
Y \arrow[r, hook, swap, "j"] & A
\end{tikzcd} \]
\end{definition}

\begin{lemma}
Let $\cat{C}$ be a category, $A$ an object and $i,j$ parts of $A$. Then $k = i\cap j$ \textup{if and only if} $a\in k \iff (a\in i)\land(a\in j)$ for all elements $a\in A$.
\end{lemma}
\begin{proof}
Universal property of pullbacks.
\end{proof}

\begin{proposition}
Let $\cat{C}$ be a category and  $i: X\to A$ and $j: Y\to A$ be monomorphisms, with characteristic functions $\chi_i: A\to 2$ and $\chi_j: A\to 2$. Then $\chi_i \land \chi_j$ is the characteristic function of $i\cap j$.
\end{proposition}
\begin{proof}
TODO
\end{proof}

\subsubsection{Relations}

\subsection{Partitions}
\begin{definition}
Let $\cat{C}$ be a category and $A\in\ob(\cat{C})$.
\begin{itemize}
\item A \udef{partition} of $A$ is an epimorphism $p: A \twoheadrightarrow B$.
\item A \udef{cell} is a fiber $c$
\[ \begin{tikzcd}
U \ar[d, "c"]\ar[r] \pbCorner & T \ar[d, "y"] \\
A \ar[r, twoheadrightarrow, "p"] & B
\end{tikzcd} \]
for some element $y\in B$.
\end{itemize}
\end{definition}

\begin{proposition}
Let $\cat{C}$ be a category and $p: A \twoheadrightarrow B$ a partition of $A$. Let $R_p$ be the pullback
\[ \begin{tikzcd}
R_p \ar[d, "{p_1}"]\ar[r, "{p_0}"] \pbCorner & A \ar[d, twoheadrightarrow, "p"] \\
A \ar[r, twoheadrightarrow, "p"] & B.
\end{tikzcd} \]
Then $(p_0, p_1): R_p \to A^2$ is a monomorphism.
\end{proposition}
\begin{proof}

\end{proof}

\subsection{Functions}
\subsubsection{Graphs}
\begin{definition}
Let $f: A\to B$ be a morphism in a category $\cat{C}$. Then
\begin{itemize}
\item the \udef{graph} of $f$ is the morphism $(\id_A, f): A\to A\times B$;
\item the \udef{cograph} of $f$ is the morphism $\begin{pmatrix}
f \\ \id_B
\end{pmatrix}: A\coprod B \to B$.
\end{itemize}
\end{definition}

\begin{proposition}
Let $f: A\to B$ be a morphism in a category $\cat{C}$. Then
\begin{enumerate}
\item the graph $(\id_A, f)$ is a part of $A\times B$;
\item elements of $(\id_A, f)$ are of the form $(x, f(x))$;
\item any section $s: A\to A\times B$ of $\proj_A$ is the graph of a unique morphism $g: A\to B$. This morphism is given by $g = \proj_B \circ s$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Since $\proj_1\circ (\id_A, f) = \id_A$, we have that $(\id_A, f)$ is split monic and thus monic.

(2) TODO \ref{compositionProjectionMorphisms}.

(3) By \ref{productFactorisationMorphisms}, we have $s = (\proj_A\circ s, \proj_B\circ s)$. Now $\proj_A\circ s = \id_A$ as $s$ is a section of $\proj_A$.
\end{proof}

\subsection{Axiom of choice}
TODO!!!
\subsubsection{Complements}
\subsubsection{Separation by elements}

\subsection{Exponentiation}
\begin{definition}
An exponential object $X^Y$ is an internal hom $[Y,X]$ in a cartesian closed category.
\end{definition}

\begin{proposition}
Let $\cat{C}$ be an exponential category with initial object $0$ and terminal object $1$. Let $A,B,C\in \ob(\cat{C})$. Then
\begin{enumerate}
\item $A^0 \cong 1$;
\item $A^{B + C} \cong A^B \times A^C$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Because $1$ is terminal, we have a morphism $A^0\to 1$.

We also have a morphism $0 \to A^1$. We can then inverse curry to obtain a morphism $0\times 1 \to A$ and precompose with a swap operation to obtain a morphism $1\times 0 \to A$. Then currying yields a morphism $1 \to A^0$.

We now need to show that both composition $1\to A^0 \to 1$ and $A^0\to 1 \to A^0$ are the identity. For the first composition this is cleat, because there is only one morphism $1\to 1$.

There is also only one morphism $A^0\to A^0$, because this morphism corresponds to a morphism $0\to A^{A^0}$ by the correspondences
\[ (A^0 \to A^0) \iff (A^0\times 0 \to A) \iff (0\times A^0\to A) \iff (0\to A^{A^0}). \]
There is only one such morphism by the definition of initial object.

(2) TODO
\end{proof}

\section{Functors}
\begin{definition}
A \udef{(covariant) functor} $F:\cat{C}\to\cat{D}$ consists of
\begin{enumerate}
\item a function $F: \ob(\cat{C}) \to \ob(\cat{D})$;
\item a function $F: \mor(\cat{C}) \to \mor(\cat{D})$;
\end{enumerate}
satisfying the functorial properties:
\begin{itemize}
\item $F(a \overset{f}{\longrightarrow} b) = F(a) \overset{F(f)}{\longrightarrow} F(b)$;
\item for any composable pair $g,f$ in $\cat{C}$, $F(g\circ f) = F(g)\circ F(f)$;
\item for each object $c$ in $\cat{C}$, $F(\id_c) = \id_{F(c)}$.
\end{itemize}
A \udef{contravariant functor} $F:\cat{C}\to\cat{D}$ is similar, except it satisfies
\begin{itemize}
\item $F(a \overset{f}{\longrightarrow} b) = F(b) \overset{F(f)}{\longrightarrow} F(a)$
\item for any composable pair $g,f$ in $\cat{C}$, $F(g\circ f) = F(f)\circ F(g)$;
\item for each object $c$ in $\cat{C}$, $F(\id_c) = \id_{F(c)}$.
\end{itemize}
An \udef{endofunctor} is a functor between a category and itself.
\end{definition}

\begin{lemma}
The composition of two contravariant functors is covariant.
\end{lemma}

\begin{lemma}
Let $\cat{C}$ be a category. The functions
\[ \begin{cases}
\id_{\ob(\cat{C})} = \id_{\ob(\cat{C^{op}})} \\
\id_{\mor(\cat{C})} = \id_{\mor(\cat{C^{op}})}
\end{cases} \qquad \text{form a contravariant functor $\operatorname{OP}: \cat{C} \to \cat{C^{op}}$.
} \]
We can compose any contravariant functor $F: \cat{C} \to \cat{D}$ with the functor $\operatorname{OP}$ to obtain a covariant functor $F: \cat{C} \to \cat{D^{op}}$ or $F: \cat{C^{op}} \to \cat{D}$.
\end{lemma}

\begin{example}
Examples of covariant functors:
\begin{itemize}
\item For any category $\cat{C}$, there is an \udef{identity functor} $\id_\cat{C}$ that maps objects and morphisms to themselves.
\item There is an endofunctor $\mathcal{P}:\cat{Set} \to \cat{Set}$ that maps sets to their powerset and functions $f:A\to B$ to their image function $f[\cdot]:\mathcal{P}(A)\to \mathcal{P}(B)$.
\item \udef{Forgetful functors} are functors from the category of some type of structured set to a category of structured set with less (or) no structure. For example, we have a forgetful functor $U: \cat{Poset} \to \cat{Set}$ that maps the cateory $\cat{Poset}$ into the category $\cat{Set}$ by forgetting the order. 
\end{itemize}
Examples of contravariant functors:
\begin{itemize}
\item The contravariant endofunctor $\mathcal{P}:\cat{Set} \to \cat{Set}$ that maps sets to their powerset and functions $f:A\to B$ to their inverse image function $f^{-1}[\cdot]:\mathcal{P}(B)\to \mathcal{P}(A)$.
\end{itemize}
\end{example}

\begin{lemma} \label{functorMorphismPreservation}
Functors preserve split monomorphisms, split epimorphisms and isomorphisms.
\end{lemma}
Functors do not necessarily preserve monomorphisms and epimorphisms.
\begin{corollary}
Let $F:\cat{C}\to \cat{D}$ be a functor. Let $f:X \to Y$ be monic (resp. epic). If $F(f)$ is not monic (resp. epic), then $f$ is not split monic (resp. split epic).
\end{corollary}

\begin{lemma}
Functors preserve commutative diagrams: Let $D:\cat{J}\to \cat{C}$ be a commutative diagram and $F:\cat{C}\to \cat{B}$ a functor. Then $F\circ D$ is a commutative diagram.
\end{lemma}

\subsection{Functors as morphisms}
\begin{definition}
We define $\cat{Cat}$ as the category whose objects are small categories and whose morphisms are functors between them.

We define $\cat{CAT}$ as the category whose objects are locally small categories and whose morphisms are functors between them.
\end{definition}
HOW DOES $\cat{CAT}$ MAKE SENSE?

\begin{lemma}
$\cat{Cat}$ is not small, but it is locally small.

$\cat{CAT}$ is not locally small.
\end{lemma}
There is an inclusion functor $\cat{Cat} \hookrightarrow \cat{CAT}$.

We can obviously consider isomorphisms in the category $\cat{Cat}$, but this is not a very natural notion to work with. For example, a category is not typically isomorphic to its opposite category.

The more natural concept is equivalence of categories.

\begin{lemma} \label{varianceOfComposite}
Let $F,G$ be composable morphisms in $\cat{CAT}$, i.e.\ functors. Then $FG$ is contravariant if exactly one of $F,G$ is contravariant and covariant otherwise.
\end{lemma}


\subsection{Properties of functors}
\begin{definition}
A functor $F:\cat{C}\to\cat{D}$ is called
\begin{itemize}
\item \udef{full} if for all $x,y\in \cat{C}$, the map $\cat{C}(x,y) \to \cat{D}(Fx,Fy)$ is surjective;
\item \udef{faithful} if for all $x,y\in \cat{C}$, the map $\cat{C}(x,y) \to \cat{D}(Fx,Fy)$ is injective;
\item and \udef{essentially surjective on objects} if for every object $d\in\cat{D}$ there is some $c\in\cat{C}$ such that $d$ is isomorphic to $Fc$.
\end{itemize}
These are local definitions. We also call $F$
\begin{itemize}
\item an \udef{embedding} if it is injective on objects;
\item a \udef{full embedding} if it is full, faithful and an embedding.
\end{itemize}
\end{definition}

\begin{lemma} \label{isomorphismCreationReflection}
If $F:\cat{C}\to\cat{D}$ is a full and faithful functor, the $F$ reflects isomorphisms:
If $f$ is a morphism in $\cat{C}$ so that $Ff$ is an isomorphism in $\cat{D}$, then $f$ is an isomorphism.
\end{lemma}
Thus, if $x$ and $y$ are objects in $\cat{C}$ such that $Fx$ and $Fy$ are isomorphic in $\cat{D}$, then $x$ and $y$ are isomorphic in $\cat{C}$.

By \ref{functorMorphismPreservation} any functor preserves isomorphisms.

\begin{proposition}
Let $F:\cat{C}\to\cat{D}$ be a functor.
\begin{enumerate}
\item If $F$ is an embedding, then the image of $F$ is a subcategory of $\cat{D}$.
\item If $F$ is a full embedding, then the image of $F$ is a full subcategory of $\cat{D}$.
\end{enumerate}
\end{proposition}

\begin{lemma}
Functors map idempotents to idempotents.
\end{lemma}
\begin{proof}
We calculate $F(e) = F(e^2) = F(e)F(e) = F(e)^2$.
\end{proof}

\subsubsection{Abstract and concrete categories}
\begin{definition}
A category $\cat{C}$ is called \udef{concrete} if there exists a faithful functor $F: \cat{C} \to \cat{Set}$.
If a category is not concrete, it is called \udef{abstract}.
\end{definition}

\begin{proposition} \label{injectiveMonoSurjectiveEpi}
In any concrete category
\begin{enumerate}
\item $f$ is an injective function implies $f$ is monomorphic;
\item $f$ is a surjective function implies $f$ is epimorphic.
\end{enumerate}
In the category $\cat{Set}$, the opposite implications also hold.
\end{proposition}
\begin{proof}
Set $f:X\to Y$.
\begin{enumerate}
\item Assume $f$ injective. Let $g,h: Z\to X$ such that $g\neq h$. Because we are in a concrete category, this means there exists a $z\in Z$ such that $g(z) \neq h(z)$. By injectivity of $f$ this means $f(g(z)) \neq f(h(z))$ and so $fg \neq fh$. We conclude $f$ is monic by contraposition.
\item Assume $f$ surjective. Let $g,h: Y\to Z$ such that $g\neq h$. Because we are in a concrete category, this means there exists a $y\in Y$ such that $g(y) \neq h(y)$. By surjectivity of $f$ we can find an $x\in X$ such that $f(x) = y$. So $g(f(x)) \neq h(f(x))$ and we conclude $gf \neq hf$, meaning $f$ is epic by contraposition.
\end{enumerate}
Suppose we are now in the category $\cat{Set}$.
\begin{enumerate}
\item Assume $f$ monic. To prove injectivity, take arbitrary $x_1,x_2\in X$ and assume $f(x_1) = f(x_2)$. Now define the constant functions $x_1: Z\to X: z\mapsto x_1$ and $x_2: Z\to X: z\mapsto x_2$. Then
\[ fx_1 = f(x_1) = f(x_2) = f(x_2) \qquad \implies \qquad x_1 = x_2 \]
because $f$ monic.
\item Assume $f$ epic. Left compose $f$ with both the characteristic function $\chi_{f[X]}$ and the constant function $1: Y\to \{1\}: y\mapsto 1$. It is clear $\chi_{f[X]}f = 1f$, so $\chi_{f[X]} = 1$ meaning $f$ is surjective.
\end{enumerate}
\end{proof}

\subsection{Arrow and comma categories}
\subsubsection{Arrow category}
\begin{definition}
Let $\cat{C}$ be a category the \udef{arrow category} of $\cat{C}$ is the category with 
\begin{itemize}
\item as objects tuples of the form $((A,B), h)$, such that $A \overset{h}{\longrightarrow} B$ in $\cat{C}$;
\item as morphisms pairs $(f,g): (A \overset{h}{\longrightarrow} B) \to (A' \overset{h'}{\longrightarrow} B')$ where $A \overset{f}{\longrightarrow} A'$, $B \overset{g}{\longrightarrow} B'$ such that
\[ \begin{tikzcd}
A \rar{f} \dar{h} & A' \dar{h'} \\
B \rar{g} & B'
\end{tikzcd} \qquad\text{commutes.} \]
In other words, $hg = fh'$.
\end{itemize}
The arrow category of $\cat{C}$ is denoted $\cat{C}^\to$.
\end{definition}

\begin{lemma}
A functor $\cat{C}\to\cat{D}$ is a function $\ob(\cat{C}^\to) \to \ob(\cat{D}^\to)$ that preserves composition.
\end{lemma}


\subsubsection{Comma category}
\begin{definition}
Let $\cat{A}, \cat{B}$ and $\cat{C}$ be categories and $S, T$ functors of type $\begin{tikzcd}
\cat{A} \ar[r, "S"] & \cat{C} & \lar[swap]{T} \cat{B}
\end{tikzcd}$. The \udef{comma category} $S\downarrow T$ is the category with
\begin{itemize}
\item as objects tuples of the form $((A,B), h)$, where $A\in\ob(\cat{A}), B\in\ob(\cat{B})$ and $h: S(A) \to T(B)$ a morphism in $\cat{C}$;
\item as morphisms pairs $(f,g): ((A,B), h) \to ((A',B'), h')$ where $f:A\to A'$, $g: B\to B'$ such that
\[ \begin{tikzcd}
S(A) \rar{S(f)} \dar{h} & S(A') \dar{h'} \\
T(B) \rar{T(g)} & T(B')
\end{tikzcd} \qquad\text{commutes.} \]
\end{itemize}
Composition is defined by $(f',g') \circ (f,g) = (f'\circ f, g'\circ g)$ and the identity on $((A,B),h)$ is $(\id_A, \id_B)$.
\end{definition}
The composition $(f',g') \circ (f,g) = (f'\circ f, g'\circ g)$ is a morphism in the comma category by \ref{commutingRectangle}.

The comma category is the arrow category containing arrows $f$ such that $\dom(f)\in\im(S)$ and $\codom(f)\in \im(T)$.

\begin{lemma}
An arrow category is a comma category of type $\begin{tikzcd}
\cat{C} \ar[r, "\id_\cat{C}"] & \cat{C} & \lar[swap]{\id_\cat{C}} \cat{C}
\end{tikzcd}$.
\end{lemma}


\subsubsection{Slice and coslice categories}
\begin{definition}
Let $\cat{A}$ be a category and $a$ an object in $\cat{A}$.
\begin{itemize}
\item The \udef{slice category} over $a$, denoted $\cat{A}/a$, is the comma category of $\begin{tikzcd}
\cat{A} \rar{\id_\cat{A}} & \cat{A} & \lar[swap]{(0\mapsto a)} \cat{\mathbb{1}}
\end{tikzcd}$.
\item The \udef{coslice category} under $a$, denoted $a/\cat{A}$, is the comma category of $\begin{tikzcd}
\cat{\mathbb{1}} \rar{(0\mapsto a)} & \cat{A} & \cat{A} \lar[swap]{\id_\cat{A}} 
\end{tikzcd}$.
\end{itemize}
\end{definition}

Objects in a slice category $\cat{A}/a$ are always of the form $((X, a),h: X\to a)$ and morphisms are always of the form $(f, \id_a)$. So we may drop the dependence on $a$.
\begin{lemma}
Let $\cat{A}$ be a category and $a$ an object in $\cat{A}$.
\begin{enumerate}
\item The objects of the slice category $\cat{A}/a$ may be written as $(X,h)$. A morphism $f: X\to Y$ in $\cat{A}$ may be seen as a morphism $f: (X, h) \to (Y, h')$ in $\cat{A}/a$ if
\[ \begin{tikzcd}[column sep=small]
X \ar[rr, "f"]\arrow[dr, swap, "h"]& & Y \arrow[dl, "h'"]  \\
& a &
\end{tikzcd} \qquad\text{commutes.} \]
\item The objects of the coslice category $a/\cat{A}$ may be written as $(X,h)$. A morphism $f: X\to Y$ in $\cat{A}$ may be seen as a morphism $f: (X, h) \to (Y, h')$ in $\cat{A}/a$ if
\[ \begin{tikzcd}[column sep=small]
& a & \\
X \ar[rr, swap, "f"]\ar[ur, "h"]& & Y \ar[ul, swap, "h'"] 
\end{tikzcd} \qquad\text{commutes.} \]
\end{enumerate}
\end{lemma}


\subsection{Constructions of categories}
\subsubsection{Subcategories}
\begin{definition}
Let $\cat{C}$ be a category. A category $\cat{D}$ is a \udef{subcategory} of $\cat{C}$ if all its objects are objects of $\cat{C}$ and all its morphisms are morphisms of $\cat{C}$.
\end{definition}


\subsubsection{Product categories}
\begin{definition}
The \udef{product} $\cat{C}\times \cat{D}$ of categories $\cat{C}$ and $\cat{D}$  is a category consisting of
\begin{enumerate}
\item ordered pairs $(c,d)$ where $c\in \cat{C}$ and $d\in \cat{D}$ as objects;
\item ordered pairs $(f,g): (c,d) \to (c',d')$ where $f:c\to c'$ and $g:d\to d'$ as morphisms.
\end{enumerate}
Composition and identities are defined component-wise.
\end{definition}



\section{Naturality}
\subsection{Natural transformations}
\begin{definition}
Let $\cat{C}, \cat{D}$ be categories and $F,G: \cat{C}\to \cat{D}$ functors. A \udef{natural transformation} $\alpha: F \Rightarrow G$ consists of
\begin{enumerate}
\item an arrow $\alpha_c: Fc\to Gc$ in $\cat{D}$, called a \udef{component} of the natural transformation, for each object $c\in \cat{C}$
\end{enumerate}
such that, for any morphism $f:c\to c'$ in $\cat{C}$, 
\[ \begin{tikzcd}
Fc \ar[r, "\alpha_c"] \ar[d, swap, "Ff"] & Gc \ar[d, "Gf"] \\
Fc' \ar[r, "\alpha_{c'}"] & Gc'
\end{tikzcd} \qquad \text{commutes}.\]
A \udef{natural isomorphism} is a natural transformation in which every component is an isomorphism. We write $F\cong G$ in this case.
\end{definition}

We represent the natural transformation $\alpha: F \Rightarrow G$ between $F,G: \cat{C}\to \cat{D}$ diagrammatically as
\[ \begin{tikzcd}[column sep=huge]
\cat{C}
  \arrow[bend left=50]{r}[name=U,label=above:$F$]{}
  \arrow[bend right=50]{r}[name=D,label=below:$G$]{} &
\cat{D}
  \arrow[shorten <=10pt,shorten >=10pt,Rightarrow,to path={(U) -- node[label=right:$\alpha$] {} (D)}]{}
\end{tikzcd} \]

The origin of this commutative square can be found in the following picture:

\begin{figure}[h!]
\centering
\begin{tikzpicture}[commutative diagrams/every diagram]
\matrix[matrix of math nodes, commutative diagrams/every cell] (mC) at (0,1.5) {c \\ \\ c' \\};
\path[commutative diagrams/.cd,every arrow,every label](mC-1-1)edge[blue] node {$f$}(mC-3-1);
\matrix[matrix of math nodes, commutative diagrams/every cell] (mD) at (6,0) {Fc &&  \\ && Gc \\ Fc'  && \\ && Gc' \\};
\path[commutative diagrams/.cd,every arrow,every label](mD-1-1)edge[red] node {$\alpha_c$}(mD-2-3);
\path[commutative diagrams/.cd,every arrow,every label] (mD-2-3) edge[blue] node {$Gf$} (mD-4-3);
\path[commutative diagrams/.cd,every arrow,every label](mD-3-1)edge[red] node {$\alpha_{c'}$}(mD-4-3);
\path[commutative diagrams/.cd,every arrow,every label](mD-1-1)edge[blue] node {$Ff$}(mD-3-1);

\path[commutative diagrams/.cd,every arrow,every label](mC-1-1)edge node {$F$}(mD-1-1);
\path[commutative diagrams/.cd,every arrow,every label](mC-1-1)edge[pos=0.34, swap] node {$G$}(mD-2-3);

\path[commutative diagrams/.cd,every arrow,every label](mC-3-1)edge node {$F$}(mD-3-1);
\path[commutative diagrams/.cd,every arrow,every label](mC-3-1)edge node[pos=0.36, swap] {$G$}(mD-4-3);

\node[draw=black,fit=(mC),circle, label={above left:$\cat{C}$}] (catC) {};
\node[draw=black,fit=(mD),circle, label={above right:$\cat{D}$}] (catD) {};
\end{tikzpicture}
\end{figure}
Thus a natural transformation is one that shifts the image of a functor along the morphisms in the target category.

This leads us to the following proposition, which is sometimes used to define natural transformations:
\begin{proposition}
Let $F,G:\cat{C}\to\cat{D}$ be functors. The natural transformations $\alpha: F\Rightarrow G$ correspond bijectively to functors $H: \cat{C}\times\mathbb{2}\to \cat{D}$ such that
\[ \begin{tikzcd}
\cat{C} \ar[r,"i_0"] \ar[dr, swap, "F"] & \cat{C}\times\mathbb{2} \ar[d,"H"] & \cat{C} \ar[l, swap, "i_1"] \ar[dl, "G"] \\
& \cat{D} &
\end{tikzcd} \qquad \text{commutes.} \]
Here $i_0, i_1$ are the functors that map objects $c$ to $(c,0)$ and $(c,1)$ respectively.

The same holds for natural isomorphisms, if $\mathbb{2}$ is replaced by $\mathbb{I}$.
\end{proposition}

\begin{example}
Let $M$ be a monoid. A \udef{dynamical system} is a functor $F: \cat{B}M\to\cat{C}$ from the delooping space to some category. Often this category is $\cat{Top}$ or $\cat{Vect}$. Then the single object of $\cat{B}M$ is mapped to an object $c$ in $\cat{C}$ and the morphisms of $\cat{B}M$ become actions on the object: each element $m\in M$ specifies a morphism in $\cat{B}M$, which is mapped to a morphism in $\cat{C}$
\[ m: c\to c: x\mapsto m\cdot x. \]

A morphism of dynamical systems, or \udef{intertwiner}, is a map between natural transformation $\alpha:F\to G$. This can be seen as a map between objects in $\cat{C}$ that is covariant, in the sense that
\[ \alpha(m\cdot x) = m\cdot \alpha(x). \]
\end{example}

\subsubsection{Natural transformations as canonical maps}
A canonical map $\alpha$ is a map between objects that arises naturally from the definition or the construction of the objects.

TODO: make rigourous! explicate for universal algebra.

In some sense the canonical map works at the level of structure and thus must commute with morphisms.

A \udef{canonical map} is a functor such that there exists a natural transformation from the identit functor to it.

TODO: what about between different categories?






\subsection{Equivalence of categories}
\begin{definition}
An \udef{equivalence of categories} consists of functors $F: \cat{C} \to \cat{D}$ and $G: \cat{D} \to \cat{C}$ such that we have natural isomorphisms $\id_\cat{C} \cong GF$ and $\id_\cat{D} \cong FG$.

The categories $\cat{C}, \cat{D}$ are \udef{equivalent} if there exists an equivalence between them. We write $\cat{C} \simeq \cat{D}$.
\end{definition}

Except for considerations of size, this equivalence is an equivalence relation.
\begin{lemma}
The notion of equivalence is reflexive, symmetric and transitive.
\end{lemma}



\begin{proposition}
A functor defining an equivalence of categories is full, faithful, and essentially surjective on objects.

Assuming the axiom of choice, any functor with these properties defines an equivalence of categories.
\end{proposition}


\begin{lemma}
An equivalence between skeletal categories is an isomorphism of categories
\end{lemma}
\begin{corollary}
Two categories are equivalent \textup{if and only if} their skeletons are isomorphic.
\end{corollary}

\begin{definition}
A category $\cat{C}$ is called
\begin{itemize}
\item \udef{essentially small} if it is equivalent to a small category (i.e.\ its skeleton is small);
\item \udef{essentially discrete} if it is equivalent to a discrete category (i.e.\ its skeleton is discrete).
\end{itemize}
\end{definition}

\begin{lemma}
Every preorder category is equivalent to a poset category.
\end{lemma}



\section{Monoidal categories}
\begin{definition}
A \udef{monoidal category} is a category $\cat{C}$ equipped with
\begin{enumerate}
\item a functor $\otimes: \cat{C}\times\cat{C} \to \cat{C}$ called the \udef{tensor product};
\item an object $1\in \cat{C}$ called the \udef{unit object} or the \udef{tensor unit}
\end{enumerate}
We write $(\cat{C}, \otimes, 1, \alpha, \lambda, \rho)$.
\end{definition}

\subsection{Enrichment}
\begin{definition}
Let $(\cat{V}, \otimes, 1, \alpha, \lambda, \rho)$ be a monoidal category. A \udef{$\cat{V}$-category} $\cat{C}$ (or \udef{$\cat{V}$-enriched category} or \udef{category enriched over $\cat{V}$}) contains
\begin{enumerate}
\item 
\end{enumerate}
such that
\end{definition}

\chapter{Object-free category theory}

\section{``Down with categories'' spiel}
\begin{itemize}
\item it is easy to consider composition in $\cat{Set}$ such that it is not a category;
\item difficulty of formal methods hurdle for foundational use;
\item monoidal categories;
\item complicated enough that people can justify working on trivialities;
\item related to previous: it is a meme (in the original sense). It has enough of an air of depth that it attracts people;
\item it abstracts too much, making it less suited for both foundational and organisational use.
\end{itemize}

\section{Categories as associative classes}
\subsection{Definition and identities}
\begin{definition}
Let $\cat{C}$ be an associative class. We call $\cat{C}$
\begin{itemize}
\item a \udef{left semi-category} if for all $x\in \cat{C}$, there exists
\begin{itemize}
\item a function $\dom: \cat{C}\to \cat{C}: x\mapsto 1_{\dom(x)}$, where $1_{\dom(x)}$ is a left identity such that $x1_{\dom(x)}$ exists; and
\item a function $\codom: \cat{C}\to \cat{C}: x\mapsto 1_{\codom(x)}$, where $1_{\codom(x)}$ is a left identity such that $1_{\codom(x)}x$ exists;
\end{itemize}
\item a \udef{category} if for all $x\in \cat{C}$, there exist identities $e,e'\in \cat{C}$ such that both $ex$ and $xe'$ are defined.
\end{itemize}
\end{definition}

An associative class that is both a left and right semi-category is a category (TODO make precise).

\begin{example}
The associative class of functions on sets is a left semi-category.
\end{example}

\begin{lemma} \label{categoryIdentities}
Let $\cat{C}$ be a category. Then
\begin{enumerate}
\item there exists a function $\dom: \cat{C}\to \cat{C}: x\mapsto 1_{\dom(x)}$, where $1_{\dom(x)}$ is the unique identity such that $x1_{\dom(x)}$ exists;
\item there exists a function $\codom: \cat{C}\to \cat{C}: x\mapsto 1_{\codom(x)}$, where $1_{\codom(x)}$ is the unique identity such that $\codom(x)x$ exists;
\item for all $x,y\in \cat{C}$: $xy$ is defined \textup{if and only if} $1_{\dom(x)} = 1_{\codom(y)}$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) and (2) are immediate. (We do not need choice due to the uniqueness, \ref{uniquenessIdentity})

(3) $\Rightarrow$ We have $xy = x1_{\dom(x)}1_{\codom(y)}y$,
so $1_{\dom(x)}1_{\codom(y)}$ is defined. Thus $1_{\dom(x)} = 1_{\codom(y)}$ by \ref{uniquenessIdentity}.

$\Leftarrow$ If $1_{\dom(x)} = e = 1_{\codom(y)}$, then $xe$ and $ey$ are defined, so $xey = xy$ is defined.
\end{proof}


\begin{lemma}
Let $\cat{C}$ be a category and $x,y\in \cat{C}$. Then
\begin{enumerate}
\item $1_{\dom(1_{\dom(x)})} = 1_{\dom(x)}$;
\item $1_{\codom(\codom(x))} = 1_{\codom(x)}$;
\item $1_{\dom(xy)} = 1_{\dom(y)}$;
\item $1_{\codom(xy)} = 1_{\codom(x)}$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) We have that $1_{\dom(1_{\dom(x)})}1_{\dom(x)}$ is defined by definition. As $1_{\dom(1_{\dom(x)})}$ and $1_{\dom(x)}$ are both identities, we have $1_{\dom(1_{\dom(x)})} = 1_{\dom(x)}$ from \ref{uniquenessIdentity}.

(2) Dual to (1).

(3) By definition, we have that
\[ (xy)1_{\dom(xy)} = x\big(y1_{\dom(xy)}\big) \]
is defined, so $y1_{\dom(xy)}$ is defined. As $1_{\dom(xy)}$ is an identity, it is equal to $1_{\dom(y)}$ by \ref{categoryIdentities}.
\end{proof}

\subsection{Left and right relations}
Diagrammatically,
\[ f \greensL g \quad\text{is equivalent to the commutativity of}\quad \begin{tikzcd}[row sep=small]
{} & B \arrow[dd, dashed, "a"] \\
A \arrow[ur, "f"] \arrow[dr, swap, "g"] & {} \\
{} & B' 
\end{tikzcd} \qquad \text{and}\qquad \begin{tikzcd}[row sep=small]
{} & B  \\
A \arrow[ur, "f"] \arrow[dr, swap, "g"] & {} \\
{} & B' \arrow[uu, dashed, "b"]
\end{tikzcd} \]
and
\[  f \greensR g \quad\text{is equivalent to the commutativity of}\quad \begin{tikzcd}[row sep=small]
A \arrow[dr, "f"] & {} \\
{} & B \\
A' \arrow[uu, dashed, "a"] \arrow[ur, swap, "g"] & {}
\end{tikzcd} \qquad \text{and}\qquad \begin{tikzcd}[row sep=small]
A \arrow[dd, dashed, "b"] \arrow[dr, "f"] & {} \\
{} & B \\
A' \arrow[ur, swap, "g"] & {}
\end{tikzcd}. \]



\begin{lemma} \label{leftRightRelatedIsomorphic}
Let $\cat{C}$ be a category and $f,g\in \cat{C}$.
\begin{enumerate}
\item If $f \greensL g$ and $f,g$ are epic, then $\codom(f) \cong \codom(g)$.
\item If $f \greensR g$ and $f,g$ are monic, then $\dom(f) \cong \dom(g)$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) Assume $f \greensL g$ and $f,g$ are epic. Set $A = \dom(f) = \dom(g)$, $B=\codom(f)$ and $B'=\codom(g)$. Then there exist $a,b\in \cat{C}$ such that
\[ \begin{tikzcd}[row sep=small]
{} & B \arrow[dd, shift left, "a"] \\
A \arrow[ur, "f"] \arrow[dr, swap, "g"] & {} \\
{} & B' \arrow[uu, shift left, "b"]
\end{tikzcd} \qquad \text{commutes with either only $a$ or only $b$ present.} \]
We need to show that the whole diagram commutes, for which we need to verify that $ba = 1_B$ and $ab = 1_{B'}$.

Indeed, $1_{B}f = f = bg = baf$, so $ba = 1_B$, and $1_{B'}g = af = abg$, so $ab = 1_{B'}$.

(2) Dual.
\end{proof}

\section{Functors}
\begin{definition}
A \udef{functor} is a homomorphism between associative classes.
\end{definition}

\section{Natural transformations}
\begin{definition}
Let $\sSet{A,\cdot}$ and $\sSet{B,\cdot}$ be associative classes. A \udef{natural transformation} $\alpha$ is a homomorphism $A\to B$ of two-sided algebras.
\end{definition}


\begin{definition}
Let $\sSet{A,\cdot}$ and $\sSet{B,\cdot}$ be associative classes. Let $F,G: A\to B$ be functors. A \udef{natural transformation} $\alpha$ from $F$ to $G$ is a function $\alpha: A\to B$ such that
\[ \forall f,g\in A: \qquad G(f)\alpha_g = \alpha_{fg} = \alpha_f F(g), \]
where we have written the arguments of $\alpha$ as subscripts: $\alpha_f$ means $\alpha(f)$.

We write $\alpha: F \Rightarrow G$.
\end{definition}

\subsection{Yoneda lemma}


\subsection{Operations with natural transformations}
\subsubsection{Vertical composition}
TODO: need define decomposable.
\begin{definition}
Let $A$ be an associative class that is decomposable. Let $B$ be anothor associative class.

Let $F,G,H: A\to B$ be functors and $\alpha: F\Rightarrow G$, $\beta: G\Rightarrow H$ natural transformations. The \udef{vertical composition} of $\alpha$ and $\beta$ is the natural transformation $\beta\circ\alpha: F\Rightarrow H$ defined by
$(\beta\circ\alpha)_{f} \defeq \beta_{f_2}\alpha_{f_1}$ if $f = f_2f_1$.
\end{definition}
Note that
\begin{itemize}
\item TODO: under what conditions is this well-defined???
\item $\beta\circ\alpha: F\Rightarrow H$ is a natural transformation from $F$ to $H$: $\forall f,g\in A$ we take $f = f_2f_1$, $g = g_2g_1$ and have
\[ H(f)(\beta\circ\alpha)_g = H(f_2)H(f_1)\beta_{g_2}\alpha_{g_1} =  \beta_{f_2}\alpha_{f_1}F(g_2)F(g_1) = (\beta\circ\alpha)_{f}F(g). \]
\end{itemize} 

\subsubsection{Whiskering}
\begin{definition}
Let $F,G: B\to C$ be functors and $\alpha: F\Rightarrow G$ a natural transformation.
\begin{itemize}
\item If $H: A\to B$ is a functor. Then the \udef{pre-whisker} of $H$ and $\alpha$ is the natural transformation $\alpha H: F\circ H\Rightarrow G\circ H$ defined by $(\alpha H)_f = \alpha_{H(f)}$.
\item If $H': C\to D$ is a functor. Then the \udef{post-whisker} of $H'$ and $\alpha$ is the natural transformation $H'\alpha: H'\circ F\Rightarrow H'\circ G$ defined by $(H'\alpha)_f = H'(\alpha_f)$.
\end{itemize}
\end{definition}
The pre-whisker of $H$ and $\alpha$ is a natural transformation $\alpha H: F\circ H\Rightarrow G\circ H$. Indeed, for all $f,g\in D$
\begin{align*}
(G\circ H)(f)(\alpha H)_g &= G\big(H(f)\big)\alpha_{H(g)} \\
&= \alpha_{H(f)}F\big(H(g)\big) \\
&= (\alpha H)_f(F\circ H)(g) .
\end{align*}
The post-whisker of $H'$ and $\alpha$ is also a natural transformation $H'\alpha: H'\circ F\Rightarrow H'\circ G$. Indeed, for all $f,g\in A$
\begin{align*}
(H'\circ G)(f)(H'\alpha)_g &= H'\big(G(f)\big)H'(\alpha_g) \\
&= H'\big(G(f)\alpha_g\big) \\
&= H'\big(\alpha_f F(g)\big) \\
&= H'(\alpha_f)H'\big(F(g)\big) \\
&= (H'\alpha)_f(H'\circ F)(g).
\end{align*}

Pictorially we can represent pre-whiskering as
\[ \begin{tikzcd}
A \arrow[r, "H"] & B \arrow[r, bend left=50, "F"{name=U}]
  \arrow[r, bend right=50, "G"{name=D, below}] & C \arrow[Rightarrow, from=U, to=D, shorten <=0.3em,shorten >=0.3em, "{\alpha}"]
\end{tikzcd} \qquad\text{becomes}\qquad \begin{tikzcd}[column sep=huge]
A \arrow[r, bend left=50, "F\circ H"{name=U}]
  \arrow[r, bend right=50, "G\circ H"{name=D, below}] & C \arrow[Rightarrow, from=U, to=D, shorten <=0.3em,shorten >=0.3em, "{\alpha H}"]
\end{tikzcd} \]
and post-whiskering as
\[ \begin{tikzcd}
B \arrow[r, bend left=50, "F"{name=U}]
  \arrow[r, bend right=50, "G"{name=D, below}] & C \arrow[Rightarrow, from=U, to=D, shorten <=0.3em,shorten >=0.3em, "{\alpha}"] \arrow[r, "{H'}"] & D
\end{tikzcd} \qquad\text{becomes}\qquad \begin{tikzcd}[column sep=huge]
B \arrow[r, bend left=50, "{H'\circ F}"{name=U}]
  \arrow[r, bend right=50, "{H'\circ G}"{name=D, below}] & D \arrow[Rightarrow, from=U, to=D, shorten <=0.3em,shorten >=0.3em, "{H'\alpha}"].
\end{tikzcd} \]

\subsubsection{Horizontal composition}
TODO

\subsection{Cones and limits}
\begin{definition}
Let $\sSet{J,\cdot}$ be an associative set and $\sSet{A,\cdot}$ an associative class. Let $F: J\to A$ be a diagram. Then
\begin{itemize}
\item a \udef{cone} over $F$ is a natural transformation $\alpha: C \Rightarrow F$ from a constant functor $C$ to $F$;
\item a \udef{cocone} under $F$ is a natural transformation $\beta: F\Rightarrow D$ from $F$ to a constant functor $D$.
\end{itemize}
We also define
\begin{itemize}
\item a \udef{limit} of the diagram $F: J\to A$ is a $[\setbuilder{\rho_a\circ -}{a\in A}]^!$-maximum in the class of cones over $F$.
\item a \udef{colimit} of the diagram $F: J\to A$ is a $[\setbuilder{\lambda_a\circ -}{a\in A}]^!$-maximum in the class of cocones over $F$.
\end{itemize}
\end{definition}

\begin{proposition}
Let $\cat{J}$ be a small category, $\cat{C}$ a category and $F: \cat{J}\to \cat{C}$ a (unital) diagram. Then the limits and colimits are categorical limits and colimits. In particular the image of the constant functor is an identity.
\end{proposition}
\begin{proof}
Universal property.
\end{proof}

\begin{proposition}
Let $\cat{J}$ be a small category and $\sSet{A,\cdot}$ an associative class. Let $F: \cat{J}\to A$ be a diagram and $\alpha: C\Rightarrow F$ a limit of $F$. Then
\begin{enumerate}
\item the single element $c$ of $\im(C)$ is idempotent and the unique element of $a$ such that $\alpha_- = \alpha_-c$;
\item if $f,g\in A$ are such that $fg$ exists, then $\alpha_f = F(f)\alpha_g$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) As $\cat{J}$ is a category, it contains an idempotent $e$. Then $c = C(e) = C(e^2) = C(e)C(e) = c^2$, so $c$ is also idempotent.

For all $f:A\to B\in \cat{J}$, we have $\alpha_f = \alpha_{f\id_A} = \alpha_f C(\id_A) = \alpha_f c$.

The uniqueness follows by definition.

(2) We have $\alpha_f = \alpha_fc = \alpha_f C(g) = F(f)\alpha_g$.
\end{proof}

The limit is uniquely determined by its components at sources!

\chapter{Higher category theory}
\section{2-categories}
\subsection{Functor categories}
\begin{proposition} \label{functorCategory}
Let $\cat{C}, \cat{D}$ be categories. There is a category of functors $\cat{C}\to \cat{D}$ with as morphisms natural transformations called the \udef{functor category} $[\cat{C},\cat{D}]$.
\end{proposition}
\begin{proof}
There are clearly identity natural transformations $I:F\Rightarrow F$ for each functor $F: \cat{C}\to \cat{D}$ with components given by $I_{Fc}$ for all $c\in\cat{C}$.

To verify composition, let $\alpha: F \Rightarrow G$ and $\beta: G\Rightarrow H$ be natural transformations between parallel functors $F,G,H: \cat{C}\to \cat{D}$. Then the composition	$\beta\alpha: F\Rightarrow H$ has components
\[ (\beta\alpha)_c = \beta_c\alpha_c. \]
We just need to show $\beta\alpha$ is a natural transformation. Consider the diagram
\[ \begin{tikzcd}
Fc \ar[r, "\alpha_c"] \ar[d, "Ff"] & Gc \ar[d, "Gf"] \ar[r, "\beta_c"] & Hc \ar[d,"Hf"] \\
Fc' \ar[r, "{\alpha_{c'}}"] & Gc' \ar[r, "{\beta_{c'}}"] & Hc'
\end{tikzcd} \]
Both squares commute by naturality of $\alpha,\beta$. The rectangle then commutes: the only non-trivial part is the equality of paths $Fc\to Hc'$, but any such path can be deformed into another by flipping over squares (TODO better reference).
\end{proof}

\subsection{The 2-category of categories}


\chapter{Representability and universal properties}
\section{The Yoneda lemma}
\url{https://math.stackexchange.com/questions/149376/excessive-use-of-the-yoneda-lemma}
\url{https://qchu.wordpress.com/2012/04/02/the-yoneda-lemma-i/}
\begin{lemma}
Let $\cat{C},\cat{D}$ be categories. For every $c\in\cat{C}$, there is a functor defined by
\[ \evalMap_c: [\cat{C},\cat{D}] \to \cat{D}: F\mapsto Fc. \]
\end{lemma}
\begin{proof}
A natural transformation $\alpha: F \Rightarrow G$ is mapped to its component $\alpha_c: Fc \to Gc$. By \ref{functorCategory}, for all $F$, $I_F\mapsto I_{Fc}$ and the composition of composable natural transformations $\beta,\alpha$ has the component $\beta_c\alpha_c$ at $c$.
\end{proof}
So this gives us a functor
\[ \evalMap: (\cat{Set^C}, \cat{C}) \to \cat{Set}: \quad (F,c)\mapsto Fc.\]

Let $\cat{C}$ be a small category. Then for a given $c\in\cat{C}$, $\cat{C}(c,-)$ is the covariant functor represented by $c$ and thus an object in $[\cat{C},\cat{\Set}]$, which is locally small. Then we can consider the covariant functor represented by $\cat{C}(c,-)$,
\[ [\cat{C},\cat{\Set}]\to \cat{Set}:\quad F \mapsto \Hom(\cat{C}(c,-), F). \]

By currying, we can consider the two-sided represented functor $\cat{C}(-,-): \cat{C^{op}}\times\cat{C}\to \cat{Set}$ as a contravariant functor $\cat{C} \to \cat{Set^C}: c\mapsto \cat{C}(c,-)$. Composing this with the contravariant functor represented by $F$ gives the covariant functor
\[ \cat{C} \to \cat{Set}:\quad c \mapsto \Hom(\cat{C}(c,-), F). \]

Combining these two functors we have a bifunctor
\[ (\cat{Set^C}, \cat{C}) \to \cat{Set}: \quad(F,c) \mapsto \Hom(\cat{C}(c,-), F). \]

If we now let $\cat{C}$ be only locally small, not necessarily small, $\cat{Set^C}$ is no longer necessarily locally small. It turns out however that $\Hom(\cat{C}(c,-), F)$ still always yields a set. This assertion is part of the Yoneda lemma. The other part is the assertion that there is a natural isomorphism $\Phi$:
\[ \begin{tikzcd}
\cat{C}\times\cat{Set^C} \ar[rr, bend left=50, "{\Hom(\cat{C}(c,-), F)}"] \ar[rr, bend right=50, "\evalMap_c(F)"] & \Phi\Downarrow\cong & \cat{Set}
\end{tikzcd}. \]

\begin{theorem}[Yoneda lemma] \label{YonedaLemma}
Let $\cat{C}$ be a locally small category.

Given a functor $F: \cat{C} \to \cat{Set}$ and an object $c$ in $\cat{C}$, the function
\[ \Phi_{c,F}: \Hom(\cat{C}(c,-), F) \to Fc: \alpha \mapsto \alpha_c(I_c) \]
is a bijection.

Also $\Phi$ is a natural transformation with components $\Phi_{c,F}$.
\end{theorem}
\begin{corollary}[Yoneda embedding] \label{YonedaEmbedding}
Let $\cat{C}$ be a locally small category. The functors
\[ \begin{tikzcd}
\cat{C} \ar[r, hook] & \cat{Set^{C^{op}}} \\
c \ar[d, swap, "f"]\ar[r, mapsto] \ar[r,mapsto, shift right=1.7em] & \cat{C}(o(-),c) \ar[d, "f_*"] \\
d \ar[r,mapsto] & \cat{C}(o(-),d)
\end{tikzcd} \qquad\text{and}\qquad \begin{tikzcd}
\cat{C^{op}} \ar[r, hook] & \cat{Set^C} \\
c \ar[r, mapsto] \ar[r,mapsto, shift right=1.7em] & \cat{C}(c,-) \\
d \ar[u, "f^o"] \ar[r,mapsto] & \cat{C}(d,-) \ar[u, swap, "f^*"]
\end{tikzcd} \]
define full and faithful embeddings.
\end{corollary}
\begin{proof}
The functors are clearly injective on objects as morphisms with different domain or codomain are different.

Consider first the left embedding. We want the transformation $f_*$ to be natural (this is the transformation with all components equal to $f_*$). Indeed the functors $\cat{C}(o(-),c)$ and $\cat{C}(o(-),c)$ map morphisms $g^o$ in $\cat{C^{op}}$ to $g^*$. Now $f_*$ and $g^*$ clearly commute, proving the naturality of $f_*$.

Then the function $\cat{C}(c,d) \to \Hom(\cat{C}(-,c),\cat{C}(-,d)): f\mapsto f_*$ is the inverse of the Yoneda map $\Phi_{c,\cat{C}(-,d)}$:
\[ \Phi_{c,\cat{C}(-,d)}(f_*) = f_*(I_c) = f\circ I_c = f. \]
Thus by the Yoneda lemma it is bijection, meaning
\[ \cat{C}(c,d) \cong \Hom(\cat{C}(-,c),\cat{C}(-,d)) \]
and the left functor is full and faithful by definition.

The statement for the right functor can be proven analogously. Alternatively, we can see that it is a dual statement in the following way: taking the category to be $\cat{C^{op}}$, we get
\[ \cat{C^{op}}(c,d) \cong \Hom(\cat{C^{op}}(-,c),\cat{C^{op}}(-,d)) \]
or
\[ o[\cat{C}(d,c)] \cong \Hom(o\cdot\cat{C}(c,-)\cdot o,o\cdot\cat{C}(d,-)\cdot o) \]
now for every $\alpha \in \Hom(\cat{C}(c,-),\cat{C}(d,-))$, there is an $\alpha^o$ in $\Hom(o\cdot\cat{C}(c,-)\cdot o,o\cdot\cat{C}(d,-)\cdot o)$, so we have an isomorphism
\[ \cat{C}(d,c) \cong \Hom(\cat{C}(c,-),\cat{C}(d,-)). \]
\end{proof}

It is common to refer both to the Yoneda lemma \ref{YonedaLemma} and its corollary on the Yoneda embedding, \ref{YonedaEmbedding}, as the Yoneda lemma.

\begin{proposition} \label{representablyIsomorphic}
Let $\cat{C}$ be a locally small category. The following are equivalent:
\begin{enumerate}
\item $f:x\to y$ is an isomorphism in $\cat{C}$;
\item $f_*: \cat{C}(-,x) \Rightarrow \cat{C}(-,y)$ is a natural isomorphism;
\item $f^*: \cat{C}(y,-) \Rightarrow \cat{C}(x,-)$ is a natural isomorphism.
\end{enumerate}
\end{proposition}
\begin{proof}
We have already shown $f_*$ and $f^*$ are natural transformations in \ref{YonedaEmbedding}.
The proof follows from the Yoneda embedding \ref{YonedaEmbedding} and \ref{isomorphismCreationReflection}.

Alternatively, a partial proof is as follows: If $f$ has an inverse $f^{-1}$, then $(f^{-1})^*$ is an inverse of $f^*$ and $(f^{-1})_*$ an inverse of $f_*$.
\end{proof}

\section{Representable functors}
\subsection{Functors represented by objects}
\begin{definition}
Let $\cat{C}$ be a locally small category and $c$ an object in $\cat{C}$.

Given a morphism $f: X\to Y$ in $\cat{C}$, we can define the functions
\begin{enumerate}
\item $f_*: \cat{C}(c,X) \to \cat{C}(c,Y): g\mapsto fg$ defined by post-composition;
\item $f^*: \cat{C}(Y,c) \to \cat{C}(X,c): g\mapsto gf$ defined by pre-composition.
\end{enumerate}
These are morphisms in the category $\cat{Set}$.

Based on this we can define the \udef{covariant functor represented by $c$} $\cat{C}(c,-)$ and the \udef{contravariant functor represented by $c$} $\cat{C}(-,c)$:
\[ \begin{tikzcd}
\cat{C} \ar[r, "{\cat{C}(c,-)}"] & \cat{Set} \\
x \ar[d, swap, "f"]\ar[r, mapsto] \ar[r,mapsto, shift right=1.7em] & \cat{C}(c,x) \ar[d, "f_*"] \\
y \ar[r,mapsto] & \cat{C}(c,y)
\end{tikzcd} \qquad\qquad \begin{tikzcd}
\cat{C} \ar[r, "{\cat{C}(-,c)}"] & \cat{Set} \\
x \ar[r, mapsto] \ar[r,mapsto, shift right=1.7em] & \cat{C}(x,c) \ar[d, "f^*"] \\
y \ar[u, "f"] \ar[r,mapsto] & \cat{C}(y,c) 
\end{tikzcd} \]
We also have the \udef{two-sided represented functor} $\cat{C}(-,-):\cat{C}\times \cat{C} \to \cat{Set}$, which is contravariant in the first argument and covariant in the second:
\[ \begin{tikzcd}
\cat{C}\times\cat{C} \ar[r, "{\cat{C}(-,-)}"] & \cat{Set} \\
(x,y) \ar[d, shift left]\ar[r, mapsto] \ar[r,mapsto, shift right=1.7em] & \cat{C}(x,y) \ar[d, "{f^*h_*: g\mapsto hgf}"] \\
(w,z) \ar[u, shift left, "{(f,h)}"] \ar[r,mapsto] & \cat{C}(w,z)
\end{tikzcd} \]
\end{definition}
The placement of the asterisk indicates the placement of the function being composed with $f$: below means to the right and above to the left. This is consistent with the notation for indicating bases in the part on matrix representations of linear functions (TODO ref).

\begin{proposition}
Let $\cat{C}$ be a locally small category and $f: X\to Y$ a morphism. Then $f_*$ and $f^*$ are dual as follows:
\begin{align*}
(f^\text{o})^* &= of_*o = (f^*)^o; \\
(f^\text{o})_* &= of^*o = (f^*)^o.
\end{align*}
\end{proposition}
\begin{proof}
We start with the locally small category $\cat{C^{op}}$, the morphism $f^\text{o}: Y\to X$ and an object $c$. Then 
\[ (f^\text{o})^*: \cat{C^{op}}(X,c) \to \cat{C^{op}}(Y,c): g^\text{o} \mapsto g^\text{o}f^\text{o}. \]
We can rewrite this as
\[ (f^\text{o})^*: o[\cat{C}(c,X)] \to o[\cat{C}(c,Y)]: g^o \mapsto (fg)^o \]
or
\[ o|_{o[\cat{C}(Y,c)]}(f^\text{o})^*o|_{\cat{C}(c, X)}: \cat{C}(c,X) \to \cat{C}(c,Y): g \mapsto fg. \]
This last function is exactly $f_*$. The other equality follows by duality: replacing $\cat{C}$ with $\cat{C^{op}}$ and $f: X\to Y$ with $f^o: Y\to X$ gives
\[ (f^o)_* = o|_{o[\cat{C^{op}}(X,c)]}(f^\text{oo})^*o|_{\cat{C^{op}}(c, Y)} = o|_{\cat{C}(c,X)}f^*o|_{o[\cat{C}(Y,c)]} \]
so
\[ f^* =  o|_{o[\cat{C}(c,X)]}(f^o)_* o|_{\cat{C}(Y,c)}. \]
\end{proof}
\begin{corollary} \label{dualityRepresentedFunctors}
The co- and contravariant represented functors are dual in the following sense:
\begin{align*}
o\cdot \cat{C^{op}}(c,-) \cdot o &= \cat{C}(-,c) \\
o\cdot \cat{C^{op}}(-,c) \cdot o &= \cat{C}(c,-) \\
\end{align*}
\end{corollary}
Note that $o$ still works as a function on sets of morphisms in $\cat{C}$, even though they are now said to be in the category $\cat{Set}$. We also use that $o$ acts on transformations as $o(\alpha) = o\alpha o$ (TODO!).
\begin{proof}
We verify the equality for all objects and morphisms:
\[ (o\cdot \cat{C^{op}}(c,-) \cdot o)(x) = (o\cdot \cat{C^{op}}(c,-))(x) = o(\cat{C^{op}}(c,x)) = o(o(\cat{C}(x,c))) = \cat{C}(x,c) \]
and
\[ (o\cdot \cat{C^{op}}(c,-) \cdot o)(f) = (o\cdot \cat{C^{op}}(c,-))(f^o) = o((f^o)_*) =o(of^*o) = oof^*oo = f^*. \]
\end{proof}

\begin{proposition} \label{monicEpicInPrePostComposition}
Let $\cat{C}$ be a locally small category and $f: X\to Y$ a morphism. Then
\begin{enumerate}
\item $f: X\to Y$ is monic \textup{if and only if} for all $c$ in $\cat{C}$, $f_*: \cat{C}(c,X) \to \cat{C}(c,Y)$ is injective;
\end{enumerate}
and, dually,
\begin{enumerate}
\setcounter{enumi}{1}
\item $f:X\to Y$ is epic \textup{if and only if} for all $c$ in $\cat{C}$, $f^*: \cat{C}(Y,c) \to \cat{C}(X,c)$ is injective.
\end{enumerate}
\end{proposition}
\begin{proof}
Assume $f$ monic. To show injectivity, assume $f_*(g) = f_*(h)$, which means $fg = fh$. By monicity $g = h$, showing $f^*$ is injective.

The converse is equally direct, as is the second statement.

The second statement also follows by duality, recognising that because $o$ is bijective when restricted to the relevant sets, $of^*o$ is injective if and only if $f^*$ is, by \ref{injectiveMonoSurjectiveEpi} and \ref{monicEpicCompositions}.
\end{proof}

\subsection{Representable functors}
\begin{definition}
Let $\cat{C}$ be a locally small category.

A covariant / contravariant functor $F: \cat{C} \to \cat{Set}$ is \udef{representable} if there is an object $c\in\cat{C}$ such that $F$ is naturally isomorphic to the covariant / contravariant functor represented by $c$, i.e.\
\[ F \cong \begin{cases}
\cat{C}(c,-) & \text{$F$ covariant} \\
\cat{C}(-,c) & \text{$F$ contravariant.}
\end{cases} \]
We say $F$ is \udef{represented} by the object $c\in\cat{C}$.

A \udef{representation} of a functor $F: \cat{C} \to \cat{Set}$ is given by an object $c\in\cat{C}$ and a natural isomorphism $\alpha$ from $F$ to the functor represented by $c$.
\end{definition}
A functor is represented by at most one object, up to isomorphism, by \ref{representablyIsomorphic}.

By the Yoneda lemma, every natural isomorphism $\alpha$ corresponds to en element $\alpha_c(I_c) \in Fc$.
\begin{definition}
A \udef{univeral property} of an object $c\in \cat{C}$ is expressed by a representable functor $F$ together with a \udef{universal element} $x\in Fc$ that corresponds to a natural isomorphism between $F$ and the functor represented by $c$.
\end{definition}
\section{The category of elements}
\chapter{Cones and cocones}

\section{Cone and leg categories}
TODO: diagram is just graph homomorphism
\begin{definition}
Let $\cat{C}$ be a category, $G= \sSet{V,E}$ a graph and $\mathbb{D}: G\to \cat{C}$ a diagram.
\begin{itemize}
\item A \udef{star} over $G$ is a pair $(C, l)$, where
\begin{itemize}
\item $C$ is an object;
\item $l: V\to \mor(\cat{C})$ is a function such that $\dom\big(l_v\big) = C$ for all $v\in V$.
\end{itemize}
\item A star $(C,l)$ over $\mathbb{D}$ is \udef{compatible} with an edge $(v,v')\in E$ if $l_{v'} = \mathbb{D}(v,v') \circ l_v$. We write $(v,v')\smile (C,l)$.
\item A star $(C,l)$ is a \udef{cone} over $\mathbb{D}$ if it is an element of $\im(\mathbb{D})^{\smile}$.
\item A diagram $\mathbb{D}': G'\to \cat{C}$ is a \udef{conservative extension} of $\mathbb{D}$ if each cone $(C,l)$ over $\mathbb{D}$ has a unique extension to a cone $(C, l')$ over $\mathbb{D}'$.
\item A cone $(C,l)$ over $\mathbb{D}$ is called a \udef{limit} if the extension $\mathbb{D}_C: G_C\to \cat{C}$ is conservative, where
\begin{itemize}
\item $G_C = \sSet{V\sqcup \{C\}, E\sqcup\setbuilder{(C, v)}{v\in V}}$;
\item $\mathbb{D}_C(C,v) = l_v$.
\end{itemize} 
\end{itemize}
\end{definition}
Note we write $l_v$ for $l(v)$.

\begin{lemma} \label{coneOverSubdiagram}
Let $\cat{C}$ be a category, $\mathbb{D}: G\to \cat{C}$ a diagram and $G'\subseteq G$. If $(C,l)$ is a cone over $\mathbb{D}$, then $(C, l|_{G'})$ is a cone over $\mathbb{D}|_{G'}$.
\end{lemma}
\begin{proof}
It is clear that $(C, l|_{G'})$ is a star over $G'$. Since each edge $(v,v')\in G'$ is an edge of $G$, we have
\[ l|_{G'}(v') = l(v') = \mathbb{D}(v, v')\circ l(v) = \mathbb{D}|_{G'}(v, v')\circ l|_{G'}(v), \]
so $(C, l|_{G'})$ is a cone over $\mathbb{D}|_{G'}$.
\end{proof}

\begin{lemma}
Let $\cat{C}$ be a category and $\mathbb{D}: G\to \cat{C}, \mathbb{D}': G'\to \cat{C}, \mathbb{D}^{\prime\prime}: G^{\prime\prime}\to \cat{C}$ diagrams such that $G\subseteq G', G^{\prime\prime}$ and $(G'\setminus G)\perp (G^{\prime\prime}\setminus G)$.

If $\mathbb{D}'$ is a conservative extension of $\mathbb{D}$, then $\mathbb{D}^{\prime\prime}$ is a conservative extension of $\mathbb{D}$ \textup{if and only if} $\mathbb{D}^{\prime\prime}\cup \mathbb{D}': G^{\prime\prime}\cup G' \to \cat{C}$ is a conservative extension of $\mathbb{D}'$.
\end{lemma}
Due to the assumption $(G'\setminus G)\perp (G^{\prime\prime}\setminus G)$, the diagram $\mathbb{D}^{\prime\prime}\cup \mathbb{D}': G^{\prime\prime}\cup G' \to \cat{C}$ is well-defined.
\begin{proof}
First assume $\mathbb{D}^{\prime\prime}$ is a conservative extension of $\mathbb{D}$ and take a cone $(C,l)$ over $\mathbb{D}'$. Now $(C, l|_G)$ is a cone over $\mathbb{D}$ by \ref{coneOverSubdiagram}, so it has a unique extension to a cone $(C, l')$ over $\mathbb{D}^{\prime\prime}$. We can consider the star $(C, l\cup l')$, which is clearly a cone because it is compatible with each edge in $G'\cup G^{\prime\prime}$.
This shows the existence of an extension.

To show uniqueness, TODO
\end{proof}
\begin{corollary}
Let $\cat{C}$ be a category and $\mathbb{D}: G\to \cat{C}, \mathbb{D}': G'\to \cat{C}$ diagrams such that $\mathbb{D}'$ is a conservative extension of $\mathbb{D}$. Let $(C, l)$ be a cone over $\mathbb{D}$ with unique extension to the cone $(C, l')$ over $\mathbb{D}'$. Then $(C, l)$ is a limit \textup{if and only if} $(C, l')$ is a limit.
\end{corollary}

\begin{lemma}
Let $\cat{C}$ be a category, $G = \sSet{V,E}$ a graph, $\mathbb{D}: G\to \cat{C}$ a diagram, $v\in V$ and $f: \mathbb{D}(v)\to B$ a morphism whose domain is in the image of $\mathbb{D}$. Then the diagram $\mathbb{D}': G'\to \cat{C}$, where $G' = \sSet{V,\cup \{B\}, E\cup \{(v,B)\}}$ and $\mathbb{D}'(v,B) = f$, is a conservative extension of $\mathbb{D}$.
\end{lemma}
\begin{proof}
Let $(C,l)$ be a cone over $\mathbb{D}$. In order for the extension to be compatible with the edge $(v, B)$, we need to set $l'(B) = f\circ l(v)$.
\end{proof}


\begin{lemma}
Adding an identity that starts and ends at the same node to a diagram gives a conservative extension.
\end{lemma}
Adding an identity that joins different nodes is clearly not conservative in general.


\begin{proposition}[Walking cones and cocones] \label{walkingConesCocones}
Let $\cat{C}$ be a category and $\cat{I}\subseteq \cat{J}$ small categories such that the whole of $\cat{J}$ is reachable from $\cat{I}$. Let $D: \cat{J}\to \cat{C}$ be a diagram. Then
\begin{enumerate}
\item there exists an isomorphism between cones over $D$ and cones over $D|_\cat{I}$;
\item there exists an isomorphism between cocones under $D$ and cocones under $D|_\cat{I}$.
\end{enumerate}
\end{proposition}
TODO define reachable. TODO: we are not allowed to add edges to existing nodes, except if they are isomorphisms.
\begin{proof}
TODO
\end{proof}

\begin{proposition} \label{limitExtensionConesCocones}
Let $\cat{C}$ be a category and $\cat{I}$ a small category. Let $\cat{J}$ be a pointed extension of $\cat{I}$. graphs such that the whole of $\cat{J}$ is reachable from $\cat{I}$. Let $D: \cat{J}\to \cat{C}$ be a diagram. Then
\begin{enumerate}
\item if the image of the pointed extension under $D$ contains a limit star, there exists an isomorphism between cones over $D$ and cones over $D|_\cat{I}$;
\item if the image of the pointed extension under $D$ contains a colimit star, there exists an isomorphism between cocones under $D$ and cocone under $D|_\cat{I}$.
\end{enumerate}
\end{proposition}
TODO pointed extension: one additional vertex with edges pointing to existing vertices.

The following operations preserve the class of cones:
\begin{itemize}
\item adding a morphism from an existing node to a new node;
\item adding a morphism that is the composition of morphisms that are already in the diagram;
\item adding the inverse of an existing isomorphism;
\item adding a limit of a subdiagram with leg morphisms;
\item adding the diagram of an existing cone;
\item adding the universal morphism from an object to a limit of a subdiagram.
\end{itemize}
TODO: for now I refer to \ref{walkingConesCocones} for all these points.

TODO: arrows in diagrams as constraints!!

\begin{lemma} \label{conesOverCompositions}
Let $f: A\to B$, $g: B\to C$ be morphisms. Then
\begin{enumerate}
\item the class of cones over the following diagrams are equal:
\begin{enumerate}
\item $\begin{tikzcd}
A \ar[r, "f"] & B \ar[r, "g"] & C
\end{tikzcd}$;
\item $\begin{tikzcd}
A \ar[rr, "{g\circ f}"] & \phantom{B} & C
\end{tikzcd}$;
\item $\begin{tikzcd}
A \ar[r, "f"] \ar[rr, bend right, "{g\circ f}"] & B \ar[r, "g"] & C
\end{tikzcd}$;
\end{enumerate}
\item the class of cocones under the following diagrams are equal:
\begin{enumerate}
\item $\begin{tikzcd}
A \ar[r, "f"] & B \ar[r, "g"] & C
\end{tikzcd}$;
\item $\begin{tikzcd}
A \ar[rr, "{g\circ f}"] & \phantom{B}  & C
\end{tikzcd}$;
\item $\begin{tikzcd}
A \ar[rr, bend right, "{g\circ f}"] \ar[r, "f"] & B \ar[r, "g"]  & C
\end{tikzcd}$.
\end{enumerate}
\end{enumerate}
\end{lemma}
\begin{proof}
(1) Clearly any cone over (c) is a cone over the other two diagrams. First let $K$ be a cone over (a) with legs $l_A, l_B, l_C$. Then $f\circ l_A = l_B$ and $g\circ l_B = l_C$, so $l_c = g\circ (f\circ l_A) = (g\circ f)\circ l_A$ and $K$ is a cone over (c).

Now let $K$ be a cone over (b) with legs $l_A, l_C$. Then there is a unique choice for the leg $l_B$, namely $l_B = f\circ l_A$. Since $g\circ f\circ l_A = l_C$, we have $l_C = g\circ (f\circ l_A) = g\circ l_B$ and $K$ is a cone over (c).

(2) The arguments are dual.
\end{proof}


\begin{proposition}
Cone category is intersection \emph{of objects} in leg categories.
\end{proposition}
Note that we do not need to check commuting properties.

\begin{corollary}
Given two diagrams such that there exists a commuting canonical extension diagram that encompasses both, then the (co)cone categories of all three diagrams are the same.
\end{corollary}

\section{Finite limits}
\subsection{Product}
TODO: use $\prod$?? TODO use $\pi$. TODO proofs

\[ \begin{tikzcd}
& X \arrow[d, dashed, near end, "{(f,g)}"] \arrow[dl, swap, "f"] \arrow[dr, "g"] & \\
A & A\times B \arrow[l, "{\pi_A}"] \arrow[r, swap, "{\pi_B}"] & B
\end{tikzcd} \]

We denote the unique morphism $(f,g)$.

\begin{definition}
Let $A$ be an object, then we define
\begin{itemize}
\item the \udef{square} of $A$ as $A^2 \defeq A\times A$;
\item the \udef{diagonal map} on $A$ as $\delta_A = (\id_A, \id_A): A\to A^2$.
\end{itemize}
Let $h: A\to X$ and $k: B\to Y$ be morphisms. Then we define $(h|k): A\times B\to X\times Y$ as $(h|k) \defeq (h\circ\pi_1, k\circ\pi_2)$.
\end{definition}

TODO!!!!!: Define $(R|S)$ for relations $R$ and $S$.

\begin{lemma} \label{compositionProjectionMorphisms}
Let $\begin{tikzcd}[row sep=-0.7em, column sep=1em]
&& A \\
X \ar[r, "h"] & Y \ar[ur, "f"] \ar[dr, swap, "g"] & \\
&& B
\end{tikzcd}$ be morphisms in a category $\cat{C}$ which contains $A\times B$.

Then
$\begin{tikzcd}
X \ar[r, "h"] \ar[rr, bend left, "{(f\circ h,g \circ h)}"] & Y \ar[r, "{(f,g)}"] & A\times B
\end{tikzcd}$ commutes.
In other words: $(f,g)\circ h = (f\circ h, g\circ h)$.
\end{lemma}

\begin{lemma} \label{productFactorisationMorphisms}
Let $X,A,B$ be morphism in a category $\cat{C}$ such that $A\times B$ exists. Let $f: X\to A\times B$,  $g: X\to A$ and $g': X\to B$ be morphisms. Then
\begin{enumerate}
\item $f = (\proj_A\circ f, \proj_B\circ f)$;
\item $g = \pi_A\circ(g,g')$ and $g' = \pi_B\circ(g,g')$.
\end{enumerate}
\end{lemma}

\begin{lemma}
Let $A,B$ be objects in a category $\cat{C}$. Then there exists an isomorphism $A\times B \to B\times A$.
\end{lemma}

\begin{lemma} \label{parallelCompositionOfMorphisms}
Let $f: A\to X, g: B\to Y, h: X\to U$ and $k: Y\to V$ be morphisms. Then $(h|k)\circ (f|g) = (h\circ f | k\circ g)$.
\end{lemma}
\begin{proof}
We calculate, using \ref{productFactorisationMorphisms},
\begin{align*}
(h|k)\circ (f|g) &= (h\circ \pi_1, k\circ\pi_2) \circ (f\circ \pi_1, g\circ\pi_2) \\
&= \big(h\circ \pi_1\circ (f\circ \pi_1, g\circ\pi_2), k\circ\pi_2\circ (f\circ \pi_1, g\circ\pi_2)\big) \\
&= (h\circ f\circ \pi_1, k\circ g\circ\pi_2) \\
&= (h\circ f | k\circ g).
\end{align*}
\end{proof}

\begin{lemma}
Let $A$ be an object in a category $\cat{C}$ with terminal object $1$. Then $A \cong A\times 1$.
\end{lemma}


\begin{proposition} \label{associatorTernaryProducts}
Let $\cat{C}$ be a category with binary products and $A,B,C$ objects in this category. Then there exists a unique isomorphism
\[ (A\times B)\times C \to A\times (B\times C). \]
\end{proposition}
\begin{proof}
Both $(A\times B)\times C$ and $A\times (B\times C)$ are limits of the diagram $\begin{tikzcd}
A & B & C
\end{tikzcd}$.
\end{proof}

\begin{proposition} \label{swapMorphism}
Let $\cat{C}$ be a category with binary products and $A,B$ objects in this category. Then there exists a unique isomorphism
\[ A\times B \to B\times A. \]
\end{proposition}
\begin{proof}
Both $A \times B$ and $B\times A$ are limits of the diagram $\begin{tikzcd}
A & B
\end{tikzcd}$.
\end{proof}

\subsection{Equalisers and coequalisers}
\begin{definition}
Consider the category $\mathbb{D}: \begin{tikzcd}
\bullet \ar[loop left] \ar[r, shift left] \ar[r, shift right] & \bullet \ar[loop right]
\end{tikzcd}$ and let $\cat{C}$ be some other category. An \udef{equaliser} in $\cat{C}$ is the limit of a $\mathbb{D}$-diagram in $\cat{C}$.

A \udef{coequaliser} in $\cat{C}$ is the colimit of a $\mathbb{D}$-diagram in $\cat{C}$.
\end{definition}

Note that $\mathbb{D}$ is not a preorder category! Thus $\mathbb{D}$-diagrams are not commutative. TODO better to define equaliser as limit over
\[ \begin{tikzcd}[row sep=tiny]
{} & A \ar[dr, "f"] & {} \\
A \ar[ur, "{\id_A}"] \ar[dr, swap, "{\id_A}"] & {} & B \\
{} & A \ar[ur, swap, "g"] & {}
\end{tikzcd} \qquad\text{or}\qquad \begin{tikzcd}[row sep=tiny]
{} & B \ar[dr, "{\id_B}"] & {} \\
A \ar[ur, "f"] \ar[dr, swap, "g"] & {} & B \\
{} & B \ar[ur, swap, "{\id_B}"] & {}
\end{tikzcd} \]
and coequaliser as colimit under either of these diagrams.


\begin{lemma}
Let $\cat{C}$ be a category and $f,g: A\to B$ morphisms in $\cat{C}$ with equaliser
\[ \begin{tikzcd}[column sep=tiny]
& E \ar[dl, swap, "e"] \ar[dr, "{e'}"] & \\
A \ar[rr, shift left, "f"] \ar[rr, shift right, swap, "g"] && B
\end{tikzcd} \]
Then the leg $E\to B$ is redundant.
\end{lemma}
In other words, the morphism $e: E\to A$ determines the equaliser \textup{if and only if} $\forall h: X\to A$ such that $fh = gh$:
\[ \exists! \theta : \qquad \begin{tikzcd}
X \ar[d, dashed, swap, "{\exists! \theta}"] \ar[dr, "h"] && \\
E \ar[r, "e"] & A \ar[r, shift left, "f"] \ar[r, shift right, swap, "g"] & B
\end{tikzcd} \qquad \text{commutes.} \]
\begin{proof}
Clearly $e'$ is uniquely determined by $e$: because the diagram commutes, we have $e' = f\circ e = g\circ e$.

If $e: E\to A$ has the property, then defining $e' = f\circ e = g\circ e$, makes $(e,e')$ a limit. TODO redundant legs.
\end{proof}

\begin{lemma} \label{equaliserMonic}
Let $\cat{C}$ be a category and $f,g: A\to B$ morphisms. If the equaliser $e: E\to A$ exists, it is monic.
\end{lemma}
\begin{proof}
Take arbitrary $h_1, h_2: X\to E$ such that $e\circ h_1 = e\circ h_2$. Then consider the diagram
\[ \begin{tikzcd}
X \ar[d, dashed, swap, "h"] \ar[dr, "{e\circ h_1 = e\circ h_2}"] && \\
E \ar[r, "e"] & A \ar[r, shift left, "f"] \ar[r, shift right, swap, "g"] & B
\end{tikzcd} \]
which commutes if $h = h_1$ or $h = h_2$. But, because $e$ is the equaliser, there may exist only one $h$ that makes the diagram commute, so $h_1 = h_2 = h$.
\end{proof}

\subsubsection{Kernels and cokernels}
\begin{definition}
Let $\cat{C}$ be a category with zero morphisms and $f:A\to B$ a morphism.
\begin{itemize}
\item The \udef{kernel} of $f$ is the equaliser of $f$ and the zero morphism $0:A\to B$.
\item The \udef{cokernel} of $f$ is the coequaliser of $f$ and the zero morphism $0:A\to B$.
\end{itemize}
\end{definition}

\begin{proposition} \label{epicMonicZeroKernelCokernel}
Let $\cat{C}$ be a category with a zero object $0$ and $f:A\to B$ a morphism. Then
\begin{enumerate}
\item if $f$ is monic, then $0_{0,A}\in \ker(f)$;
\item if $f$ is epic, then $0_{0,A}\in \coker(f)$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) We have $f0_{0,A} = 0_{0,B} = 0_{A,B}0_{0,A}$, so $0_{0,A}$ determines a cone over the diagram $\begin{tikzcd}
A \arrow[r, shift left, "f"] \arrow[r, shift right, swap, "{0_{A,B}}"] & B
\end{tikzcd}$. For any other cone $h: A'\to A$, we have a unique morphism from $A'$ to $0$. In order to prove that $0_{0,A}\in\ker(f)$, we need to show that the diagram
\[ \begin{tikzcd}
A' \ar[d, swap, "{0_{A', 0}}"] \ar[dr, "h"] && \\
0 \ar[r, "0_{0,A}"] & A \ar[r, shift left, "f"] \ar[r, shift right, swap, "{0_{A,B}}"] & B
\end{tikzcd}\qquad\text{commutes.} \]
The only part that remains to be proven is that $h = 0_{0,A}0_{A',0}$. We have
\[ fh = 0_{A,B}h = 0_{A',B} = 0_{A,B}0_{0,A}0_{A',0} = f0_{0,A}0_{A',0}. \]
As $f$ is monic, the equality $fh = f0_{0,A}0_{A',0}$ implies $h = 0_{0,A}0_{A',0}$.

(2) Dual.
\end{proof}
TODO: opposite implication for additive categories (??)

\begin{lemma} \label{identityAsKernelCokernel}
Let $\cat{C}$ be a category with zero element and $A\in\ob(\cat{C})$. Then
\begin{enumerate}
\item $1_A \in \ker(A\to 0)$;
\item $1_A \in \coker(0\to A)$.
\end{enumerate} 
\end{lemma}

\subsection{Pullbacks}
\begin{definition}
The limit of the diagram $\begin{tikzcd}
A \ar[r] & C & \ar[l] B
\end{tikzcd}$ is the \udef{pullback} $A\times_C B$.
\end{definition}

\begin{lemma} \label{productAsPullback}
Let $\cat{C}$ be a category with terminal object $T$ and $A,B\in\ob(\cat{C})$. Then $A\times B = A\times_T B$.
\end{lemma}
\begin{proof}
The cocone categories of
\[ \begin{tikzcd}
A & B
\end{tikzcd} \qquad\text{and}\qquad \begin{tikzcd}
A \ar[r] & T & \ar[l] B
\end{tikzcd} \]
are the same.
\end{proof}


\begin{proposition} \label{pullbackLemma}
Let $\cat{C}$ be a category and consider the commutative diagram
\[ \begin{tikzcd}
E \ar[r] \ar[d] & B\times_A C \pbCorner \ar[d] \ar[r] & C \ar[d] \\
D \ar[r] & B \ar[r] & A
\end{tikzcd} \]
Then the left square is a pullback \textup{if and only if} the rectangle is a pullback.
\end{proposition}
\begin{proof}
\ref{conesOverCompositions}


The diagram $\begin{tikzcd}[column sep=small]
D \ar[r] & B & \ar[l] B\times_A C
\end{tikzcd}$ has the same cones as
\[ \begin{tikzcd}
{} & B\times_A C \pbCorner \ar[d] \ar[r] & C \ar[d] \\
D \ar[r] & B \ar[r] & A
\end{tikzcd} \]
by \ref{walkingConesCocones}. By \ref{walkingConesCocones}, $\begin{tikzcd}[column sep=small]
D \ar[r] & B & \ar[l] B\times_A C
\end{tikzcd}$ also has the same cones as this diagram.

Thus they have the same limits, meansing that $E$ is a limit of one iff it is a limit of the other.
\end{proof}

\subsection{Implications regarding existence}

\begin{proposition}
Let $\cat{C}$ be a category. The following are sufficient conditions for the existence of equalisers in $\cat{C}$:
\begin{enumerate}
\item the existence of pullbacks (of a morphism and a monomorphism) and squares;
\item the existence of pullbacks of two monomorphism and products;
\item the existence of pullbacks and a terminal object.
\end{enumerate}
\end{proposition}
\begin{proof}
Let $f,g: A\to B$ be morphisms in $\cat{C}$.

(1) The equaliser of $f,g$ is the pullback
\[ \begin{tikzcd}
E \arrow[r] \arrow[d, "e"] \pbCorner & B \arrow[d, "{\delta_B}"] \\
A \arrow[r, swap, "{(f,g)}"] & B^2
\end{tikzcd} \]
because the diagrams $\begin{tikzcd}
A \ar[r, shift left, "f"] \ar[r, shift right, swap, "g"] & B
\end{tikzcd}$ and $\begin{tikzcd}
A \ar[r, "{(f,g)}"] & B^2 & \ar[l, swap, "{\delta_B}"] B
\end{tikzcd}$ have the same cones. To show this, consider diagram
\[ \begin{tikzcd}[column sep=large]
& B \ar[dr, leftrightarrow, "{\id_B}"] & \\
A \ar[r, pos=0.6, "{(f,g)}"] \ar[ur, "f"] \ar[dr, swap, "g"] & B^2 & \ar[l, swap, "{\delta_B}"] B \\
& B \ar[ur,swap, leftrightarrow, "{\id_B}"] &
\end{tikzcd} \]
The diagram obtained by removing the morphism $(f,g)$ clearly has the same cones as the equaliser diagram by \ref{walkingConesCocones}. By a diagram chase, $(f,g)$ is already present in this diagram, so it may be freely added.

A similar argument shows that $\begin{tikzcd}
A \ar[r, "{(f,g)}"] & B^2 & \ar[l, swap, "{\delta_B}"] B
\end{tikzcd}$ also has the same cones as this diagram.

(2) The equaliser of $f,g$ is the pullback
\[ \begin{tikzcd}
E \arrow[r] \arrow[d, "e"] \pbCorner & A \arrow[d, "{(\id_A, f)}"] \\
A \arrow[r, swap, "{(\id_A,g)}"] & A\times B
\end{tikzcd} \]
because the diagrams $\begin{tikzcd}
A \ar[r, shift left, "f"] \ar[r, shift right, swap, "g"] & B
\end{tikzcd}$ and $\begin{tikzcd}
A \ar[r, "{(\id_A,g)}"] & A\times B & \ar[l, swap, "{(\id_A, f)}"] B
\end{tikzcd}$ are contained in the commuting diagram
\[ \begin{tikzcd}[column sep=large]
& A \ar[dr, "{f}"] \ar[d, swap, pos=0.7, "{(\id_A, f)}"] & \\
A \ar[ur, leftrightarrow, "{\id_A}"] \ar[dr, leftrightarrow, swap, "{\id_A}"] & A\times B \ar[r, "{\proj_B}"] & B \\
& A \ar[ur, swap, "{g}"] \ar[u, pos=0.7, "{(\id_A, g)}"] &
\end{tikzcd} \]
so we can apply \ref{walkingConesCocones}.

(3) From point (2) and \ref{productAsPullback}.
\end{proof}

\begin{proposition}
Let $\cat{C}$ be a category. If products and equalisers exist, then all finite limits exist.
\end{proposition}
Note that we assume all products exist, including products of zero factors (i.e.\ terminal objects).
\begin{proof}
Take product over all objects in diagram and the equalise over all paths that need to be the same in order for the cone to commute properly.

TODO: Show that multiple equalisation commutes.
\end{proof}
\begin{corollary} \label{productsMonicPullbacksComplete}
Let $\cat{C}$ be a category. If products and pullbacks of monomorphisms exist, then all finite limits exist.
\end{corollary}

\begin{example}
For the existence of pullbacks:

Let $f: A_1 \to B$ and $g: A_2 \to B$ be morphisms. Then the pullback of $\begin{tikzcd}
A_1 \ar[r, "f"] & B & \ar[l, swap, "g"] A_2
\end{tikzcd}$ is the equaliser of
\[ \begin{tikzcd}
& A_1 \times A_2 \ar[dl, swap, "\proj_1"] \ar[dr, "\proj_2"] & \\
A_1 \ar[r, "f"] & B & \ar[l, swap, "g"] A_2
\end{tikzcd} \]
TODO: using \ref{walkingConesCocones}.

\end{example}

\section{Finite colimits}
\subsection{Coproducts}

We denote the unique morphism $\left(\begin{smallmatrix}
f \\ g
\end{smallmatrix}\right)$. Also $\coprodParallel{f}{g}$.


\section{Infinite limits and colimits}
\subsection{Projective (or inverse) limit}
\begin{definition}
Let $\sSet{I, \preceq}$ be a reflexive upwards directed set and $\cat{C}$ a category. Let $X_i$ be an object in $\cat{C}$ for all $i\in I$ and let $p_{j,i}: X_j \to X_i$ be a morphism in $\cat{C}$ for all $i \preceq j$ such that
\begin{itemize}
\item $p_{i,i} = \id_{X_i}$ for all $i\in I$;
\item $p_{k,i} = p_{k,j}; p_{j,i} = p_{j,i}\circ p_{k,j}$ for all $i\preceq j \preceq k$.
\end{itemize}
Then the structure $\sSet{I, \{X_i\}_{i\in I}, \{p_{j,i}\}_{i\preceq j}}$ is called a \udef{projective system} (or \udef{inverse system}).

A limit of the diagram
\[ \begin{tikzcd}
{}&{}&{}&{}&{} \\
\hdots \ar[r] & X_k \ar[dr]\ar[ur] \ar[r, "p_{k,j}"]  & X_j \ar[dr]\ar[ur]\ar[r, "p_{j,i}"] & X_i \ar[r]\ar[dr]\ar[ur] & \hdots \\
{}&{}&{}&{}&{}\\
\end{tikzcd} \]
is called a \udef{projective limit} (or \udef{inverse limit}) and is denoted $X=\varprojlim _{i\in I}{X_{i}}$.
\end{definition}
In other words, we have a projective system if the diagram
\[ \begin{tikzcd}[column sep=large]
X_k \ar[rr, "p_{k,i}"] \ar[rd, "p_{k,j}"] & & X_i \\
& X_j \ar[ur, "p_{j,i}"]
\end{tikzcd} \qquad \text{commutes for all $i\preceq j \preceq k$.} \]

TODO: definition using contravariant functor $I\to \cat{C}$.

\begin{proposition} \label{projectiveLimitSet}
In the category $\cat{Set}$ the projective limit of each projective system $\sSet{I, \{X_i\}_{i\in I}, \{p_{j,i}\}_{i\preceq j}}$ exists and is given by
\[ \varprojlim _{i\in I}{X_{i}}=\setbuilder{a\in \prod _{i\in I}A_{i}}{\forall i\preceq j:\; \pi_i(a) = p_{j,i}\big(\pi_j(a)\big)}. \]
\end{proposition}
Compare with constructions in infinitely complete categories.

\subsection{Inductive (or direct) colimit}
\begin{definition}
Let $\sSet{I, \preceq}$ be a reflexive upwards directed set and $\cat{C}$ a category. Let $X_i$ be an object in $\cat{C}$ for all $i\in I$ and let $e_{i,j}: X_i \to X_j$ be a morphism in $\cat{C}$ for all $i \preceq j$ such that
\begin{itemize}
\item $e_{i,i} = \id_{X_i}$ for all $i\in I$;
\item $e_{i,k} = e_{i,j}; e_{j,k} = e_{j,k}\circ e_{i,j}$ for all $i\preceq j \preceq k$.
\end{itemize}
Then the structure $\sSet{I, \{X_i\}_{i\in I}, \{e_{i,j}\}_{i\preceq j}}$ is called an \udef{inductive system} (or \udef{direct system}).

A colimit of the diagram
\[ \begin{tikzcd}
{} \ar[dr]&{}\ar[dr]&{}\ar[dr]&{}&{}\\
\hdots \ar[r] & X_i \ar[r, "e_{i,j}"] & X_j \ar[r, "e_{j,k}"] & X_k \ar[r] & {}\hdots \\
{}\ar[ur]&{}\ar[ur]&{}\ar[ur]&{}&{}\\
\end{tikzcd} \]
is called an \udef{inductive colimit} (or \udef{direct colimit}) and is denoted $X=\varinjlim_{i\in I}{X_i}$.
\end{definition}
In other words, we have an inductive system if the diagram
\[ \begin{tikzcd}[column sep=large]
X_i \ar[rr, "e_{i,k}"] \ar[rd, "e_{i,j}"] & & X_k \\
& X_j \ar[ur, "e_{j,k}"]
\end{tikzcd} \qquad \text{commutes for all $i\preceq j \preceq k$.} \]

TODO: definition using functor $I\to \cat{C}$??

\begin{proposition} \label{inductiveLimitSet}
In the category $\cat{Set}$ the inductive colimit of each inductive system $\sSet{I, \{X_i\}_{i\in I}, \{e_{i,j}\}_{i\preceq j}}$ exists and is given by
\[ \varinjlim X_{i}=\coprod_{i\in I}X_{i}{\Big /}\sim, \]
where $x\sim y$ for some $x\in X_i, y\in X_j$ if there exists $k \succeq i,j$ such that $e_{i,k}(x) = e_{j,k}(y)$.
\end{proposition}
Compare with constructions in infinitely complete categories.

\begin{lemma} \label{elementsOfInductiveLimitImages}
Let $\sSet{I, \{X_i\}_{i\in I}, \{e_{i,j}\}_{i\preceq j}}$ be an inductive system in the category $\cat{Set}$. Then for each $y\in \varinjlim_{i\in I} X_{i}$, there exists $j\in J$ and $x\in X_j$ such that $e_j(x) = y$.
\end{lemma}
\begin{proof}
TODO: use \ref{elementsInCategoryOfSets} + extensivity??
\end{proof}

\chapter{Types of categories}
\section{Abelian categories}
Five lemma. Short exact sequences. Split exact. Exact functors.


\url{https://mathoverflow.net/questions/363720/short-exact-sequences-every-mathematician-should-know}

\begin{definition}
A category $\cat{C}$ is called \udef{abelian} if
\begin{itemize}
\item $\cat{C}$ contains a zero object $0$;
\item $\cat{C}$ contains all binary products and sums;
\item every morphism in $\cat{C}$ has a kernel and cokernel;
\item every monomorphism is a kernel and every epimorphism is a cokernel. (Binormal category)
\end{itemize}
Let $\ker: \mor(\cat{C}) \to \mor(\cat{C})$ be the function that maps morphisms to their kernels. Similarly, let $\coker: \mor(\cat{C}) \to \mor(\cat{C})$ be the function that maps morphisms to their cokernels.
\end{definition}


\begin{proposition} \label{kernelCokernelAdjunction}
Let $\cat{C}$ be an abelian category, $f: A\to B$ a monomorphism and $g: B\to C$ an epimorphism. Then
\[ f\in\ker(g) \qquad\iff\qquad g\in\coker(f). \]
\end{proposition}
\begin{proof}
First assume $f\in\ker(g)$. Then
\[ \begin{tikzcd}
A \arrow[r, "f"] & B \arrow[r, shift left, "g"] \arrow[r, shift right, swap, "{0_{B,C}}"] & C
\end{tikzcd} \qquad \text{commutes.} \]
This implies that
\[ \begin{tikzcd}
A \arrow[r, shift left, "f"] \arrow[r, shift right, swap, "{0_{A,B}}"] & B \arrow[r, shift left, "g"] \arrow[r, shift right, swap, "{0_{B,C}}"] & C
\end{tikzcd} \qquad \text{commutes,} \]
as all paths from $A$ to $C$ are equal to $0_{A,C}$. Thus
\[ \begin{tikzcd}
A \arrow[r, shift left, "f"] \arrow[r, shift right, swap, "{0_{A,B}}"] & B \arrow[r, "g"]  & C
\end{tikzcd} \qquad \text{also commutes.} \]
Thus $g$ determines a cocone under $\begin{tikzcd}
A \arrow[r, shift left, "f"] \arrow[r, shift right, swap, "{0_{A,B}}"] & B
\end{tikzcd}$. We need to show that it is a terminal cocone.

Now $g$ is epic, so there exists $f'$ such that $g\in\coker(f')$. Also there exists $g'\in\coker(f)$. The situation is then depicted as
\[ \begin{tikzcd}[row sep=small, column sep=huge]
A \arrow[dr, "{f}"] & {} & C \\
{} & B \arrow[ur, "{g}"] \arrow[dr, swap, "{g'}"] & {} \\
A' \arrow[ur, swap, "{f'}"] & {} & C'
\end{tikzcd} \]
Because $g$ detemines a cocone of $\begin{tikzcd}
A \arrow[r, shift left, "f"] \arrow[r, shift right, swap, "{0_{A,B}}"] & B
\end{tikzcd}$, we can add the following morphism and the diagram still commutes:
\[ \begin{tikzcd}[row sep=small, column sep=huge]
A \arrow[dr, "{f}"] & {} & C \arrow[dd, "h"] \\
{} & B \arrow[ur, "{g}"] \arrow[dr, swap, "{g'}"] & {} \\
A' \arrow[ur, swap, "{f'}"] & {} & C'
\end{tikzcd} \]
This allows us to note that $g'$ determines a cocone of $\begin{tikzcd}
A' \arrow[r, shift left, "f'"] \arrow[r, shift right, swap, "{0_{A',B}}"] & B
\end{tikzcd}$, indeed $g'f' = hgf' = h0_{A',C} = 0_{A',C'} = g'0_{A',B}$. Thus we can add the morphism $h': C'\to C$ and the diagram
\[ \begin{tikzcd}[row sep=small, column sep=huge]
A \arrow[dr, "{f}"] & {} & C \arrow[dd, shift left, "h"] \\
{} & B \arrow[ur, "{g}"] \arrow[dr, swap, "{g'}"] & {} \\
A' \arrow[ur, swap, "{f'}"] & {} & C' \arrow[uu, shift left, "{h'}"]
\end{tikzcd} \]
commutes if we remove $h$. By \ref{leftRightRelatedIsomorphic} the entire diagram commutes and $h,h'$ are inverses of each other. As they determine isomorphisms in the cocone categories, we have that $g$ also determines a terminal cocone (by \ref{initialTerminalIsomorphisms}). So $g\in \coker(f)$.

The opposite implication is dual.
\end{proof}

\begin{lemma}
Let $\cat{C}$ be an abelian category. Then
\begin{enumerate}
\item $\ker(0) = \id$;
\item $\coker(0) = \id$;
\item $\ker(\id) = 0$;
\item $\coker(\id) = 0$.
\end{enumerate}
\end{lemma}

\begin{proposition}
Let $\cat{C}$ be an abelian category. Then
\begin{enumerate}
\item every monomorphism is split monic;
\item every epimorphism is split epic.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Let $f: A\to B$ be a monomorphism. Then $0_{0,A}\in\ker(f)$ by \ref{epicMonicZeroKernelCokernel} and thus $f\in \coker(0_{0,A})$ by \ref{kernelCokernelAdjunction} in particular $f$ is a coleg of $\begin{tikzcd}
0 \arrow[r] & A
\end{tikzcd}$. Now $1_A\in\coker(0,A)$ by \ref{identityAsKernelCokernel}.

By definition of cokernel there exists $g: B\to A$ such that the diagram
\[ \begin{tikzcd}
&& B \arrow[d, "g"] \\
0 \arrow[r] & A \arrow[r, "{1_A}"] \arrow[ur, "f"] & A
\end{tikzcd}\qquad\text{commutes.} \]
In particular $gf = 1_A$.

(2) Dual.
\end{proof}
\begin{corollary}
Let $\cat{C}$ be an abelian category. A morphism that is both monic and epic is an isomorphism.
\end{corollary}



\begin{proposition}
Abelian categories are bicomplete.
\end{proposition}
\begin{proof}
We first show that abelian categories are complete using \ref{productsMonicPullbacksComplete}. We just need to verify that monic pullbacks exist. Let $f: A_1\to B$ and $g: A_2\to B$ be monomorphisms.

First take $h: B\to Y\in \coker(g)$ and then take $p_1: X\to A_1 \in \ker(hf)$. Finally we see that $hfp_1 = 0_{A_1, Y}p_1 = h0_{X,B}$, so there exists a unique $p_2$ such that
\[ \begin{tikzcd}
X \arrow[r, "{p_1}"] \arrow[d, swap, "{p_2}"] & A_1 \arrow[d, "f"] & \\
A_2 \arrow[r, "g"] & B \arrow[r, "h"] & Y
\end{tikzcd} \qquad\text{commutes.} \]
We have thus constructed a cone over $\begin{tikzcd}
A_1 \arrow[r, "f"] & B & \arrow[l, swap, "g"] A_2
\end{tikzcd}$. To show this cone is terminal, take morphisms $p_1': X'\to A_1$ and $p_2': X'\to A_2$ such that
\[ \begin{tikzcd}
X' \arrow[r, "{p_1'}"] \arrow[d, swap, "{p_2'}"] & A_1 \arrow[d, "f"] \\
A_2 \arrow[r, "g"] & B
\end{tikzcd}\qquad \text{commutes.} \]
We have
\[ hfp_1' = hgp_2' = h0_{A_2, B}p_2' = 0_{X',Y} = 0_{A_1, Y}p_1', \]
so there exists a unique morphism $m:X'\to X$ such that $p_1' = p_1m$. We now just need to show that $p_2' = p_2m$. Indeed,
\[ gp_2' = fp_1' = fp_1m = gp_2m \]
and $g$ is monic, so $p_2' = p_2m$.
\end{proof}

\begin{proposition}
Let $\cat{C}$ be an abelian category and $f: A\to B$ a morphism. Then
\begin{enumerate}
\item $f$ is monic \textup{if and only if} $\ker(f) = 0$;
\item $f$ is epic \textup{if and only if} $\coker(f) = 0$.
\end{enumerate}
\end{proposition}
\begin{proof}
TODO \ref{walkingConesCocones}?
\end{proof}

\subsection{Images and coimages}
\begin{definition}
Let $\cat{C}$ be an abelian category and define
\begin{itemize}
\item $\im(f) = \ker\coker(f)$;
\item $\coim(f) = \coker\ker(f)$.
\end{itemize}
\end{definition}
\subsubsection{Exact sequences}
\begin{proposition} \label{exactnessConditions}
The following are equivalent for all morphisms $\begin{tikzcd}
A \ar[r, "f"] & B \ar[r, "g"] & C
\end{tikzcd}$:
\begin{enumerate}
\item $\im(f) = \ker(g)$;
\item $\coim(g) = \coker(f)$;
\item $f = \ker\coker\ker(g)$(?)
\end{enumerate}
\end{proposition}

\begin{definition}
A sequence of chained morphisms is \udef{exact} if each link satisfies the conditions in \ref{exactnessConditions}.
\end{definition}

\subsubsection{Short exact sequences}

\subsection{Additive structure}

\begin{proposition} \label{biproductIsomorphism}
Let $\cat{C}$ be an abelian category and $A,B$ objects in $\cat{C}$. Then
\[\begin{tikzcd}
A + B \ar[r, "\coprodMorph{(\id_A, 0)}{(0, \id_B)}"] & A\times B
\end{tikzcd} \]
is an isomorphism.
\end{proposition}

\section{Extensive categories}
TODO \url{https://www.sciencedirect.com/science/article/pii/002240499390035R}

\begin{definition}
Let $\cat{C}$ be a category with coproducts and consider the coproduct diagram
\[ \begin{tikzcd}
A \ar[r, "e_A"] & A \coprod B & \ar[l, swap, "e_B"] B
\end{tikzcd} \]
If for all diagrams of the form
\[ \begin{tikzcd}
X \ar[r] \ar[d] & Z \ar[d] & Y \ar[l] \ar[d] \\
A \ar[r, "e_A"] & A \coprod B & \ar[l, swap, "e_B"] B
\end{tikzcd} \]
we have that the top row is a coproduct if and only if the two squares are pullbacks,
then $\cat{C}$ is called \udef{extensive}.
\end{definition}

\begin{proposition}
Let $\cat{C}$ be a category with coproducts and a terminal object $1$. The $\cat{C}$ is extensive \textup{if and only if} for all diagrams of the form
\[ \begin{tikzcd}
X \ar[r] \ar[d] & Z \ar[d] & Y \ar[l] \ar[d, "1_Y"] \\
1 \ar[r] & 1 \coprod 1 & \ar[l] 1
\end{tikzcd} \]
where the bottom row is a coproduct diagram, we have that the top row is a coproduct if and only if the two squares are pullbacks.
\end{proposition}
\begin{proof}
The direction $\Rightarrow$ is immediate from the definition of extensivity. We now prove the other direction.

Take an arbitrary diagram of the form
\[ \begin{tikzcd}
X \ar[r] \ar[d] & Z \ar[d] & Y \ar[l] \ar[d] \\
A \ar[r, "e_A"] & A \coprod B & \ar[l, swap, "e_B"] B
\end{tikzcd} \]
It can be completed to a diagram of the form
\[ \begin{tikzcd}[column sep=large]
X \ar[r] \ar[d] & Z \ar[d] & Y \ar[l] \ar[d] \\
A \ar[r, "e_A"] \ar[d, "1_A"] \pbCorner & A \coprod B \ar[d, "{\coprodParallel{1_{A\coprod B}}{1_{A\coprod B}}}"] & \ar[l, swap, "e_B"] B \ar[d, "1_B"] \pbflipCorner \\
1 \ar[r] & 1 \coprod 1 & \ar[l] 1
\end{tikzcd} \]
where the bottom squares are pullbacks by assumption.

If the top two squares are pullbacks, then both rectangles are pullbacks by \ref{pullbackLemma}. Then by assumption (ignoring the central row) the top row must be a coproduct.

Conversely, if the top row is a coproduct, then the two rectangles are pullbacks, which implies that the top two squares are pullbacks by \ref{pullbackLemma}.
\end{proof}
\begin{corollary}
The category $\cat{Set}$ is extensive.
\end{corollary}
\begin{proof}

\end{proof}

\chapter{Monads / adjunctions}
TODO:   In particular, it is an algebraic category (varietal, in the terminology of [43]); that
is, the foregetful functor from frames to sets is monadic. What this means in
practice is that we can define a frame by specifying generators and relations
for it, in the same way that we are accustomed to specify presentations for
groups and other familiar algebraic structures.