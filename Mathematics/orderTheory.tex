\chapter{Ordered sets}
\section{Order relations}
\begin{definition}
All types of orders are transitive.
\begin{itemize}
\item A \udef{preorder} or \udef{quasiorder} $\precsim$ is also reflexive.
\item A \udef{total preorder} is also connex.
\item A \udef{partial order} $\preceq$ is also reflexive and anti-symmetric.
\item A \udef{strict partial order} $\prec$ is also irreflexive (or, equivalently, asymmetric).
\item A \udef{total order} $\leq$ is also reflexive, anti-symmetric and connex. Connex means all elements are comparable.
\item A \udef{strict total order} $<$ is also trichotomous.
\end{itemize}
An \udef{ordered set} is a pair $\sSet{P,\Yleft}$ such that $P$ is a set and $\Yleft$ is an order on $P$. We call this ordered set
\begin{itemize}
\item a \udef{proset} if $\Yleft$ is a preorder;
\item a \udef{poset} if $\Yleft$ is a partial order;
\end{itemize}
\end{definition}

A total preorder is necessarily also reflexive by \ref{connexityConsequences}.

A strict partial order is necessarily also anti-symmetric by \ref{asymmetricIrreflexive} and \ref{asymmetryAntisymmetry} (which is why there is no separate notion of ``strict preorder'').

A strict total order is like a total order that is strict (i.e. irreflexive instead of reflexive).  However by \ref{connexityConsequences}, no irreflexive relation can be connex, so we relax the requirement to semi-connexity:
\[ \begin{cases}
\text{transitive} \\ \text{trichotomous}
\end{cases} \iff \begin{cases}
\text{transitive} \\ \text{irreflexive} \\ \text{\textit{semi}-connex}
\end{cases}. \]

If we say $\sSet{P,\Yleft}$ is an ordered set without any other qualifiers, we only assume $\Yleft$ is transitive.

\begin{example}
\begin{itemize}
\item Every equivalence relation is a preorder. Conversely, symmetric preorders are equivalence relations.
\item Let $X$ be a set. Then $\sSet{\powerset(X), \subseteq}$ is a poset.
\item Let $A$ be a set and $\id_A$ the identity relation on $A$. Then $\sSet{A,\id_A}$ is a poset. Such posets are called \udef{discrete posets}. Two elements $x,y\in A$ are comparable if and only if $x=y$.
\item Let $B$ be a set and $\bot\in B$. Then the order $\preceq$ defined by
\[ x \preceq y \defequiv (x=\bot) \lor (x = y) \]
is a partial order. Such posets are called \udef{flat posets}.
\end{itemize}
\end{example}

\begin{lemma}
For any binary homogeneous relation $R$,
\begin{enumerate}
\item the reflexive transitive closure, $R^{+=}$, is a preorder;
\item the left residual, $R\backslash R = \overline{R^\transp;\overline{R}}$ is a preorder.
\end{enumerate}
\end{lemma}

\begin{lemma} \label{preorderEquivalence}
Let $(P, \precsim)$ be a proset. Then $\precsim \cap \precsim^\transp$ is an equivalence relation.
\end{lemma}

Let $\sSet{P,\Yleft}$ be an ordered set. We can decompose $\Yleft = \Yleft_S \cup \Yleft_A$, as in \ref{symmetricAsymmetricDecomposition}, into a symmetric and asymmetric part.
\begin{itemize}
\item By \ref{asymmetricIrreflexive} an order is strict (i.e. irreflexive) if and only if it is asymmetric: $\Yleft_S = E_P$ and $\Yleft_A = \Yleft$.
\item For non-strict partial and total orders we have $\Yleft_S = \id_P$.
\end{itemize}

So we can turn a partial / total order into a strict partial / total order by removing $\id_P$. Conversely, we can turn a strict partial / total order into a partial / total order by adding $\id_P$.

\begin{proposition}
\mbox{}
\begin{enumerate}
\item Let $(P, \precsim)$ be a proset. The relation $\precsim \cap\; \overline{\precsim}^\transp$
is a strict partial order.
\item Let $(P, \preceq)$ be a poset. The relation $\preceq \cap \;\overline{\preceq}^\transp = \preceq \cap\; \overline{\id}_P$
is a strict partial order.
\item Let $(P, \prec)$ be a strict partial order. Then $\prec \cup \id_P$ is a partial order.
\item Let $(P, \leq)$ be a totally ordered set. The relation $\leq \cap\; \overline{\leq}^\transp = \leq \cap\; \overline{\id}_P = \overline{\leq}^\transp$
is a strict total order.
\item Let $(P, <)$ be a strict total order. Then $< \cup \id_P$ is a total order.
\end{enumerate}
Multiple different preorders are associated to the same strict partial orders. For partial and total orders the association is one-to-one.
\end{proposition}

\section{Covering relations}
\begin{definition}
Let $(P,\Yleft)$ be a an order relation and $x,y\in P$. We say $y$ \udef{covers} $x$ if
\begin{itemize}
\item $x\Yleft y$;
\item $x\neq y$
\item $\nexists z\in P\setminus\{x,y\}: x\Yleft z \Yleft y$).
\end{itemize}
We write $x\lessdot y$.
\end{definition}

\begin{lemma}
Let $(P,\Yleft)$ be an ordered set. Let $\Yleft_A$ be the asymmetric part of $\Yleft$. Then $\lessdot = \Yleft_A \cap \overline{\Yleft_A^2}$.
\end{lemma}

\begin{lemma}
Let $P$ be a preordered set. Then $y$ covers $x$ \textup{if and only if} $x\neq y$ and $[x,y] = \{x,y\}$.
\end{lemma}

\subsection{Hasse diagrams}
A \udef{Hasse diagram} is a graphical depiction of an order relation. Each element of the ordered set is a point and points are connected such that:
\begin{enumerate}
\item if $x \Yleft y$, then the point for $x$ is drawn lower than the point for $y$;
\item two elements $x,y$ are connected if $y$ covers $x$ or $x$ covers $y$.
\end{enumerate}

TODO is transitive (reflective) reduction! (+ link Galois)

\begin{lemma}
The Hasse diagrams of partial orders are acyclic due to anti-symmetry.
\end{lemma}

\begin{example}
The power set $\powerset\{a,b,c\}$ can be ordered by the inclusion relation $\subseteq$. The following is a Hasse diagram for this ordered set:
\begin{center}
\begin{tikzcd}
 & \{a,b,c\} & \\
\{a,b\}\ar[ru, dash] & \{a,c\}\ar[u,dash] & \{b,c\}\ar[lu,dash] \\
\{a\} \ar[u,dash] \ar[ru, dash] & \{b\} \ar[lu, dash] \ar[ru, dash] & \{c\} \ar[lu,dash] \ar[u, dash] \\
 & \emptyset \ar[lu, dash] \ar[u, dash] \ar[ru, dash] &
\end{tikzcd}
\end{center}
\end{example}

\section{The dual of an ordered set}
\begin{definition}
For any ordered set $(P, \Yleft)$ the \udef{dual} of $P$ is the ordered set $(P^o, \Yleft^o)$, where $P^o \defeq P$ and $\Yleft^o \defeq \Yleft^\transp = \Yright$.
\end{definition}
This means $\forall a,b\in P: a\Yleft b \iff b\Yleft^o a$.

\begin{lemma}
The dual of an ordered set of a particular type is an ordered set of the same type.
\end{lemma}
\begin{corollary}
All statements about all ordered sets also hold for all duals of ordered sets.
\end{corollary}

\section{Functions on ordered sets}
TODO define for all relations
\begin{definition}
Let $(P, \Yleft_P)$ and $(Q, \Yleft_Q)$ be ordered sets and $f: P\to Q$ a function.
\begin{itemize}
\item $f$ is \udef{order-preserving}, \udef{isotone}, \udef{monotonically increasing} or just \udef{increasing} if $f$ is relation-preserving;
\item $f$ is \udef{order-reversing}, \udef{antitone}, \udef{monotonically decreasing} or just \udef{decreasing} if $f: P\to Q^o$ is relation-preserving;
\item $f$ is \udef{monotone} or \udef{monotonic} if $f$ is relation-preserving as either a function $P\to Q$ or $P\to Q^o$.
\end{itemize}
Similarly we say $f$ is (reverse) order-reflecting or a (reverse) order embedding if $f$ is relation-reflecting or a relation embedding as a function $P\to Q$ (resp. $P\to Q^o$).

The adjectives ``strict'' and ``weak'' can be added to any of these cases to identify whether the (weak, i.e. reflexive) order or the associated strict order is meant.
\end{definition}
The concept of order isomorphism (or \udef{similarity}) is similarly inherited. Let $U,V$ be ordered sets. We write $U =_o V$ if $U$ and $V$ are order isomorphic and $U \neq_o V$ if not.

\begin{lemma} \label{orderReflectionIsInjective} \label{strictOrderPreservationIsInjective}
Let $P,Q$ be posets and $f: P\to Q$. The following are sufficient conditions for $f$ to be injective:
\begin{enumerate}
\item $f$ is order-reflecting;
\item $f$ is strictly order-preserving and $P$ is totally ordered.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) If $f(x) = f(y)$, then $x\preceq y$ and $y\preceq x$, so $x=y$ by anti-symmetry.

(2) Let $f$ be the strict order-preserving function and $x,y\in P$. Assume $f(x)=f(y)$. Assume, towards a contradiction, that $x\neq y$, then either (by totality) $x< y$ and $f(x) < f(y)$ or $y < x$ and $f(y)<f(x)$. Both cases contradict $f(x)=f(y)$.
\end{proof}

\begin{lemma}
Let $f:P\to Q$ be a function between posets. Then
\begin{enumerate}
\item If $f$ preserves strict order, then it is order-preserving.
\item If $f$ is order-reflecting, then it reflects strict order.
\end{enumerate}
If $f$ is injective, the opposite implications also hold.
\end{lemma}
\begin{corollary}
Let $f: P\to Q$ be a function between posets.
\begin{enumerate}
\item If $f$ is an order embedding, then it is a strict order embedding.
\item If $P$ is totally ordered, the converse implication holds as well.
\end{enumerate}
\end{corollary}
\begin{proof}
Use \ref{orderReflectionIsInjective}.
\end{proof}

The converse does not hold in general if $P$ is a poset because a strict order embedding between posets is not necessarily injective. A counterexample is
\[
\begin{tikzcd}
& \top & \\
x \ar[ur, dash] & & y \ar[ul, dash] \\
& \bot \ar[ul, dash] \ar[ur, dash] &
\end{tikzcd} \qquad \begin{tikzcd} {} \arrow[rr, "f"] & {}& {}\end{tikzcd} \qquad \begin{tikzcd}
f(\top) \\ f(x) = f(y) \ar[u,dash] \\ f(\bot) \ar[u,dash]
\end{tikzcd}.
\]

\begin{lemma} \label{equivalenceOrderPreservingReflecting}
Let $f:P\to Q$ be a function between totally ordered sets. Then
\begin{enumerate}
\item If $f$ preserves strict order, then it is order-preserving.
\item If $f$ is order-reflecting, then it reflects strict order.
\end{enumerate}
If $f$ is injective, the opposite implications also hold.
\end{lemma}
\begin{proof}
(1) Assume $f$ order-reflecting. Assume $x\leq y$. Either $f(x)\leq f(y)$ or $f(y)\leq f(x)$. If $f(y)\leq f(x)$, then
\[ y\leq x \implies x=y \implies f(x)=f(y) \implies f(x)\leq f(y). \]
So in both cases $f(x)\leq f(y)$.

(2) Assume $f$ preserves strict order. Assume $f(x) < f(y)$. Either $x<y, y<x$ or $x=y$. If either $y<x$ or $x=y$ hold, preservation of strict order yields a contradiction. So $x<y$.

(1') Assume $f$ order-preserving and injective. Assume $f(x)\leq f(y)$. Either $x\leq y$ or $y\leq x$. If $y\leq x$, then
\[ f(y)\leq f(x) \implies f(x)=f(y) \implies x= y \implies x\leq y. \]
So in both cases $x\leq y$.

(2') Assume $f$ is injective reflects strict order. Assume $x < y$. Either $f(x)<f(y), f(y)<f(x)$ or $f(x)=f(y)$. If $f(y)<f(x)$, preservation of strict order yields a contradiction. If $f(x)=f(y)$, injectivity yields a contradiction. So $f(x)<f(y)$.
\end{proof}


\begin{proposition}
Let $\sSet{P,R}$ and $\sSet{Q,\Yleft}$ be relational structures and $f:P\to Q$ a function. Assume $\Yleft$ is a preorder. Then the following are equivalent:
\begin{enumerate}
\item $f$ is relation-preserving;
\item $R;f;\Yleft \subseteq f;\Yleft$;
\item the inverse image of every principal down-set is closed under $R^\transp$;
\item $\Yleft;f^\transp; R \subseteq \Yleft;f^\transp$
\item the inverse image of every principal up-set is closed under $R$.
\end{enumerate}
\end{proposition}
\begin{proof}
$(1 \Rightarrow 2)$ By \ref{relationPreserving} we have $R;f \subseteq f;\Yleft$. Then $R;f;\Yleft \subseteq f;\Yleft^2 \subseteq f;\Yleft$ by transitivity.

$(2 \Rightarrow 1)$ By reflexivity we have $\id_Q \subseteq \Yleft$ and so $R;f \subseteq R;f;\Yleft \subseteq f;\Yleft$. Thus $f$ is relation-preserving by \ref{relationPreserving}.

$(3)$ Is simply a translation of $\forall x: R;f;Sx \subseteq f;Sx$.

$(4)$ Equivalent to (2) by taking transposed and using that $f$ is $\Yleft$-preserving iff $f$ is $\Yleft^\transp$-preserving.

$(3)$ Is simply a translation of $\forall x: xS;f^\transp; R \subseteq xS;f^\transp;f^\transp$.
\end{proof}

\begin{proposition}
Let $\sSet{P,\leq_P}$ and $\sSet{Q,\leq_Q}$ be posets and $f:P\to Q$ a function. Then $f$ is residuated \textup{if and only if} the inverse image of every principal down-set is a principal down set.
\end{proposition}
Clearly we can replace ``down-set'' with ``up-set'' by considering the dual order.
\begin{proof}
This follows directly from \ref{preimagesGaloisIdentity} and \ref{preorderGaloisIdentity}.
\end{proof}

\begin{definition}
A function $f: P\to P$ on an ordered set $(P,\Yleft)$ into itself is
\begin{itemize}
\item \udef{expansive} if $\forall x\in P: x\Yleft f(x)$;
\item \udef{contractive} if $\forall x\in P: f(x)\Yleft x$.
\end{itemize}
\end{definition}

\begin{lemma}
Let $f:P\to P$ be a function on an ordered set $(P,\Yleft)$. Consider $(P\to P)$ to be ordered by pointwise order. Then the following are equivalent:
\begin{enumerate}
\item $f$ is expansive;
\item $\id_P \Yleft f$;
\item $\graph(f) \subseteq \graph(\Yleft)$.
\end{enumerate}
The following are also equivalent:
\begin{enumerate}
\item $f$ is contractive;
\item $f \Yleft \id_P$;
\item $\graph(f) \subseteq \graph(\Yleft^\transp)$.
\end{enumerate}
\end{lemma}

\subsection{Closure}

\subsubsection{Moore closure}
\begin{definition}
Let $A$ be a set.
\begin{itemize}
\item A \udef{(Moore) closure} is a monad on the poset $\sSet{\powerset(A), \subseteq}$.
\item A \udef{(Moore) dual closure} is a comonad on the poset $\sSet{\powerset(A), \subseteq}$.
\end{itemize}
\end{definition}

\begin{example}
Let $\sSet{A,R}$ be a relational structure. Then
\[ \closure_R: \powerset(A) \to \powerset(A): X \mapsto (X^{R})^{R^\transp} \]
is a closure due to \ref{polarsGaloisConnection}.
\end{example}


\begin{proposition}
Let $A$ be a set and $f: \powerset(A) \to \powerset(A)$ a function. Then $f$ is a closure \textup{if and only if} $f$ is
\begin{itemize}
\item extensive: $\forall X\subseteq A: X \subseteq f(X)$;
\item isotone: $\forall X,Y\subseteq A: $ if $X \subseteq Y$, then $f(X) \subseteq f(Y)$;
\item idempotent: $\forall X\subseteq A:  f(f(X)) = f(X)$.
\end{itemize}
And $f$ is a dual closure \textup{if and only if} $f$ is
\begin{itemize}
\item contractive: $\forall X\subseteq A: X \supseteq f(X)$;
\item isotone: $\forall X,Y\subseteq A: $ if $X \subseteq Y$, then $f(X) \subseteq f(Y)$;
\item idempotent: $\forall X\subseteq A:  f(f(X)) = f(X)$.
\end{itemize}
\end{proposition}
The contents of this proposition is often given as the definition of a (Moore) closure.
\begin{proof}
Sufficiency $\Rightarrow$ is clear. In particular extensivity/contractivity follows from \ref{preorderGaloisCondition}.

Upper adjoint can be taken to be $\id_{\im(f)}$.
\end{proof}



The family of saturated sets is a Moore family. The For any $x\in P$, the downset $\downset x$ is saturated.

\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set and let $f:P \to P$ be a function. We say $f$ is a \udef{(Moore) closure} on $P$ if it is
\begin{itemize}
\item extensive: $x \Yleft f(x)$;
\item monotone: if $A \Yleft B$, then $\closure(A) \Yleft \closure(B)$;
\item idempotent: $\closure(\closure(A)) = \closure(A)$.
\end{itemize}
We say $f$ is a \udef{dual closure} if it is
\begin{itemize}
\item contractive: $f \leq \id$
\item monotone
\item idempotent
\end{itemize}
\end{definition}

\begin{definition}
Let $A$ be a subset of an ordered set $P$. If $A = (A^u)^l$, the $A$ is called \udef{saturated}.
\end{definition}

\begin{definition}
Let $\sSet{A, R}$ be a relational structure. We say a set $X\subseteq A$ is \udef{$R$-closed} if $X_R \subseteq X$.
\end{definition}

\begin{lemma}
Let $\sSet{A, R}$ be a relational structure. A set $X\subseteq A$ is $R$-closed \textup{if and only if} $X^c \subseteq X^{\overline{R}}$.
\end{lemma}
\begin{proof}
We have $X_R \subseteq X \iff X^c \subseteq (X_R)^c = X^{\overline{R}}$.
\end{proof}

\begin{proposition}
Let $\sSet{A,R}$ be a relational structure.
\begin{enumerate}
\item For all $X\subseteq A$, the $R$-closure $\closure_R(X)$ is $R$-closed.
\item The closure function $\closure_R$ is identical to the function
\[ \powerset(A) \to \powerset(A): X\mapsto \bigcap \setbuilder{Y}{X \subseteq Y \subseteq A \;\text{and $Y$ is $R$-closed}}. \]
\end{enumerate}
\end{proposition}
\begin{proof}
(1) We have $\closure_R(X)_R = X_R$ due to the generalised inverses of \ref{imagePreimageGaloisConnection}.

(2) 
\end{proof}
\begin{lemma}
Every Moore closure is an $R$-closure for some homogeneous relation $R$.
\end{lemma}

\begin{proposition}
Let $L$ be a lattice and $f$ a closure. Then $f[L]$ is a lattice with lattice operations given by
\[ a\wedge b = a\wedge_L b, \qquad a\vee b = f(a\vee_L b). \]
\end{proposition}
\begin{proof}
Take $a,b\in f[L]$. Because $f$ is extensive, we have $a\wedge_L b \leq f(a\wedge_L b)$ and because $f$ is monotone, we have $f(a\wedge_L b)\leq f(a)\wedge_L f(b)$ by \ref{orderPreservingFunctionLatticeOperations}, so
\[ f(a)\wedge_L f(b) = a\wedge_L b \leq f(a\wedge_L b) \leq f(a)\wedge_L f(b), \]
meaning that $a\wedge_L b \in f[L]$ and thus $f[L]$ is a $\wedge$-subsemilattice.

From $a\vee_L b \leq f(a\vee_L b)$, it is clear that $f(a\vee_L b)$ is an upper bound of $\{a,b\}$. Let $c$ be any other upper bound in $f[L]$. Clearly $a\vee_L b \leq c$, so $f(a\vee_L b) \leq f(c) = c$, meaning $f(a\vee_L b)$ is the least upper bound in $f[L]$.
\end{proof}
\begin{proposition} \label{completeLatticeOperationsUnderClosure}
Let $L$ be a complete lattice and $f$ a closure. Then $f[L]$ is a complete lattice with lattice operations given by
\[ \bigwedge A = {\bigwedge}_L A, \qquad \bigvee A = f({\bigvee}_L A). \]
\end{proposition}
\begin{proof}
TODO
\end{proof}

\begin{theorem}[Dedekind-MacNeille]
Every ordered set $E$ can be embedded in a Dedekind complete lattice $L$ such that meets and joins that exist in $E$ are preserved in $L$.
\end{theorem}
\begin{proof}
We use the closure $f: \powerset(E) \to \powerset(E): A\mapsto A^{ul}$.
\end{proof}

\subsubsection{Closure under a relation}

\begin{proposition}
Let $\sSet{P, \leq}$ be a partially ordered set and $\sSet{Q, \leq}$ a complete meet semi-sublattice. Then $\upset: P \to \powerset(Q)$ and $\bigwedge: \powerset(Q) \to P$ are antitone generalised inverses. 
\end{proposition}


\begin{definition}
Let $R$ be a homogeneous binary relation on a set $X$. Let $A\subseteq X$ be a subset.
\begin{itemize}
\item We call $A$ \udef{$R$-closed} if $AR \subseteq A$.
\item We define the \udef{$R$-closure} of $A$ in $X$ as
\[ \closure_R(A) \defeq \bigcap \setbuilder{B}{A \subseteq B \subseteq X \land \;\text{$B$ is $R$-closed}}. \]
\end{itemize}
\end{definition}

\begin{proposition} \label{RclosureIsClosure}
Let $R$ be a homogeneous binary relation on a set $X$ and $A\subseteq X$ a subset. Then $\closure_R$ is a proper closure operator:
\begin{enumerate}
\item $A \subseteq \closure_R(A)$;
\item if $A\subseteq B$, then $\closure_R(A) \subseteq \closure_R(B)$;
\item $\closure(\closure(A)) = \closure(A)$;
\end{enumerate}
and
\begin{enumerate} \setcounter{enumi}{3}
\item $\closure_R(A)$ is $R$-closed;
\item $\closure_R(A)$ is the smallest $R$-closed superset of $A$ in the poset $\sSet{\powerset(X),\subseteq}$;
\item $A$ is $R$-closed \textup{if and only if} $A = \closure_R(A)$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) This is clear.

(2) This follows because $\setbuilder{C}{A \subseteq C \subseteq X \land \;\text{$C$ is $R$-closed}} \supseteq \setbuilder{C}{B \subseteq C \subseteq X \land \;\text{$C$ is $R$-closed}}$.

(3) This follows because $\closure_R(A) \in \setbuilder{C}{\closure_R(A) \subseteq C \subseteq X \land \;\text{$C$ is $R$-closed}}$.

(4) We calculate
\begin{align*}
\closure_R(A)R &= \left(\bigcap \setbuilder{B}{A \subseteq B \subseteq X \land \;\text{$B$ is $R$-closed}}\right)R \\
&\subseteq \bigcap \setbuilder{BR}{A \subseteq B \subseteq X \land \;\text{$B$ is $R$-closed}} \\
&\subseteq \bigcap \setbuilder{B}{A \subseteq B \subseteq X \land \;\text{$B$ is $R$-closed}} = \closure_R(A).
\end{align*}

(5) Intersection is infimum in $\sSet{\powerset(X),\subseteq}$. (TODO terminology higher??)

(6) The direction $\Leftarrow$ is clear because $\closure_R(A)$ is $R$-closed. The converse follows from (5).
\end{proof}

\begin{lemma}
Let $R$ be a homogeneous binary relation on a set $X$ and $A\subseteq X$ a subset. Then
\begin{enumerate}
\item $\closure_R(AR) \subseteq \closure_R(A)$;
\item $\closure_R(A) = A \cup \closure_R(AR)$;
\item $\closure_R(AR) = \closure_R(A)R$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) We calculate $AR \subset \closure_R(A)R \subseteq \closure_R(A)$, using \ref{monotonicityImage} and the fact that $\closure_R(A)$ is $R$-closed.

(2) The inclusion $\closure_R(A) \supseteq A \cup \closure_R(AR)$ is given by \ref{RclosureIsClosure} and point (1).

For the converse it is enough to see that $A \cup \closure_R(AR)$ is $R$-closed:
\[ \big(A \cup \closure_R(AR)\big)R = AR \cup \closure_R(AR)R \subseteq \closure_R(AR) \subseteq A \cup \closure_R(AR), \]
where we have used that $\closure_R(AR)$ is $R$-closed.

(3) First we calculate
\[ \closure_R(A)R = \big(A \cup \closure_R(AR)\big)R = AR \cup \closure_R(AR)R \subseteq \closure_R(AR)R \subseteq \closure_R(AR) \]
where we have used point (2) and the fact that $\closure_R(AR)$ is closed.

For the converse it is enough to prove that $AR \subseteq \closure_R(A)R$ and $\closure_R(A)R$ is $R$-closed. The first follows from \ref{monotonicityImage} as does the second, with
\[ \closure_R(A)R \subseteq \closure_R(A) \implies \big(\closure_R(A)R\big)R \subseteq \closure_R(A)R. \]
\end{proof}

\begin{lemma}
Let $R$ be a homogeneous binary relation on a set $X$. Let $\im_R$ denote the function $\powerset(X) \to \powerset(X): A \mapsto AR$. Then for all $A\subseteq X$:
\[ \closure_R(A) = \bigcup \closure_{\im_R}(\powerset(A)). \]
IS THIS TRUE?
\end{lemma}


\subsubsection{Closure under a function}

\begin{lemma}
$\closure_f(A) = \setbuilder{f(a)}{a\in A}$.

$\closure_g(A) = \setbuilder{g(a,b)}{a,b\in A}$.
\end{lemma}

TODO $\im$ and $\closure$.

\section{Subsets of ordered sets}
\subsection{Up and down sets}
\begin{lemma} \label{imageClosureTransitiveRelations}
Let $\sSet{P, \Yleft}$ be an ordered set. Then the closure function $\closure_{\Yleft}$ equals the image function $\im_{\Yleft^=}$ of the reflexive closure $\Yleft^=$.
\end{lemma}

\begin{definition}
Let $\sSet{P, \Yleft}$ be an ordered set and $Q\subseteq P$. We denote
\begin{itemize}
\item the \udef{upward closure} of $Q$ as $\upset Q \defeq \closure_{\Yleft}(Q) = Q_{\Yleft} \cup Q$;
\item the \udef{downward closure} of $Q$ as $\downset Q \defeq \closure_{\Yleft^\transp}(Q) = Q_{\Yleft^\transp} \cup Q$.
\end{itemize}
We call $Q$
\begin{itemize}
\item \udef{upwards closed} or an \udef{up set} if $\upset Q = Q$;
\item \udef{downwards closed} or a \udef{down set} if $\downset Q = Q$.
\end{itemize}
For $x\in P$,
\begin{itemize}
\item $\upset x \defeq \upset\{x\}$ is the \udef{principal up set} generated by $x$;
\item $\downset x \defeq \downset\{x\}$ is the \udef{principal down set} generated by $x$.
\end{itemize}
\end{definition}

\begin{lemma} \label{upwardDownwardClosure}
Let $\sSet{P, \Yleft}$ be an ordered set and $Q\subseteq P$. Then
\begin{enumerate}
\item $Q$ is upwards closed \textup{if and only if} $Q_\Yleft \subseteq Q$;
\item $Q$ is downwards closed \textup{if and only if} $Q_{\Yright} \subseteq Q$;
\end{enumerate}
also
\begin{enumerate} \setcounter{enumi}{2}
\item if $\Yleft$ is a preorder, then $Q_\Yleft = \upset Q$ and $Q_{\Yright} \subseteq \downset Q$.
\end{enumerate}
\end{lemma}
\begin{proof}
This follows directly from \ref{imageClosureTransitiveRelations}.
\end{proof}





\subsection{Upper and lower bounds}

\begin{lemma} \label{upperBoundUpsetlowerBoundDownset}
Let $(P,\Yleft)$ be an ordered set and $S$ a non-empty subset of $P$, then
\begin{enumerate}
\item $\upset S^u \subseteq S^u$ and $(\downset S)^u \subseteq S^u$;
\item $\upset S^u \subseteq S^u$ and $(\upset S)^l \subseteq S^l$.
\end{enumerate}
\end{lemma}
In particular $S^u$ is an up set and $S^l$ a down set.
\begin{corollary} \label{minMaxUpsetDownset}
Let $(P,\Yleft)$ be a preordered set, $x\in P$ and $S$ a non-empty subset of $P$, then
\begin{enumerate}
\item $x \in \max(\downset x)$;
\item $x \in \min(\upset x)$;
\item if $\max(S)\neq \emptyset$, then $\downset S = \downset \max(S)$;
\item if $\min(S)\neq \emptyset$, then $\upset S = \upset \min(S)$.
\end{enumerate}
\end{corollary}



\subsection{Chains}
\begin{definition}
Let $(P,\Yleft)$ be an ordered set. A \udef{chain} in $P$ is a linearly ordered subset $S$ of $P$, i.e.
\[ \forall x,y\in S: x\Yleft y \lor y\Yleft x. \]

An \udef{antichain} is a subset $A$ such that no two elements of $A$ are comparable.
\end{definition}

\begin{example}
For every $n\in \N$ there exists a chain $\mathbb{n}$ of $n$ elements and an antichain $\overline{\mathbb{n}}$ of $n$ elements:
\[ \mathbb{1}: \begin{tikzcd}
\circ
\end{tikzcd} \qquad \mathbb{2}: \begin{tikzcd}
\circ \ar[d, dash] \\ \circ
\end{tikzcd} \qquad \mathbb{3}: \begin{tikzcd}
\circ \ar[d, dash] \\ \circ \ar[d, dash] \\ \circ
\end{tikzcd} \qquad \hdots \]
\[ \overline{\mathbb{1}}: \begin{tikzcd}
\circ
\end{tikzcd} \qquad \overline{\mathbb{2}}: \begin{tikzcd}
\circ & \circ
\end{tikzcd} \qquad \overline{\mathbb{3}}: \begin{tikzcd}
\circ & \circ & \circ
\end{tikzcd} \qquad \hdots \]
\end{example}

\begin{lemma} \label{boundsFiniteChain}
Let $P$ be an ordered set. If $C$ is a non-empty, finite chain in $P$, then
\begin{enumerate}
\item $\sup(C) \supseteq \max(C) \neq \emptyset$;
\item $\inf(C) \supseteq \min(C) \neq \emptyset$.
\end{enumerate}
\end{lemma}
\begin{proof}
The $\supseteq$-relation is due to \ref{maxSupMinInf}.

The proof that $\max(C)$ is non-empty is by induction on the cardinality of $C$. For the base case, assume $C$ has one element $x$. Then $x \leq x$, so $x\in \max(C)$.

Now assume all chains with one fewer element than $C$ have a maximal element. Pick some $x_0\in C$, then $y = \max(C\setminus \{x_0\})$ exists. We can compare $x_0$ and $y$ because $C$ is a chain. If $x_0 \leq y$, then $\max(C) = y$. If $y \leq x_0$, then $\max(C) = x_0$. This exhausts the possibilities.
\end{proof}

\begin{definition}
An ordered set $P$
\begin{itemize}
\item is \udef{chain-complete} or \udef{inductive} if every chain in $P$ has a least upper bound;
\item satisfies the \udef{ascending chain condition} (ACC) if each chain in $P$ that has a least element is finite;
\item satisfies the \udef{descending chain condition} (DCC) if each chain in $P$ that has a greatest element is finite.
\end{itemize}
\end{definition}

\begin{lemma}
Every inductive poset has a least element.
\end{lemma}
\begin{proof}
The empty set $\emptyset$ is a chain in any poset $P$. Then $\sup(\emptyset) = \min(\emptyset^u) = \min(P)$.
\end{proof}

\begin{lemma}
Let $P$ be an ordered set.
\begin{enumerate}
\item If $P$ satisfies to ascending chain condition, then for each non-empty chain $C$ in $P$ we have $\max(C) \neq \emptyset$;
\item If $P$ satisfies to descending chain condition, then for each non-empty chain $C$ in $P$ we have $\min(C) \neq \emptyset$,
\end{enumerate}
\end{lemma}
\begin{proof}
Assume $P$ satisfies the ascending chain condition and take a non-empty chain $C\subset P$. Take some $x_0\in C$ and define $C' = \setbuilder{c\in C}{x_0 \Yleft c}$. Clearly $x_0$ is a leat element of $C'$, so $C'$ is finite by ACC and $\max(C) = \max(C') \neq \emptyset$ by \ref{boundsFiniteChain}.
\end{proof}
\begin{corollary}
Let $P$ be an ordered set. If $P$ satisfies the ascending chain condition and has a least element, then $P$ is inductive.
\end{corollary}
\begin{proof}
We have $\sup(C) \supseteq \max(C)$ by \ref{maxSupMinInf}.
\end{proof}

\begin{example}
The set $\N$ is not inductive, because $\N$ itself does not have a least upper bound. It therefore does also not satisfy the ascending chain condition.

It does satisfy the descending chain condition.
\end{example}


\begin{proposition} \label{inductive}
Let $A,B$ be sets and $P$ an ordered set. Then the following posets are inductive:
\begin{enumerate}
\item $\powerset(A)$, ordered by inclusion;
\item $(A \not\to B)$, ordered by inclusion;
\item the set of chains in $P$, ordered by inclusion.
\end{enumerate}
\end{proposition}
\begin{proof}
In all cases the least upper bound of a chain $S$ is given by $\bigcup S$.
\end{proof}

\subsection{Intervals}
\begin{definition}
Let $(P,\Yleft)$ be an ordered set and $m,n\in P$. We define
\begin{itemize}
\item the \udef{closed interval} $[m,n] \defeq \setbuilder{k\in P}{m\Yleft k \land k\Yleft n}$;
\item the \udef{open interval} $]m,n[ \defeq [m,n]\setminus\{m,n\}$;
\item the \udef{half-open intervals}
\begin{align*}
[m,n[ &\defeq [m,n]\setminus\{n\}; \\
]m,n] &\defeq [m,n]\setminus\{m\}.
\end{align*}
\end{itemize}
\end{definition}

\begin{lemma} \label{emptyInterval}
Let $(P,\Yleft)$ be an ordered set and $m,n\in P$.
\begin{enumerate}
\item If $m \cancel\Yleft n$, then $[m,n] = \emptyset$.
\item If $\Yleft$ is a preorder, then
\begin{enumerate}
\item $m \cancel\Yleft n$ \textup{if and only if} $[m,n] = \emptyset$;
\item either $[m,n] = \emptyset$ or $\{m,n\} \subseteq [m,n]$.
\end{enumerate}
\end{enumerate}
\end{lemma}
\begin{proof}
(1) We prove by contraposition. Assume $k\in [m,n]$, then $m\Yleft k$ and $k\Yleft n$, so $m\Yleft n$ by transitivity.

(2) (a) The direction $\Rightarrow$ is given by \ref{emptyInterval}. Now assume $m \Yleft n$. Also $m\Yleft m$ and $n \Yleft n$ by reflexivity. So $m,n\in [m,n]$ by definition. This also gives point (b).
\end{proof}


\section{Completeness}
\begin{definition}
An ordered set $P$ is 
\begin{itemize}
\item \udef{order complete} (or simply \udef{complete}) if each subset has a supremum and an infimum;
\item \udef{order $\sigma$-complete} if each countable subset has a supremum and an infimum;
\item \udef{finitely order complete} if each finite subset has a supremum and an infimum;
\item \udef{Dedekind complete} if
\begin{itemize}
\item each non-empty subset that is bounded above has a supremum; and
\item each non-empty subset that is bounded below has an infimum;
\end{itemize}
\item \udef{Dedekind $\sigma$-complete} if
\begin{itemize}
\item each non-empty countable subset that is bounded above has a supremum; and
\item each non-empty countable subset that is bounded below has an infimum.
\end{itemize}
\item \udef{finitely Dedekind complete} if
\begin{itemize}
\item each non-empty finite subset that is bounded above has a supremum; and
\item each non-empty finite subset that is bounded below has an infimum.
\end{itemize}
\end{itemize}
\end{definition}
Some authors use ``order completeness'' to mean what we have called Dedekind completeness.

\begin{example}
The closed unit disk in $\R^2$ with coordinatewise ordering is Dedekind complete, but not order complete and is not a lattice.
\end{example}

\begin{lemma}
Let $P$ be an ordered set that contains a least and a greatest element. Then $P$ is order complete \textup{if and only if} $P$ is Dedekind complete.
\end{lemma}
\begin{proof}
Every set is bounded (by the least and greatest elements).
\end{proof}

\begin{proposition} \label{existenceSupremaInfima}
Let $(P,\precsim)$ be an ordered set. Then the following are equivalent:
\begin{enumerate}
\item $P$ is order complete;
\item each subset of $P$ has a supremum;
\item each subset of $P$ has an infimum;
\item each non-empty subset of $P$ has a supremum and $P$ has a least element;
\item each non-empty subset of $P$ has an infimum and $P$ has a greatest element.
\end{enumerate}
The following are also equivalent:
\begin{enumerate}
\item $P$ is Dedekind complete
\item each non-empty set that is bounded above has a supremum;
\item each non-empty set that is bounded below has an infimum.
\end{enumerate}
\end{proposition}
\begin{proof}
We show that (2) and (3) are equivalent. The other assertions then follow simply.

Suppose each subset has a supremum and let $S$ be a subset. Then in particular $S^l$ has a supremum. This supremum of $S^l$ is an infimum of $S$:
\[ \sup(S^l) = (S^l)^u\cap((S^l)^u)^l = (S^l)^u\cap S^l = \inf(S).  \]

The converse is similar.

For equivalence with (3) and (4), we just need to remark that $\sup(\emptyset) = \min(P)$ and $\inf(\emptyset) = \max(P)$.

For Dedekind completeness the argument is similar, we just need to remark that if $S$ is non-empty and bounded below, then $S^l$ is non-empty and bounded above.
\end{proof}


\begin{lemma}
The ordered natural numbers $\sSet{\N,\leq}$ are complete.
\end{lemma}
\begin{proof}
Any set of natural numbers has a least element by \ref{proposition:wellOrderingN}. Any non-empty set $S$ of natural numbers that is bounded above, we can take $\max(S) = \min(\N\setminus S)-1$.
\end{proof}

\subsection{Directed sets}
\begin{definition}
An ordered set $(D,\Yleft)$ is called
\begin{itemize}
\item \udef{(upward) directed} if every finite subset has an upper bound;
\item \udef{downward directed} if every finite subset has a lower bound.
\end{itemize}
If $(D,\Yleft)$ is a directed set, we call the relation $\Yleft$ a \udef{direction}.
We call 
\end{definition}
TODO: use $\closure_\vee$ and $\closure_\wedge$.

TODO: important note: $\closure_\vee$ only implies closure under finite $\vee$

\begin{example}
\begin{itemize}
\item Any non-empty chain is directed.
\item An antichain is directed iff it is a singleton.
\end{itemize}
\end{example}

TODO: move:
\begin{proposition}
Let $\{(D_i,\Yleft_i)\}_{i\in I}$ be a family of directed sets. Then $D= \prod_{i\in I}D_i$ is a directed set with direction defined by
\[ (a_i)_{i\in I} \Yleft (b_i)_{i\in I} \iff \forall i\in I: a_i\Yleft_i b_i. \]
The directed set $(D,\Yleft)$ is called a \udef{product direction}.
\end{proposition}


\section{Ordered sets of subsets}
\subsection{The ``finer than / coarser than'' relation}
\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set and $A,B \subseteq P$. We say $A$ is \udef{finer} than $B$ (or $B$ is \udef{coarser} than $A$) if $B\subseteq \upset A$.

If $A$ is finer than $B$ and $B$ is finer than $A$, we write $A \approx B$ and say $A$ and $B$ are \udef{equally fine} or \udef{equally coarse}.
\end{definition}

Alternatively, we say $A$ is finer than $B$ iff
\[ \forall b\in B: \exists a\in A: \; a \Yleft b. \]

For up upwards closed sets, ``finer than'' is $\supseteq$ and ``coarser than'' is $\subseteq$.

\begin{lemma}
Let $\sSet{P,\Yleft}$ be an ordered set and $A,B,C \subseteq P$. Then
\begin{enumerate}
\item if $A$ is finer than $B$ and $B$ is finer than $C$, then $A$ is finer than $C$;
\item if $\Yleft$ is a preorder, then $A$ is finer than $A$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) Assume $A$ is finer than $B$ and $B$ is finer than $C$. Then $B \subseteq \upset A$ and $C\subseteq \upset B$, so $C \subseteq \upset\upset A \subseteq \upset A$.

(2) from \ref{TODO}.
\end{proof}
\begin{corollary}
Let $\sSet{P,\Yleft}$ be a preordered set.
\begin{enumerate}
\item The ``finer than'' relation is a preorder on $\powerset(P)$.
\item The equivalence derived from this relation is an equivalence relation.
\end{enumerate}
\end{corollary}
The equivalence relation is the equivalence from \ref{preorderEquivalence}.

\begin{lemma}
Let $\sSet{P,\Yleft}$ be an ordered set and $A \subseteq P$. Then
\begin{enumerate}
\item $A$ is finer than $\upset A$;
\item if $\Yleft$ is a preorder, then $A \approx \upset A$;
\item $A \approx B$ implies $\upset A = \upset B$;
\item if $\Yleft$ is a preorder, then $A \approx B$ \textup{if and only if} $\upset A = \upset B$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) is equivalent to $\upset A \subseteq \upset A$.

(2) We need to show that $\upset A$ is finer than $A$, i.e. $A\subseteq \upset\upset A$. This follows from \ref{TODO}.

(3) Assume $A \approx B$. Then $A \subseteq \upset B$ and $B \subseteq \upset A$. This implies $\upset A \subseteq \upset\upset B \subseteq \upset B$ and $\upset B \subseteq \upset\upset A \subseteq \upset A$.

(4) Assume $\upset A = \upset B$. Then $A$ is finer than $\upset B$ and $B$ is finer than $\upset A$. The result then follows using (2).
\end{proof}


\subsubsection{Refinement}
\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set and $A,B \subseteq P$. We say $A$ \udef{refines} $B$ (or $A$ is a \udef{refinement} of $B$) if $A\subseteq \downset B$.
\end{definition}

\begin{lemma}
Let $f:P\to Q$ be an order reversing function between ordered sets. Let $A,B\in P$. Then
\begin{enumerate}
\item if $A$ refines $B$, then $f[B]$ is finer than $f[A]$;
\item if $A$ is finer than $B$, then $f[B]$ refines $f[A]$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) $A \subseteq \downset B$ implies $f[A] \subseteq f[\downset B] \subseteq \upset f[B]$.

(2) $B \subseteq \upset A$ implies $f[B] \subseteq f[\upset A] \subseteq \downset f[A]$.
\end{proof}

\subsection{The ordered set of downsets}
\begin{definition}
Let $P$ be an ordered set. The set of down sets in $P$ is denoted $\downsets(P)$.
\end{definition}

\begin{lemma}
Let $P$ be an ordered set.
If $P$ is a discrete poset, then $\downsets(P) = \powerset(P)$.
\end{lemma}

\begin{proposition} \label{orderedSetPowerset}
Let $P$ be a preordered ordered set. Then $x\mapsto \downset x$ is an order embedding between $P$ and the principal down sets in $P$.

If $P$ is a partial order, then the map is bijective and thus an order isomorphism.
\end{proposition}
\begin{proof}
The first part is just \ref{TODO}.

For the second part, $x\mapsto \downset x$ is surjective by definition. For injectivity: the inverse map is given by $Q\mapsto \max(Q)$. This is a function by \ref{minMaxSingletons} and an inverse by \ref{minMaxUpsetDownset}.
\end{proof}

\begin{lemma}
Let $P_1,P_2$ be prosets and $\mathbb{1}$ a singleton. Then
\begin{enumerate}
\item $\downsets(P)^o \cong \downsets(P^o)$;
\item $\downsets(P\oplus \mathbb{1}) \cong \downsets(P)\oplus \mathbb{1}$;
\item $\downsets(\mathbb{1}\oplus \mathbb{1}) \cong \mathbb{1}\oplus \downsets(P)$;
\item $\downsets(P_1\sqcup P_2)\cong \downsets(P_1)\times \downsets(P_2)$.
\end{enumerate}
\end{lemma}

\section{Join- and meet-density}
\begin{definition}
Let $P$ be a poset and let $Q\subset P$ be a subset. Then $Q$ is called \udef{join-dense} in $P$ if for every $x\in P$, there exists a subset $S\subset Q$ such that $x= \bigvee_P S$.

The dual of join-dense is \udef{meet-dense}.
\end{definition}

\section{Atoms}
\subsection{Atomic elements}
\begin{definition}
Let $\sSet{P,\leq}$ be a poset.
\begin{itemize}
\item An element $a\in P$ is called an \udef{atom} if $a$ is minimal in $P\setminus\min(P)$.
\item An element $a\in P$ is called a \udef{coatom} if $a$ is maximal in $P\setminus\max(P)$.
\end{itemize}
We denote the set of atoms of $P$ as $\atoms(P)$. The set of coatoms is denoted $\coatoms(P)$.
\end{definition}
If $P$ has a least element $\bot$, then $a$ is an atom if and only if it covers $\bot$.



\subsection{Atomic posets}
\begin{definition}
Let $\sSet{P,\leq}$ be a poset. Then
\begin{itemize}
\item $P$ is \udef{atomic} if $\forall x\in L\setminus\min(L): \exists a\in\atoms(L): a\leq x$;
\item $P$ is \udef{coatomic} if $\forall x\in L\setminus\min(L): \exists a\in\coatoms(L): a\geq x$;
\end{itemize}
also
\begin{itemize}
\item $P$ is \udef{strongly atomic} if $\forall x,y\in L$ the poset $[x,y]$ is atomic;
\item $P$ is \udef{strongly coatomic} if $\forall x,y \in L$ the poset $[x,y]$ is coatomic;
\end{itemize}
and
\begin{itemize}
\item $P$ is \udef{atomistic} if $\atoms(L)$ is join-dense in $L$;
\item $P$ is \udef{coatomistic} if $\coatoms(L)$ is meet-dense in $L$.
\end{itemize}
\end{definition}

\url{https://www.emis.de/journals/PM/51f4/pm51f409.pdf}


\section{Combining ordered sets}
\begin{definition}
Let $P,Q$ be ordered sets. Then
\begin{itemize}
\item the \udef{disjoint union} $P\sqcup Q$ is ordered by
\[ x\precsim y \iff \begin{cases}
x,y\in P \;\text{and}\; x\precsim y \\
x,y\in Q \;\text{and}\; x\precsim y
\end{cases} \]
\item the \udef{linear sum} $P\oplus Q$ is the disjoint union ordered by
\[ x\precsim y \iff \begin{cases}
x,y\in P \;\text{and}\; x\precsim y \\
x,y\in Q \;\text{and}\; x\precsim y \\
x\in P \;\text{and}\; y\in Q
\end{cases} \]
\end{itemize}
\end{definition}

\begin{example}
We define $\mathbf{M}_n \defeq \mathbb{1}\oplus \overline{\mathbb{n}} \oplus \mathbb{1}$:
\[ \mathbf{M}_1: \begin{tikzcd}
\circ \ar[d, dash] \\ \circ \ar[d, dash] \\ \circ
\end{tikzcd} \qquad \mathbf{M}_2: \begin{tikzcd}
&\circ \ar[ld, dash] \ar[rd, dash] & \\ \circ \ar[rd, dash] && \circ \ar[ld, dash] \\ &\circ &
\end{tikzcd} \qquad \mathbf{M}_3: \begin{tikzcd}
&\circ \ar[ld, dash] \ar[d,dash] \ar[rd, dash] &\\ \circ \ar[rd, dash]& \circ \ar[d, dash] & \circ \ar[ld, dash] \\ &\circ &
\end{tikzcd} \qquad \hdots \]
\end{example}

\begin{lemma}
For ordered sets taking the disjoint union or linear sum is associative.
\end{lemma}

\begin{lemma}
Let $m,n\in \N$. If $p = m+n$, then $\mathbb{m}\oplus\mathbb{n} = \mathbb{p}$.
\end{lemma}

\begin{definition}
Let $P,Q$ be ordered sets. Then
\begin{itemize}
\item  the standard order on $P\times Q$ is defined by
\[ (x_1,x_2) \precsim (y_1,y_2) \iff x_1\precsim y_1 \;\text{and}\; x_2\precsim y_2 \]
\item the \udef{lexicographic order} on $P\times Q$ is defined by
\[ (x_1,x_2) \precsim (y_1,y_2) \iff (x_1\precsim y_1) \;\text{or}\; (x_1=y_1 \;\text{and}\; x_2\precsim y_2). \]
\end{itemize}
\end{definition}


\chapter{Lattices}
\section{Semilattice}
\begin{definition}
A \udef{semilattice} is an algebraic structure $\sSet{S,\star}$ where $\star$ is a binary operation on the set $S$ satisfying
\begin{itemize}[leftmargin=2.5cm]
\item[\textbf{Associativity}] $x\star (y\star z) = (x\star y) \star z$;
\item[\textbf{Commutativity}] $x \star y = y \star x$;
\item[\textbf{Idempotency}] $x\star x = x$.
\end{itemize}
We call a semilattice \udef{bounded} if it contains an identity $e$ for $\star$. We write $\sSet{S, \star, e}$.
\end{definition}
In other words a semilattice is a commutative idempotent semigroup or commutative band.

\begin{lemma}
Let $(P,\leq)$ be a poset and let $\{x,y,z\}\subseteq P$ be such that each subset has a supremum. Then
\[ \sup\{\sup\{x,y\},z\} = \sup\{x,y,z\} = \sup\{x,\sup\{y,z\}\} \]
and, dually,
\[ \inf\{\inf\{x,y\},z\} = \inf\{x,y,z\} = \inf\{x,\inf\{y,z\}\}. \]
\end{lemma}
\begin{corollary}
Let $(P,\leq)$ be a poset.
\begin{enumerate}
\item If $\sup\{x,y\}$ exists for all $x,y\in P$, then $\sSet{P,\sup}$ is a semilattice.
\item If $\inf\{x,y\}$ exists for all $x,y\in P$, then $\sSet{P,\inf}$ is a semilattice.
\end{enumerate}
\end{corollary}

\begin{proposition} \label{orderSemilattice}
Let $\sSet{S,\star}$ be a semilattice. Define the relations $\leq_1, \leq_2$ on $S$ by
\[ \forall x,y\in S:\qquad x\leq_1 y \; \iff \; x = x\star y \;\iff\; y\leq_2 x. \] 
Then
\begin{enumerate}
\item $\sSet{S,\leq_1}$ is a poset such that $\forall x,y\in S:\; x\star y = \inf_{\leq_1}\{x,y\}$;
\item $\sSet{S,\leq_2}$ is a poset such that $\forall x,y\in S:\; x\star y = \sup_{\leq_2}\{x,y\}$;
\item $\sSet{S,\leq_1}$ and $\sSet{S,\leq_2}$ are dual order structures, i.e. $\leq_1 = \leq_2^\transp$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) First we prove $\sSet{S,\leq_1}$ is a poset:
\begin{itemize}
\item Reflexivity follows from idempotency.
\item Antisymmetry follows from commutativity:
\[ x\leq_1 y, y\leq_1 x \quad\implies\quad x = x\star y = y \star x = y. \]
\item For transitivity: assume $x\leq_1 y$ and $y\leq_1 z$. This implies $x = x\star y$ and $y = y\star z$, and so $x = x\star (y\star z) = (x\star y) \star z = x\star z$. This implies $x\leq_1 z$.
\end{itemize}
Next we prove that $\forall x,y\in S:\; x\star y = \inf_{\leq_1}\{x,y\}$.

First we note that $x \star y$ is a lower bound of $\{x,y\}$: we have $(x\star y) \leq_1 x$ because $x\star(x\star y) = (x\star x)\star y = x\star y$. Let $u$ be any other lower bound of $\{x,y\}$. Then $u = x\star u = x\star (y\star u) = (x\star y)\star u$. So $u \leq_1 x\star y$, meaning $x\star y$ is the infimum.

(2) Similar to (1).

(3) Immediate.
\end{proof}

Often we will want to interpret a semilattice as a partially ordered set. This means we need to choose $\leq_1$ or $\leq_2$.
\begin{definition}
Let $\sSet{S,\star}$ be a semilattice. We call $S$
\begin{itemize}
\item a \udef{meet-semilattice} or \udef{$\wedge$-semilattice} if we consider it ordered by $\leq_1$, i.e. $x\star y = \inf\{x,y\}$;
\item a \udef{join-semilattice} or \udef{$\vee$-semilattice} if we consider it ordered by $\leq_2$, i.e. $x\star y = \sup\{x,y\}$.
\end{itemize}
By convention, we represent the semilattice operation $\star$ of a $\wedge$-semilattice by $\wedge$ and of a $\vee$-semilattice by $\vee$.

We usually denote the identity of a $\wedge$-semilattice by $\bot$ and the identity of a $\vee$-semilattice by $\top$.
\end{definition}

We call a poset $\sSet{P,\leq}$
\begin{itemize}
\item a $\wedge$-semilattice if $\inf\{x,y\}$ exists for all $x,y\in P$;
\item a $\vee$-semilattice if $\sup\{x,y\}$ exists for all $x,y\in P$.
\end{itemize}

\subsection{Subsets of semilattices}
\subsubsection{Disjoint elements and meshing elements}
TODO compare with set-theoretical definitions.
\begin{definition}
Let $L$ be a $\wedge$-semilattice with identity $\bot$.

We say $x,y\in L$
\begin{itemize}
\item are \udef{disjoint}, denoted $x \perp y$, if $x\wedge y = \bot$;
\item \udef{mesh}, denoted $x\mesh y$, if $x\wedge y \neq \bot$.
\end{itemize}

Let $S\subset L$. Then
\begin{itemize}
\item the polar $S^\perp$ is called the \udef{disjoint complement} of $S$;
\item the polar $S^{\mesh}$ is called the \udef{grill} of $S$.
\end{itemize}
\end{definition}


\subsection{Complete semilattices}
\begin{lemma}
Let $\sSet{S,\wedge}$ be a semilattice. For every finite set $D\subset S$, $\inf(D)$ exists.
\end{lemma}
\begin{definition}
Let $\sSet{S,\wedge}$ be a semilattice. We call $S$ a \udef{complete semilattice} if each subset $D\subseteq S$ has a supremum. We write
\[ \sup(D) = \bigvee D. \]
If we want to emphasise that the supremum of $D$ is taken as a subset of $S$, we write $\bigvee_S D$.
\end{definition}

We of course have dual definitions for $\vee$-semilattices. In this case we consider suprema and write $\sup(D) = \bigvee D$.

\begin{lemma} \label{supInfFiniteSubsetsLattice}
Let $\sSet{S,\wedge}$ be a semilattice and $F\subseteq S$ a finite subset. Then $\bigvee S$ exists. 
\end{lemma}
In particular every finite semilattice is complete.


\begin{theorem}[Knaster-Tarski fixed-point theorem for semilattices] \label{KnasterTarskiSemilattice}
Let $\sSet{S,\wedge}$ be a complete semilattice and $f:S\to S$ an order-preserving map. Then 
\[ \bigwedge \setbuilder{x\in S}{f(x) \leq x} \]
is the least fixed point of $f$.
\end{theorem}
\begin{proof}
Let $P$ be the set of fixed points of $f$. Set $H = \setbuilder{x\in L}{f(x)\leq x}$ and $\alpha = \bigwedge H$. It is clear that $\alpha$ is a lower bound of $P$ because $P \subset H$. So we just need to show that $\alpha$ is a fixed point.

Now $f(\alpha)$ is a lower bound of $H$ due to $f$ being order preserving: for all $x\in H$ we have $\alpha\leq x$, so $f(\alpha) \leq f(x)$ and also $f(\alpha) \leq f(x) \leq x$. So $f(\alpha)\leq \alpha$ because $\alpha$ is the greatest lower bound.

Conversely, $f(f(\alpha)) \leq f(\alpha)$ because $f$ is order preserving. This means $f(\alpha)\in H$, so $f(\alpha)\leq \alpha$. We have thus shown that $\alpha = f(\alpha)$.
\end{proof}

\subsection{Semilattice homomorphisms}
\begin{proposition} \label{orderPreservingFunctionLatticeOperations}
Let $\sSet{P,\leq}$, $\sSet{Q,\leq}$ be posets and $f: P\to Q$ an order-preserving function.
\begin{enumerate}
\item If $P,Q$ are $\wedge$-semilattices, then
\[  \forall x,y\in P: f(x\wedge y) \leq f(x)\wedge f(y) \quad\iff\quad \text{$f$ is order-preserving}. \]
\item If $P,Q$ are complete $\wedge$-semilattices, then
\[  \forall D\subseteq P: f(\bigwedge D) \leq \bigwedge f[D] \quad\iff\quad \text{$f$ is order-preserving}. \]
\item If $P,Q$ are $\vee$-semilattices, then
\[  \forall x,y\in P: f(x\vee y) \geq f(x)\vee f(y) \quad\iff\quad \text{$f$ is order-preserving}. \]
\item If $P,Q$ are complete $\vee$-semilattices, then
\[  \forall D\subseteq P: f(\bigvee D) \geq \bigvee f[D] \quad\iff\quad \text{$f$ is order-preserving}. \]
\end{enumerate} 
\end{proposition}
\begin{proof}
(1) Assume $f(x\wedge y) \leq f(x)\wedge f(y)$. Then $x\leq y$ implies $x = x\wedge y$, which implies $f(x) = f(x\wedge y) \leq f(x)\wedge f(y) \leq f(y)$.

For the converse: From $x\wedge y \leq x$ we get $f(x\wedge y) \leq f(x)$. Similarly $f(x\wedge y) \leq f(y)$. Together this gives $f(x\wedge y) \leq f(x)\wedge f(y)$.

(2) The direction $\Rightarrow$ follows from (1). Assume $f$ order-preserving. Take arbitrary $D\subseteq P$. For all $x\in D$ we have $\bigwedge D \leq x$, so $f(\bigwedge D) \leq f(x)$. This means $f(\bigwedge D)$ is a lower bound of $f[D]$, so $f(\bigwedge D) \leq \bigwedge f[D]$.

(3,4) Similar.
\end{proof}
\begin{corollary}
Let $\sSet{S,\wedge}, \sSet{T, \wedge}$ be a semilattices and $f: S\to T$ a function. If $f$ is a semilattice homomorphism, then it is order-preserving. The converse does not hold in general.
\end{corollary}
\begin{proof}
We just need to show the converse does not hold. TODO
\end{proof}

\begin{lemma}
Let $\sSet{P,\leq}$, $\sSet{Q,\leq}$ be posets and $f: P\to Q$ a bijective order-embedding.
Then $f$ preserves all meets and joins, i.e. $\forall D\subseteq P$:
\[ f(\bigwedge D) = \bigwedge f[D] \qquad\text{and}\qquad f(\bigvee D) = \bigvee f[D] \]
if the relevant meets and joins exist.
\end{lemma}
TODO does existence of one side of an equals mean existence of the other???
\begin{proof}
We have already proved an inequality in both cases. By bijectivity we can find a $c\in P$ such that $f(c) = \bigwedge f[D]$. By order-reflection, we have that $c$ is a lower bound of $D$, so $c\leq \bigwedge D$. By order-preservation we have $\bigwedge f[D] = f(c) \leq f(\bigwedge D)$.

The other equality is dual.
\end{proof}
\begin{corollary} \label{orderReversingSimilarityLatticeOperations}
Let $\sSet{P,\leq}$, $\sSet{Q,\leq}$ be posets and $f: P\to Q$ a reverse bijective order-embedding. Then $\forall D\subseteq P$
\[ f(\bigwedge D) = \bigvee f[D] \qquad\text{and}\qquad f(\bigvee D) = \bigwedge f[D] \]
if the relevant meets and joins exist.
\end{corollary}

\begin{proposition}
Let $\sSet{S,\wedge}$ be a semilattice and $X$ a set. Then the pointwise ordering of $(X\to S)$ makes it a semilattice. For all $f,g\in (X\to S)$, the function $f\wedge g$ is defined by
\[ f\wedge g: X\to S: x\mapsto (f\wedge g)(x) = f(x) \wedge g(x). \]
If $S$ is a complete semilattice, then so is $(X\to S)$.
\end{proposition}

\begin{proposition} \label{semilatticeOfSemilatticeHomomorphisms}
Let $\sSet{S,\wedge}, \sSet{T, \wedge}$ be (complete) semilattices. The set of (complete) semilattice homomorphisms is a (complete) subsemilattice of $(S\to T)$.
\end{proposition}
\begin{proof}
We calculate for all $x,y\in S$:
\begin{align*}
(f\wedge g)(x\wedge y) &= f(x\wedge y)\wedge g(x\wedge y) = f(x)\wedge f(y) \wedge g(x) \wedge g(y) \\
&= (f(x)\wedge g(x))\wedge(f(y)\wedge g(y)) = (f\wedge g)(x) \wedge (f\wedge g)(y).
\end{align*}
TODO complete notation.
\end{proof}
TODO link universal algebra.

\subsection{Join- and meet-irreducible elements}
\begin{definition}
Let $L$ be a $\vee$-semilattice. We call $x\in L$ \udef{join-irreducible} if
\begin{itemize}
\item $x$ is not a least element of $L$,
\item for all $a,b\in L$: $x= a\vee b$ implies $x=a$ or $x=b$.
\end{itemize}
The definition of \udef{meet-irreducible} is dual on a $\wedge$-semilattice.

We denote the set of join-irreducible elements in $L$ as $\joinIr(L)$ and the set of meet-irreducible elements in $L$ as $\meetIr(L)$.
\end{definition}

\begin{lemma} \label{joinIrreducibleLemma}
Let $S$ be a $\vee$-semilattice and $x\in S$ not a least element. Then the following are equivalent:
\begin{enumerate}
\item $x$ is join-irreducible;
\item for all $a,b\in S$: $x= a\vee b$ implies $x \leq a$ or $x \leq b$;
\item for all $a,b\in S$: $x > a$ and $x > b$ implies $x > a\vee b$;
\item for all finite $F\subseteq S$: $x = \bigvee F$ implies $x\in F$.
\end{enumerate}
\end{lemma}

\begin{lemma}
In a finite lattice $L$, an element is join-irreducible if and only if it
has exactly one lower cover.
\end{lemma}

\begin{example}
Consider the lattice $\seq{\N,\lcm, \gcd}$. A non-zero element of $\N$ is join irreducible if and only if it is of the form $p^r$ for some prime $p$ and $r\in\N$.
\end{example}

\begin{proposition}
$x$ is join-irreducible iff $\downset x$ is linearly ordered.
\end{proposition}

TODO: isolated points
link with boundary

\url{http://www.m-hikari.com/ijcms-password2008/9-12-2008/xuluoshanIJCMS9-12-2008.pdf}

\url{http://imar.ro/journals/Revue_Mathematique/pdfs/2015/2/5.pdf}

\url{https://link.springer.com/content/pdf/10.1007/BF01349957.pdf}

\begin{lemma} \label{atomsJoinIrriducible}
Let $\sSet{P,\leq}$ be a poset. Then
\begin{enumerate}
\item $\atoms(P) \subseteq \joinIr(P)$;
\item $\coatoms(P) \subseteq \meetIr(P)$;
\end{enumerate}
\end{lemma}
\begin{proof}
(1) Assume $a\in \atoms(P)$. Then $a$ is not a least element of $P$. Assume there exist $x,y\in P$ such that $a = x\vee y$. Then $x,y\in \downset a \subseteq \{\bot, a\}$. If $x= \bot = y$, then $a = \bot$, which is not an atom. So either $x = a$ or $y = a$.

(2) Dual.
\end{proof}


\subsection{Generalised inverse of inf}
\begin{proposition}
Let $\sSet{P,\leq}$ be a poset and $S\subseteq P$ a subset such that $\sSet{S,\leq}$ is a complete $\wedge$-semilattice. Then
\[ f: P \to \powerset(S)^o: x\mapsto \upset x \cap S \qquad\text{and}\qquad g: \powerset(S)^o\to P: D\mapsto \bigwedge_S D \]
are order-preserving generalised inverses. Additionally, they form a Galois connection \textup{if and only if} for all $D\subseteq S$: $\bigwedge_P D$ exists and is equal to $\bigwedge_S D$.
\end{proposition}
\begin{proof}
TODO first part.

Assume for all $D\subseteq S$: $\bigwedge_P D$ exists and $\bigwedge_S D = \bigwedge_P D$. It is enough to verify, for all $x\in P$ and $B\subseteq S$
\[ (\upset x)\cap S \supseteq B \iff x\leq \bigwedge_S B. \]
Assume $(\upset x)\cap S \supseteq B$. Then $\upset x \supseteq B$, so $x \bigwedge_P \leq \bigwedge_P B = \bigwedge_S B$. Conversely, assume $x\leq \bigwedge_S B$. Then $B\subseteq \upset_S\bigwedge_S B \subseteq \upset_S x = \upset x\cap S$.

Assume these functions form a Galois connection. In order to obtain a contradiction, assume there exists a $D\subseteq S$ such that $\bigwedge_P D$ does not exist or is larger than $\bigwedge_S D$ (it can never be smaller). In both cases this means there exists a lower bound $y$ of $D$ in $P$ that is larger than $\bigwedge_S D$.

Then $(\upset y)\cap S \supseteq (\upset \bigwedge_S D)\cap S \supseteq D$, but $y\geq \bigwedge_S D$.
\end{proof}

\subsubsection{Projection onto a complete subsemilattice}
\begin{definition}
Let $\sSet{P,\leq}$ be a poset and $S\subseteq P$ a subset such that $\sSet{S,\leq}$ is a complete $\wedge$-semilattice. Then the \udef{(upper) order projection} on $S$ is the function
\[ P_S^u: P \to S: x\mapsto \bigwedge(\upset x\cap S). \]
\end{definition}

\begin{lemma}
Let $\sSet{P,\leq}$ be a poset and $S\subseteq P$ a subset that is a complete $\wedge$-semilattice. The upper order projection $P_S^u$ is
\begin{enumerate}
\item idempotent;
\item order-preserving.
\end{enumerate}
Also $P_S^u$ is expansive \textup{if and only if} for all $D\subseteq S$: $\bigwedge_S D = \bigwedge_P D$.
\end{lemma}
\begin{proof}
(1) Assume $x\in S$. Then $x\in (\upset x \cap S)$ and $x$ is a lower bound of $(\upset x \cap S)$, so $P_S^u(x) = x$.

(2) Assume $x \leq y$. Then $\upset x \supseteq \upset y$, so $\upset x\cap S \supseteq \upset y\cap S$ and $\bigwedge(\upset x\cap S) \subseteq \bigwedge(\upset y\cap S)$.


\end{proof}

\section{Lattices}
\url{file:///C:/Users/user/Downloads/Gr%C3%A4tzer,%20George%20-%20General%20lattice%20theory-Birkh%C3%A4user%20(2007).pdf}
\url{file:///C:/Users/user/Downloads/R.%20Padmanabhan,%20S.%20Rudeanu%20-%20Axioms%20for%20lattices%20and%20Boolean%20algebras-World%20Scientific%20(2008).pdf}
\begin{definition}
A \udef{lattice} is an algebraic structure $\seq{L,\vee, \wedge}$, where $\vee, \wedge$ are binary operations on the set $L$ such that $\seq{L,\vee}$ and $\seq{L,\wedge}$ are semilattices and $\vee,\wedge$ are linked by the absorption law:
\[ \forall a,b\in L: \; a \vee (a \wedge b) = a = a \wedge (a\vee b). \]
We call
\begin{itemize}
\item $\sSet{L,\vee}$ the \udef{join-semilattice} and $a\vee b$ the \udef{join} of $a$ and $b$;
\item $\sSet{L,\wedge}$ the \udef{meet-semilattice} and $a\wedge b$ the \udef{meet} of $a$ and $b$.
\end{itemize}
We call a lattice \udef{bounded} if both the join- and the meet-semilattice are bounded. We denote
\begin{itemize}
\item the identity of the join-semilattice by $\bot$;
\item the identity of the meet-semilattice by $\top$.
\end{itemize}
We denote the bounded lattice $\sSet{L, \vee, \wedge, \bot, \top}$.
\end{definition}
By \ref{absorptionIdempotency} the absortion law renders the axiom of  idempotency of the semilattices redundant. So we just need that $\seq{L,\vee}$ and $\seq{L,\wedge}$ are commutative semigroups that are linked by the absorption law.

\begin{proposition}
Observations from universal algebra:
\begin{enumerate}
\item Subset closed under $\vee,\wedge$ is sublattice.
\item Product lattices
\item Inverse of homomorphism is homomorphism
\end{enumerate}
\end{proposition}

\begin{example}
\begin{itemize}
\item Let $X$ be a set. Then $\mathcal{P}(X)$ ordered by inclusion is a lattice and $\cup, \cap$ are the corresponding join and meet operations.

In particular, for all $A,B\in \mathcal{P}(X)$:
\begin{enumerate}
\item $\inf\{A,B\} = A\cap B$;
\item $\sup\{A,B\} = A\cup B$.
\end{enumerate}
\item The natural numbers forms a lattice if ordered by division. The meet and join are given by
\[ m\vee n = \lcm\{m,n\} \qquad \text{and}\qquad m\wedge n = \gcd\{m,n\}. \]
\end{itemize}
\end{example}

\subsection{Lattices and order}
As for semilattices, we can equivalently characterise lattices as posets with certain conditions.
\begin{proposition}
Let $L$ be a set.
\begin{enumerate}
\item If $\seq{L,\vee, \wedge}$ is a lattice, then $\seq{L,\leq}$ is a poset such that every two element set has a supremum and an infimum, where
\[ \forall x,y\in L:\; x\leq y \qquad \iff \qquad x\vee y = y \]
or, equivalently,
\[ \forall x,y\in L:\; x\leq y \qquad \iff \qquad x\wedge y = x. \]
\item If $\seq{L,\leq}$ is a poset such that every two element set has a supremum and an infimum, then $\seq{L,\vee, \wedge}$ is a lattice, where
\[ \forall x,y\in L: \; x\vee y = \sup\{x,y\} \quad \text{and} \quad x\wedge y = \inf\{x,y\}. \]
\end{enumerate}
The order can also be defined by
\[ \forall x,y\in L:\; x\leq y \qquad \iff \qquad x\wedge y = x. \]
\end{proposition}
\begin{proof}
Mostly this follows from \ref{orderSemilattice}. We just need to show the two definitions of order are equivalent. This follows from the absorption law:
\begin{align*}
x\vee y &= y \implies x\wedge y = x\wedge (x\vee y) = x \\
x\wedge y &= x \implies x\vee y = (x\wedge y) \vee y = y.
\end{align*}
\end{proof}

\begin{lemma} \label{orderLatticeLemma}
Let $L$ be a lattice and $a,b,c,d\in L$. If $a\leq b$ and $c\leq d$, then
\[ a\vee c\leq b\vee d \qquad\text{and}\qquad a\wedge c \leq b\wedge d. \]
\end{lemma}
\begin{proof}
If $a\leq b$ and $c\leq d$, then we have
\[ \begin{cases}
a = a\wedge b \\ c = c\wedge d
\end{cases} \quad \text{and} \quad \begin{cases}
b = a\vee b \\ d = c\vee d.
\end{cases}\]
We calculate
\[ (a\vee c)\wedge (b\vee d) = (a\vee c)\wedge (a\vee b\vee c\vee d) = (a\vee c)\wedge ((a\vee c)\vee (b\vee d)) = a\vee c, \]
so $a\vee c\leq b\vee d$.
Similarly
\[ (a\wedge c)\vee (b\wedge d) = (a\wedge b\wedge c\wedge d)\vee (b\wedge d) = ((a\wedge c)\wedge (b\wedge d))\vee (b\wedge d) = b\wedge d, \]
so $a\wedge c \leq b\wedge d$.
\end{proof}
\begin{corollary} \label{orderLatticeCorollary}
Let $L$ be a lattice and $a,b,c,d\in L$. Then
\begin{enumerate}
\item if $a\leq b$ then $a\vee c \leq b \vee c$ and $a\wedge c \leq b\wedge c$;
\item if $a\leq c$ and $b\leq c$, then $a\vee b \leq c$;
\item if $a\leq b$ and $a\leq c$, then $a\leq b\wedge c$.
\end{enumerate}
\end{corollary}

\begin{lemma} \label{cancellationGeneralLattices}
Let $L$ be a lattice and $a,b\in L$. If for all $x\in L$: $a\vee x = b\vee x$ and $a\wedge x = b\wedge x$, then $a = b$.
\end{lemma}
\begin{proof}
Setting $x = a$ gives $a = a\vee b$ and $a = a\wedge b$. Thus $a \leq b$ and $b \leq a$, meaning $a = b$.
\end{proof}

\begin{proposition}[Mini-max theorem]
Let $L$ be a lattice and let $\seq{a_{i,j}}\subset L$ be indexed by $i,j\in \N$. Then
\[ \bigvee_{j=1}^n \left(\bigwedge_{i=1}^m a_{i,j}\right) \leq \bigwedge_{i=1}^m \left(\bigvee_{j=1}^n a_{i,j}\right). \]
\end{proposition}
\begin{proof}
For all $k,l$ we have $a_{k,l}\leq \bigvee_{j=1}^n a_{k,j}$. This implies $\bigwedge_{i=1}^m a_{i,l} \leq \bigwedge_{i=1}^m \left(\bigvee_{j=1}^n a_{i,j}\right)$ for all $l$. Taking the supremum over $l$ gives the result.
\end{proof}
\begin{corollary}[Median inequality]
Let $L$ be a lattice and $a,b,c \in L$, then
\[ (a\wedge b) \vee (b\wedge c) \vee (c\wedge a) \leq (a\vee b)\wedge (b\vee c) \wedge (c\vee a). \]
\end{corollary}
\begin{proof}
Use $a_{i,j} = \begin{pmatrix}
a & b & a \\ b & b & c \\ a & c & c
\end{pmatrix}$.
\end{proof}
\begin{corollary}[Distributive inequalities] \label{distributiveInequality}
Let $L$ be a lattice and $a,b,c \in L$, then
\begin{align*}
(a\wedge b)\vee (a\wedge c) &\leq a\wedge (b \vee c); \\
(a\vee b)\wedge (a\vee c) &\geq a\vee (b \wedge c).
\end{align*}
In particular this also means
\[ c \leq a \implies (a\wedge b)\vee c \leq a\wedge (b\vee c).  \]
\end{corollary}
\begin{proof}
Use $a_{i,j} = \begin{pmatrix}
a & a \\ b & c 
\end{pmatrix}$ and $a_{i,j} = \begin{pmatrix}
a & b \\ a & c 
\end{pmatrix}$. The particular cases follow because in this case $a\wedge c = c$. This statement is self-dual.
\end{proof}
The distributive inequalities are fairly elementary and do not need to be derived from mini-max theorem. 
In fact they are corollary to the following lemma which can be obtained by more elementary means:
\begin{lemma} \label{UpperLowerBoundsMeetJoin}
Let $L$ be a lattice $x\in L$ and $S\subseteq L$ a subset. Then
\begin{enumerate}
\item $S^u\vee x \subseteq (S\vee x)^u$ and $S^l\vee x \subseteq (S\vee x)^l$;
\item $S^u\wedge x \subseteq (S\wedge x)^u$ and $S^l\wedge x \subseteq (S\wedge x)^l$.
\end{enumerate}
\end{lemma}
\begin{proof}
The maps $y\mapsto y\vee x$ and $y\mapsto y \wedge x$ are order-preserving, so we can use \ref{imagePolars}.
\end{proof}
\begin{corollary}[Infinite distributive inequalities] \label{infiniteDistributiveInequalities}
Let $L$ be a lattice $x\in L$ and $S\subseteq L$ a subset. Assume all relevant suprema exist, then
\begin{enumerate}
\item $\sup(S)\wedge x \geq \sup(S \wedge x)$;
\item $\inf(S)\vee x \leq \inf(S \vee x)$.
\end{enumerate}
\end{corollary}
\begin{proof}
Because $\sup(S)\in S^u$, we have $\sup(S)\wedge x \in S^u\wedge x$, so $\sup(S)\wedge x \in (S\wedge x)^u$ and $\sup(S)\wedge x \geq \min((S\wedge x)^u) = \sup(S\wedge x)$. The second part is dual.
\end{proof}
In particular if $S$ has two elements, we recover the distributive inequalities.


\subsection{Complete lattices}
\begin{lemma}
Let $L$ be a lattice. For every finite set $S\subset L$, $\sup(S)$ and $\inf(S)$ exist.
\end{lemma}
\begin{definition}
Let $L$ be a lattice. We call $L$ a \udef{complete lattice} if each subset $S\subseteq L$ has both a supremum and an infimum. We write
\[ \sup(S) = \bigvee S \qquad \inf(S) = \bigwedge S. \]
If we want to emphasise that the supremum/infimum of $S$ is taken as a subset of $L$, we write $\bigvee_L S$ and $\bigwedge_L S$.
\end{definition}
Clearly every finite lattice is complete.

\begin{lemma} \label{supInfFiniteSubsetsLattice}
Let $L$ be a lattice and $F\subseteq L$ a finite subset. Then $\bigvee F$ and $\bigwedge F$ exist. 
\end{lemma}

\begin{example}
For any set $X$, $\powerset(X)$ is a complete lattice.
\end{example}

\begin{lemma}
Let $P$ be an ordered set such that all relevant suprema and infima exist and $S,T\subseteq P$. Then
\begin{enumerate}
\item $\bigvee S \leq \bigwedge T$ if and only if $s\leq t$ for all $s\in S,t\in T$;
\item if $S\subseteq T$, then $\bigvee S \leq \bigvee T$ and $\bigwedge S \geq \bigwedge T$;
\item $\bigvee(S\cup T) = \left(\bigvee S\right)\vee \left(\bigvee T\right)$ and $\bigwedge(S\cup T) = \left(\bigwedge S\right)\wedge \left(\bigwedge T\right)$.
\end{enumerate}
\end{lemma}

\begin{proposition}[Mini-max theorem for complete lattices]
Let $L$ be a complete lattice, $I,J$ index sets and $\setbuilder{a_{i,j}\in L}{i\in I, j\in J}$. Then
\[ \bigvee_{j\in J}\bigwedge_{i\in I}a_{i,j} \leq \bigwedge_{i\in I}\bigvee_{j\in J} a_{i,j}. \]
\end{proposition}
\begin{proof}
For all $k,l$ we have $a_{k,l}\leq \bigvee_{j\in J} a_{k,j}$. This implies $\bigwedge_{i\in I} a_{i,l} \leq \bigwedge_{i\in I}\bigvee_{j\in J} a_{i,j}$ for all $l$. Taking the supremum over $l$ gives the result.
\end{proof}

\begin{proposition} \label{completeLatticeBasic}
Let $P$ be a non-empty ordered set. Then the following are equivalent:
\begin{enumerate}
\item $P$ is a complete lattice;
\item $\bigvee S$ exists for all subsets $S\subseteq P$;
\item $\bigwedge S$ exists for all subsets $S\subseteq P$;
\item $P$ has a bottom element $\bot$ and $\bigvee S$ exists for all non-empty $S\subseteq P$;
\item $P$ has a top element $\top$ and $\bigwedge S$ exists for all non-empty $S\subseteq P$;
\item for all $x\in P$ both $\upset x$ and $\downset x$ are complete lattices.
\end{enumerate}
\end{proposition}
\begin{proof}
The only difficult implication is $(5)\Rightarrow (1)$. All infima exist because $\inf(\emptyset) = \top \in P$. New each non-empty set $S$ in $P$ has an upper bound, $\top$, so $\bigvee S$ exists in $P$ by \ref{existenceSupremaInfima}. Finally $\bigvee \emptyset = \bot = \bigwedge P \in P$.
\end{proof}

\begin{theorem}[Knaster-Tarski fixed-point theorem]
Let $L$ be a complete lattice and $f:L\to L$ an order-preserving map. Then 
\[ \bigvee \setbuilder{x\in L}{x\leq f(x)} \qquad\text{and}\qquad \bigwedge \setbuilder{x\in L}{x\geq f(x)} \]
are, resp., the greatest and the least fixed point of $f$.
\end{theorem}
\begin{proof}
This is just two applications of the semilattice formulation of the Knaster-Tarski theorem, \ref{KnasterTarskiSemilattice}, once for the join-semilattice and once for the meet-semilattice.
\end{proof}
\begin{corollary}
The set of fixed points of $f$ forms a complete lattice.
\end{corollary}
\begin{proof}
Let $P$ be the set of fixed points. To show $P$ is a complete lattice, take any subset $S\subset P$.
Set $w = \bigvee S$, where $S$ is considered as a subset of $L$. For all $x\in W$: $x\leq w$, which implies $x=f(x)\leq f(w)$. As $w$ is the least upper bound, we have $w\leq f(w)$. This implies $f[\upset w]\subseteq \upset w$, meaning we can view $f$ as a function on the complete lattice $\upset w$. In particular $f|_{\upset w}$ has a least fixed point by the theorem, so $S$ has a supremum in $P$. The existence of the infimum is dual.
\end{proof}
\begin{corollary}[Banach decomposition theorem]
Let $X,Y$ be sets and $f:X\to Y$ and $g:Y\to X$ functions. There exist partitions $X_1,X2$ and $Y_1,Y_2$ of $X$ and $Y$ such that
\[ f[X_1] = Y_1 \qquad\text{and}\qquad g[Y_2] = X_2. \]
\end{corollary}
\begin{proof}
Consider the map $F: \powerset(X)\to\powerset(X): S\mapsto X\setminus g[Y\setminus f[S]]$. By the theorem this map has a fixed point, which we call $X_1$. We then need to set $Y_1 = f[X_1], X_2 = X\setminus X_1$ and $Y_2 = Y\setminus Y_1$. The fact $X_1$ is a fixed point means that $X_1 = X\setminus g[Y\setminus f[X_1]] = g[Y\setminus Y_1] = g[Y_2]$.
\end{proof}
\begin{corollary}[Schröder-Bernstein]
Let $X,Y$ be sets and $f:X\rightarrowtail Y$ and $g:Y\rightarrowtail X$ injective functions. Then there exists a bijective function $h: X\twoheadrightarrowtail Y$.
\end{corollary}
\begin{proof}
Use the Banach decomposition theorem to obtain partitions $X_1,X_2$ and $Y_1,Y_2$. Then $f|_{X_1}: X_1\twoheadrightarrowtail Y_1$ and $g|_{Y_2}: Y_2 \twoheadrightarrowtail X_2$ are bijective, so we can construct
\[ h: X\twoheadrightarrowtail Y: x \mapsto \begin{cases}
f(x) & x\in X_1 \\ (g|_{Y_2})^{-1}(x) & x\in X_2
\end{cases}. \]
\end{proof}
The Schröder-Bernstein theorem was already proven in \ref{SchroederBernstein}.

\subsubsection{Upper and lower order projection}
\begin{definition}
Let $L$ be a complete lattice and $S\subseteq L$ a subset. We define
\begin{itemize}
\item the \udef{upper projection} on $S$ as the map $P_S^U: L\to S: x\mapsto \bigwedge (\upset x\cap S)$;
\item the \udef{lower projection} on $S$ as the map $P_S^L: L\to S: x\mapsto \bigvee (\downset x\cap S)$.
\end{itemize}
\end{definition}

\begin{lemma}
Let $L$ be a complete lattice and $S\subseteq L$ a subset. Then the projections $P_S^U, P_S^L$ are
\begin{enumerate}
\item idempotent;
\item order-preserving.
\end{enumerate}
\end{lemma}
\begin{proof}

\end{proof}

\subsubsection{Chain conditions}
The following requires dependent choice:
\begin{proposition} \label{ascendingDescendingChainLattice}
Let $L$ be a lattice. Then
\begin{enumerate}
\item if $L$ satisfies the ascending chain condition, then for all non-empty subsets $S\subset L$ there exists a finite set $F\subset L$ such that $\bigvee S = \bigvee F$;
\item if $L$ satisfies the descending chain condition, then for all non-empty subsets $S\subset L$ there exists a finite set $F\subset L$ such that $\bigwedge S = \bigwedge F$;
\item if $L$ has a bottom element and satisfies the ascending chain condition, then $L$ is complete;
\item if $L$ has a top element and satisfies the descending chain condition, then $L$ is complete;
\item if $L$ has no infinite chains, then $L$ is complete.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Assume $L$ satisfies the ascending chain condition and let $S\subset L$ be non-empty. Define
\[ B = \setbuilder{\bigvee G}{\text{$G$ is a finite, non-empty subset of $S$}}. \]
This is well-defined by \ref{supInfFiniteSubsetsLattice}. Then $B$ has a maximal element $m = \bigvee F$ for some finite $F$ by \ref{welfoundedACC}.

Now $m$ is an upper bound of $S$. Indeed, let $x\in S$. Then $m= \bigvee F \leq \bigvee (F\cup\{x\})$ because $F\subseteq (F\cup \{x\})$. Since $m$ is maximal in $B$, we have $m = \bigvee (F\cup\{x\}) \geq x$. It is clearly also the least upper bound, otherwise it was not the least upper bound of $F$.

(2) Dual of 1.

(3) This follows from 1. and \ref{completeLatticeBasic}.

(4) Dual of 3.

(5) A lattice with no infinite chains satisfies the ascending chain condition. Also a lattice
with no infinite chains has a bottom element. (TODO: need dependent/countable choice?)
\end{proof}

\begin{proposition} \label{joinIrreducibilityDescendingChainLattice}
Let $L$ be a lattice satisfing the descending chain condition. Then
\begin{enumerate}
\item $\forall a,b\in L:\; a\nleq b \implies \exists x\in \joinIr(L): \; x\leq a$ and $x\nleq b$;
\item $\forall a\in L:\; a = \bigvee\setbuilder{x\in\joinIr(L)}{x\leq a}$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Set $S = \setbuilder{x\in L}{\text{$x\leq a$ and $x\nleq b$}}$, which is non-empty and thus contains a minimal element $m$ by \ref{welfoundedACC}. We claim $m$ is join-irreducible. Assume, towards a contradiction, $x = c\vee d$ and $c < x > d$. By minimality of $x$, $c,d\notin S$. As $c,d< x \leq a$, we must have $c,d\leq b$. But this means $x\leq b$, so $x\notin S$ which is a contradiction.

(2) Set $T = \setbuilder{x\in\joinIr(L)}{x\leq a}$. Clearly $a$ is an upper bound of $T$. To see that it is the least upper bound, take a different upper bound $c$. Assume, towards a contradiction, that $a\nleq c$. Then $a\nleq a\wedge c$. By point 1. there exists an $x\in\joinIr(L)$ such that $x\leq a$ (meaning $x\in T$) and $x\nleq a\wedge c$. But if $c$ were an upper bound of $T$, then $x\leq a\wedge c$, which is a contradiction.
\end{proof}

\begin{proposition}
Let $L$ be a lattice.
\begin{enumerate}
\item If $L$ satisfies the descending chain condition, then any subset $Q\supseteq \joinIr(L)$ is join-dense in $L$.
\item If $L$ satisfies the ascending chain condition and $Q$ is join-dense in $L$, then for all $a\in L$ there exists a finite subset $F$ of $Q$ such that $a = \bigvee F$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) is a corollary of \ref{joinIrreducibilityDescendingChainLattice}. (2) is a corollary of \ref{ascendingDescendingChainLattice}.
\end{proof}
\begin{corollary}
Let $L$ be a lattice with no infinite chains. Then
\begin{enumerate}
\item for each $a \in L$, there exists a finite subset $F$ of $\joinIr(L)$ such that $a = F$.
\item $Q\subseteq L$ is join-dense in $L$ if and only if $Q \supseteq \joinIr(L)$.
\end{enumerate}
\end{corollary}
\begin{proof}
If $L$ has no finite chains, then it satisfies the ascending and descending chain conditions.

Only the $\Rightarrow$ direction of (2) is not immediately obvious. Assume $Q$ is join-dense and let $x\in \joinIr(L)$. By the proposition there exists a finite $F\subseteq Q$ such that $x = \bigvee F$. Since $x$ is join-irreducible, we have $x \in F$ and hence $x \in Q$. Thus, $\joinIr(L) \subseteq Q$.
\end{proof}


\subsection{Distributive and modular lattices}
\subsubsection{Distributive lattices}
For all lattices $L$ the distributive inequalities, \ref{distributiveInequality}, hold: $\forall a,b,c \in L$:
\begin{align*}
a \vee (b\wedge c) &\leq (a\vee b) \wedge (a\vee c); \\
a\wedge (b \vee c) &\geq (a\wedge b)\vee (a\wedge c).
\end{align*}

The two corresponding equalities are equivalent:
\begin{proposition} \label{equivalenceDistributiveLaws}
Let $L$ be a lattice. Then the following are equivalent:
\begin{enumerate}
\item $\forall a,b,c \in L: \; a \vee (b\wedge c) = (a\vee b) \wedge (a\vee c)$;
\item $\forall a,b,c \in L: \; a\wedge (b \vee c) = (a\wedge b)\vee (a\wedge c)$.
\end{enumerate}
\end{proposition}
These equivalent equalities are known as the \udef{distributive laws}.
\begin{proof}
We show $(1)\Rightarrow (2)$. Then other implication follows by duality.

Assume (1). Then, for all $a,b,c \in L$:
\begin{align*}
(a\wedge b)\vee (a\wedge c) &= ((a\wedge b)\vee a) \wedge ((a\wedge b)\vee c) & \text{by (1)}\\
&= (a\wedge (c\vee (a\wedge b))  & \text{by the absorption law}\\
&= (a \wedge ((c\vee b) \wedge (c\vee a))  & \text{by (1)}\\
&= a\wedge (b\vee c) & \text{by the absorption law.}
\end{align*}
\end{proof}
Note that it is \emph{not} true that
\[ \forall a,b,c \in L: \; a \vee (b\wedge c) = (a\vee b) \wedge (a\vee c) \iff a\wedge (b \vee c) = (a\wedge b)\vee (a\wedge c). \]

\begin{definition}
A lattice $L$ is called \udef{distributive} if it satisfies the distributive laws.
\end{definition}

\begin{lemma}
A lattice is distributive \textup{if and only if} its dual is distributive.
\end{lemma}

\begin{example}
\begin{itemize}
\item Any totally ordered set is a distributive lattice.
\item For any set $X$, the poset $\sSet{\powerset(X), \subseteq}$ is a distributive lattice.
\end{itemize}
\end{example}

\begin{lemma}
Let $L$ be a lattice. The following are equivalent:
\begin{enumerate}
\item $L$ is distributive;
\item for all $x,y,z,w\in L: \quad x\wedge y \leq w \;\text{and}\; x\wedge z\leq w \implies x\wedge (y\vee z) \leq w;$
\item for all $x,y,z,w\in L: \quad x\vee y \geq w \;\text{and}\; x\vee z\geq w \implies x\vee (y\wedge z) \geq w$.
\end{enumerate}
\end{lemma}
\begin{proof}
Point (1) is self-dual and points (2) and (3) are dual, so it is enough to show that (1) and (2) are equivalent.

Assume $L$ distributive. By \ref{orderLatticeCorollary}, $ x\vee y \geq w$ and $x\vee z\geq w$ imply $(x\wedge y)\vee (x\wedge z) \leq w$. By distributivity, we get (2).

Conversely, we can take $w = (x\wedge y)\vee (x\wedge z)$. Then (2) gives $x\wedge (y\vee z) \leq (x\wedge y)\vee (x\wedge z)$ and the distributive inequality \ref{distributiveInequality} gives the other inequality. 
\end{proof}

\begin{proposition}[Cancellation law for distributive lattices] \label{cancellationDistributiveLattices}
Let $L$ be a distributive lattice and $a,b,c\in L$. Then
\[ \text{$a\vee c = b \vee c$ and $a\wedge c = b \wedge c$ implies $a = b$.} \]
\end{proposition}
Note that we only assume the equalities hold for some $c$, not all $c$. If these equalities hold for all $c$, then we have cancellation in all lattices, not just distributive ones. See \ref{cancellationGeneralLattices}.
\begin{proof}
We calculate, using the absorption law and distributivity,
\[ a = a\vee (a\wedge c) = a \vee (b\wedge c) = (a\vee b)\wedge (a\vee c) = (a\vee b) \wedge (b\vee c) = b \vee (a \wedge c) = b \vee (b\wedge c) = b. \]
\end{proof}

\begin{lemma} \label{disjointComplementIdeal}
Let $L$ be a distributive lattice with a bottom $\bot$ and $S\subset L$. Then $S^\perp$ is an ideal.
\end{lemma}
\begin{proof}
Let $a,b\in S^\perp$. Then for all $x\in S$, we have
\[ (a\vee b)\wedge x = (a\wedge x)\vee (b\wedge x) = \bot\vee \bot = \bot, \]
so $a\vee b\in S^\perp$.

It is also clear $S^\perp$ must be a down set by \ref{orderLatticeCorollary}.
\end{proof}

\subsubsection{Modular lattices}
For all lattices $L$ the modular inequality holds: $\forall a,b,c \in L$:
\[ a\leq c \implies a \vee (b\wedge c) \leq (a\vee b) \wedge c. \]
See \ref{distributiveInequality}.

\begin{proposition} \label{modularEquivalences}
Let $L$ be a lattice. Then the following are equivalent:
\begin{enumerate}
\item $\forall a,b,c\in L$: $a \vee (b\wedge c) = (a\vee b) \wedge c$ if $a\leq c$;
\item $\forall a,b,c\in L$: $a \vee (b\wedge c) = (a\vee b) \wedge (a\vee c)$ if $a\leq b$ or $a\leq c$; the dual of (2);
\item $\forall a,b,c\in L$: $a\vee (b\wedge (a\vee c)) = (a\vee b)\wedge (a\vee c)$; the dual of (3);
\item \textup{Shearing identity}: $\forall a,b,c\in L$: $(a\vee b) \wedge c = (a\vee (b\wedge (a\vee c)))\wedge c$; the dual of the shearing identity.
\end{enumerate}
\end{proposition}
The first of these is referred to as the \udef{modular law}. Notice that it is self-dual.
\begin{proof}
(1) is equivalent to its dual by replacing $a\leftrightarrow c$. This will imply all statements are equivalent to their duals once the equivalence with (1) has been established. 

$\boxed{(1)\Rightarrow (2)}$ Assume (1). Assume $a\leq b$ or $a\leq c$. By relabelling we can assume $a\leq c$.  Then $a\vee c = c$ and (2) clearly follows from (1).


$\boxed{(2)\Rightarrow (3)}$ Apply (2) to $a\leq a\vee c$.

$\boxed{(3)\Rightarrow (1)}$ Assume $a\leq c$. Then $a\vee c = c$ and $a\vee (b\wedge (a\vee c)) = (a\vee b)\wedge (a\vee c)$ reduces to $a \vee (b\wedge c) = (a\vee b) \wedge c$.

$\boxed{(3)\Rightarrow (4)}$ We calculate, using (3),
\[ (a\vee (b\wedge (a\vee c)))\wedge c = ((a\vee b)\wedge (a\vee c))\wedge c = (a\vee b) \wedge (a\vee c) \wedge c = (a\vee b) \wedge c. \]

$\boxed{(4)\Rightarrow (3)}$ TODO????
\end{proof}

\begin{definition}
A lattice $L$ is called \udef{modular} if it satisfies the modular law.
\end{definition}

\begin{lemma}
If a lattice is distributive, it is also modular.
\end{lemma}
\begin{proof}
If the lattice is distributive, point (2) of \ref{modularEquivalences} holds unconditionally, and so in particular also conditionally.
\end{proof}

\subsubsection{Derived lattices}

\begin{proposition}
(i) If L is a modular (distributive) lattice, then every sublattice of L
is modular (distributive).

(ii) If L and K are modular (distributive) lattices, then L × K is
modular (distributive).

(iii) If L is modular (distributive) and K is the image of L under a
homomorphism, then K is modular (distributive).
\end{proposition}
\begin{corollary}
If a lattice is isomorphic to a sublattice of a product
of distributive (modular) lattices,then it is distributive (modular).
\end{corollary}

\begin{theorem}[$\mathbf{M}_3-\mathbf{N}_5$ theorem]
Let $L$ be a lattice.
\begin{enumerate}
\item $L$ is non-modular \textup{if and only if} $\mathbf{N}_5 \rightarrowtail L$;
\item $L$ is non-distributive \textup{if and only if} $\mathbf{N}_5 \rightarrowtail L$ or $\mathbf{M}_3 \rightarrowtail L$.
\end{enumerate}
\end{theorem}
\begin{proof}
TODO!
\end{proof}

\section{Complementation}
\subsection{Complementation}
\begin{definition}
Let $L$ be a bounded lattice and $x\in L$. We call $y$ a \udef{complement} of $x$ if
\[ x \vee y = \top \qquad \text{and} \qquad x\wedge y = \bot. \]
\end{definition}

\begin{proposition} \label{distributiveComplementUnique}
Let $L$ be a bounded lattice. If $L$ is distributive, then any $x\in L$ has at most one complement.
\end{proposition}
\begin{proof}
This follows from the cancellation law \ref{cancellationDistributiveLattices}. Let $y,y'$ be complements of $x$. Then $y\vee x = \top = y'\vee x$ and $y\wedge x = \bot = y'\wedge x$, so $y=y'$.
\end{proof}

A lattice element may also have no complements.
\begin{example}
The only elements with a complement in a bounded chain are $\top$ and $\bot$.
\end{example}

\subsubsection{Complemented lattices}
\begin{definition}
A \udef{complemented lattice} is a bounded lattice with a function $c:L\to L$, called the \udef{complementation}, such that $c(x)$ is a complement of $x$ for all $x\in L$.

A lattice in which every element has exactly one complement is called a \udef{uniquely complemented lattice}.

A lattice with the property that every interval (viewed as a sublattice) is complemented is called a \udef{relatively complemented lattice}.
\end{definition}
A distributive complemented lattice is uniquely complemented.

\begin{lemma}
Let $L$ be a complemented lattice with complementation $c:L\to L$. Then $c(\top) = \bot$ and $c(\bot) = \top$.
\end{lemma}
\begin{proof}
For $c(\top)$ to be a complement of $\top$, we need $\top \wedge c(\top) = \bot$. But for all $x\in L$ we have $x\leq \top$, so $\top\wedge x = x$. This means we have $c(\top) = \bot$.
\end{proof}

\begin{lemma} \label{uniqueComplementInvolution}
Let $L$ be a uniquely complemented lattice. Then the complementation $c:L\to L$ is an involution.
\end{lemma}
\begin{proof}
Clearly if $c(x)$ is a complement of $x$, then $x$ is a complement of $c(x)$. By uniqueness $c(c(x)) = x$.
\end{proof}

\subsubsection{Orthocomplemented lattices}
\begin{definition}
Let $L$ be a bounded lattice. An \udef{orthocomplementation} is a function $L \to L: x \to \overline{x}$ that maps each element $x\in L$ to an \udef{orthocomplement} $\overline{x}$ such that
\begin{itemize}
\item $x$ and $\overline{x}$ are complements;
\item $x\mapsto \overline{x}$ is an involution: $\overline{\overline{x}} = x$;
\item $x\mapsto \overline{x}$ is order-reversing: $x\leq y \implies \overline{y} \leq \overline{x}$.
\end{itemize}
An \udef{orthocomplemented lattice} or \udef{ortholattice} is a bounded lattice equipped with an orthocomplementation.
\end{definition}
An orthocomplemented lattice is not necessarily uniquely complemented.

\begin{lemma}
Let $L$ be an ortholattice with completement $c$. Then $c: L \to L$ is a reverse order-isomorphism.
\end{lemma}
\begin{corollary}
The dual lattice of an ortholattice is an ortholattice. We can view an orthocomplementation as an isomorphism between an ortholattice and its dual.
\end{corollary}
\begin{corollary}
Let $A\subseteq L$. Then
\begin{enumerate}
\item $c\left[\bigvee A\right] = \bigwedge c[A]$;
\item $c\left[\bigwedge A\right] = \bigvee c[A]$.
\end{enumerate}
\end{corollary}
\begin{proof}
See \ref{orderReversingSimilarityLatticeOperations}.
\end{proof}

\begin{proposition}
The cardinality of any finite ortholattice is either even or $1$.
\end{proposition}
\begin{proof}
Let $L$ be a finite ortholattice.
The orthocomplementation pairs elements $x,y$ such that $\overline{x} = y$ and $\overline{y} = x$. If for all such pairs we have $x\neq y$, then the cardinality of $L$ is even. Now assume there exists an $x\in L$ such that $\overline{x} = x$. Then 
\[ \bot = x\wedge \overline{x} = x\wedge x = x = x\vee x = x\vee \overline{x} = \top. \]
So $\bot = \top$, which is only possible if $L = \{\bot\}$.
\end{proof}

\begin{example}
\begin{itemize}
\item The lattice $\mathbf{M}_2 = \begin{tikzcd}[column sep={2em,between origins},row sep={2em,between origins}]
&\circ \ar[ld, dash] \ar[rd, dash] & \\ \circ \ar[rd, dash] && \circ \ar[ld, dash] \\ &\circ &
\end{tikzcd}$ admits a unique orthocomplementation.
\item The lattice $\mathbf{M}_3 = \begin{tikzcd}[column sep={2em,between origins},row sep={2em,between origins}]
&\circ \ar[ld, dash] \ar[d,dash] \ar[rd, dash] &\\ \circ \ar[rd, dash]& \circ \ar[d, dash] & \circ \ar[ld, dash] \\ &\circ &
\end{tikzcd}$ admits no orthocomplementations.
\item The lattice $\mathbf{M}_4 = \begin{tikzcd}[column sep={1em,between origins},row sep={2em,between origins}]
&&&\circ \ar[llld, dash] \ar[ld,dash] \ar[rd, dash] \ar[rrrd, dash] &&&\\ \circ \ar[rrrd, dash]&& \circ \ar[rd, dash] && \circ \ar[ld, dash] && \circ \ar[llld, dash] \\ &&&\circ &&&
\end{tikzcd}$ admits three orthocomplementations.
\item The hexagon lattice $\begin{tikzcd}[column sep={1.5em,between origins},row sep={1.7em,between origins}]
& \circ \ar[ld, dash] \ar[rd, dash] & \\
a \ar[d, dash] & & b \ar[d, dash] \\
c \ar[rd, dash] & & d \ar[ld, dash] \\
& \circ &
\end{tikzcd}$ admits a unique orthocomplementation, but it is not uniquely complemented. Indeed both of the functions $f: \begin{tikzcd}[column sep={1.5em,between origins},row sep={1.7em,between origins}]
& \circ \ar[ld, dash] \ar[rd, dash] & \\
a \ar[d, dash] \ar[rr, leftrightarrow] & & b \ar[d, dash] \\
c \ar[rd, dash] \ar[rr, leftrightarrow] & & d \ar[ld, dash] \\
& \circ &
\end{tikzcd}$ and $g: \begin{tikzcd}[column sep={1.5em,between origins},row sep={1.7em,between origins}]
& \circ \ar[ld, dash] \ar[rd, dash] & \\
a \ar[d, dash] \ar[rrd, leftrightarrow] & & b \ar[d, dash] \\
c \ar[rd, dash] \ar[rru, leftrightarrow] & & d \ar[ld, dash] \\
& \circ &
\end{tikzcd}$ are complementations. Only $g$ is an orthocomplementation, because $f$ does not reverse order: $a \geq c$  and $f(a) = b \geq d = f(c)$.
\end{itemize}
\end{example}

\begin{theorem}[De Morgan's laws]
Let $L$ be an ortholattice, then for all $x,y\in L$
\begin{enumerate}
\item $\overline{(x\vee y)} = \overline{x} \wedge \overline{y}$;
\item $\overline{(x\wedge y)} = \overline{x} \vee \overline{y}$.
\end{enumerate}
\end{theorem}
\begin{proof}
From $x\leq x\vee y$ and $y\leq x\vee b$, we have $\overline{(x\vee b)} \leq \overline{x}$ and $\overline{(x\vee b)} \leq \overline{y}$. By \ref{orderLatticeCorollary} we have $\overline{(x\vee y)}\leq \overline{x} \wedge \overline{y}$. For the other inequality we start with $\overline{x} \geq \overline{x} \wedge \overline{y}$ and $\overline{y} \geq \overline{x} \wedge \overline{y}$ to obtain $x\vee y \leq \overline{(\overline{x} \wedge \overline{y})}$, which implies $\overline{x} \wedge \overline{y} \leq \overline{(x\vee y)}$.
\end{proof}

\begin{proposition}
Let $L$ be a complemented lattice.

If the complement is an involution and satisfies either of the de Morgan laws, then $L$ is an ortholattice.
\end{proposition}
\begin{proof}
Assume the de Morgan law $\overline{(x\vee y)} = \overline{x} \wedge \overline{y}$ holds. Assume $x\leq y$. Then $x\vee y = y$, so
\[ \overline{y} = \overline{(x\vee y)} = \overline{x} \wedge \overline{y} \]
meaning $\overline{y} \leq \overline{x}$.
\end{proof}

The requirement that the complement be an involution is important. There are lattices in which the de Morgan laws hold that are not ortholattices.

\begin{example}
The lattice $\mathbf{M}_3 = \begin{tikzcd}[column sep={2em,between origins},row sep={2em,between origins}]
&\top \ar[ld, dash] \ar[d,dash] \ar[rd, dash] &\\ a \ar[rd, dash]& b \ar[d, dash] & c \ar[ld, dash] \\ &\bot &
\end{tikzcd}$ admits a complementation $'$ such that $a' = b$, $b' = c$ and $c' = a$ that is clearly not an orthocomplementation, but does satisfy the de Morgan laws.
\end{example}

TODO Ockham algebras, De Morgan algebras, Kleene algebras, Stone algebras.

\subsection{Boolean lattices}
\begin{definition}
A distributive complemented lattice is called a \udef{Boolean lattice} or \udef{Boolean algebra}.
\end{definition}
We will use $\overline{x}$ to denote the (necessarily unique, \ref{distributiveComplementUnique}) completement of $x$.

\begin{lemma} \label{BooleanComplementLargestDisjoint}
Let $L$ be a Boolean lattice and $x\in L$. Then $\{x\}^\perp = \downset \overline{x}$.
\end{lemma}
\begin{proof}
From the requirement $x\wedge \overline{x} = \bot$, we see that $\overline{x}\in \{x\}^\perp$. Now $\{\overline{x}\} \subseteq \{x\}^\perp$ implies $\downset \overline{x} \subseteq \downset\{x\}^\perp = \{x\}^\perp$. For the last equality we have used the fact that $\{x\}^\perp$ is downwards closed (in fact even an ideal), see \ref{disjointComplementIdeal}.

Now we prove the other inclusion: $\{x\}^\perp \subseteq \downset \overline{x}$.
Take $y\in \{x\}^\perp$. We just need to show that $y\leq \overline{x}$, or, equivalently, $y = y\wedge \overline{x}$. Indeed
\[ y = y \wedge \top = y\wedge (x\vee \overline{x}) = (y\wedge x)\vee (y\wedge \overline{x}) = \bot \vee (y\wedge \overline{x}) = y\wedge \overline{x}. \]
\end{proof}
    \begin{corollary} \label{BooleanInequalities}
Let $L$ be a Boolean lattice and $x,y\in L$. Then the following are equivalent:
\begin{enumerate}
\item $x \leq y$;
\item $x\wedge \overline{y} = \bot$;
\item $\overline{x} \vee y = \top$.
\end{enumerate}
\end{corollary}
\begin{corollary}
Every Boolean lattice is an ortholattice.
\end{corollary}
\begin{proof}
By \ref{distributiveComplementUnique} we know that a Boolean lattice is uniquely complemented, so its complement is an involution by \ref{uniqueComplementInvolution}. We just need to check the complementation reverses order.

Let $x\leq y$. Then $\overline{y} \wedge x \leq \overline{y} \wedge y = \bot$, so $\overline{y} \wedge x = \bot$ and thus $\overline{y}$ is disjoint from $x$. Then $\overline{y} \leq \overline{x}$ follows from \ref{BooleanComplementLargestDisjoint}.
\end{proof}
\begin{corollary}
The laws of de Morgan hold in Boolean lattices.
\end{corollary}

\begin{lemma} \label{BooleanLatticesLemma}
Let $L$ be a Boolean lattice and $x,y\in L$. Then
\begin{enumerate}
\item $y = (x\vee y) \wedge (\overline{x}\vee y)$;
\item $y = (x\wedge y) \vee (\overline{x}\wedge y)$;
\item $x \wedge y = x\wedge (\overline{x}\vee y)$;
\item $x \vee y = x\vee (\overline{x}\wedge y)$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1, 2) We calculate
\[ y = y \wedge \top = y \wedge (x\vee \overline{x}) = (x\vee y) \wedge (\overline{x}\vee y). \]
The second statement is dual.

(3, 4) We calculate $x\wedge (\overline{x}\vee y) = (x\wedge \overline{x})\vee (x\wedge y) = \bot \vee (x\wedge y) = x\wedge y$. The fourth statement is dual.
\end{proof}

\begin{lemma} \label{atomsJoinIrriducibleBoolean}
Let $L$ be a Boolean lattice. Then
\begin{enumerate}
\item $\atoms(L) = \joinIr(L)$;
\item $\coatoms(L) = \meetIr(L)$;
\end{enumerate}
\end{lemma}
\begin{proof}
We have the inclusion $\subseteq$ from \ref{atomsJoinIrriducible}. Assume $x$ is an atom. Take $y\in \downset x\setminus\{x\}$, which is non-empty due to the existence of $\bot \neq x$. In fact we need to prove $y = \bot$. By \ref{BooleanLatticesLemma} we have $x = x\vee y = (x\wedge \overline{y})\vee y$. By join-irreducibility this means that $x = x\wedge \overline{y}$ (because $x\neq y$ by assumption). So $x\leq \overline{y}$, meaning $y = x\wedge y \leq \overline{y}\wedge y = \bot$.
\end{proof}

\begin{lemma}
Let $L$ be a lattice, $x\in L$ and $A\subseteq L$. Then
\begin{enumerate}
\item $\upset x\wedge A^u = (x\wedge A)^u$;
\item $\downset x\vee A^l = (x\vee A)^l$.
\end{enumerate}
\end{lemma}
In any lattice we have the inclusions $x\wedge A^u \subseteq (x\wedge A)^u, \;x\wedge A^l \subseteq (x\wedge A)^l, \;x\vee A^u \subseteq (x\vee A)^u$ and $x\vee A^l \subseteq (x\vee A)^l$. See \ref{UpperLowerBoundsMeetJoin}.
\begin{proof}
Because of \ref{UpperLowerBoundsMeetJoin}, we have $x\wedge A^u \subseteq (x\wedge A)^u$, so $\upset x\wedge A^u \subseteq \upset(x\wedge A)^u = (x\wedge A)^u$.

We just need to prove $\upset x\wedge A^u \supseteq (x\wedge A)^u$. Take some $z\in (x\wedge A)^u$, we need to find a $y\in x\wedge A^u$ such that $y \leq z$. We claim that $y = x\wedge (\overline{x}\vee z)$ is such a $y$. We just need to verify that $y \leq z$ and $\overline{x}\vee z \in A^u$.

The first claim is immediate from $y = x\wedge (\overline{x}\vee z) = x\wedge z$, using \ref{BooleanLatticesLemma}.

For the second claim, take an arbitrary $a\in A$. Then $x\wedge a \leq z$ by definition and so $\overline{x}\vee z \geq \overline{x}\vee (x\wedge a) = \overline{x}\vee a \geq a$.
\end{proof}
\begin{corollary}[Infinite distributive laws]
Let $L$ be a Boolean lattice. Then for all $x\in L$ and all $A\subseteq L$:
\begin{enumerate}
\item if $\bigvee A$ exists, then $x\wedge \bigvee A = \bigvee x\wedge A$;
\item if $\bigwedge A$ exists, then $x\vee \bigwedge A = \bigwedge x\vee A$.
\end{enumerate}
\end{corollary}
The inequalities $x\wedge \bigvee A \geq \bigvee x\wedge A$ and $x\vee \bigwedge A \leq \bigwedge x\vee A$ hold in any lattice, see \ref{infiniteDistributiveInequalities}.
\begin{proof}
We calculate
\begin{align*}
x\wedge \sup(A) &= x\wedge (A^u\cap A^{ul}) \\
&\subseteq (x\wedge A^u)\cap (x\wedge A^{ul}) \\
&\subseteq (x\wedge A)^u\cap (x\wedge A^{u})^l = (x\wedge A)^u\cap (\upset(x\wedge A^{u}))^l = (x\wedge A)^u\cap (x\wedge A))^{ul} = \sup(x\wedge A).
\end{align*}
We have used that $x\wedge (A^\cap A^{ul})$ is an image of the function $y\mapsto x\wedge y$ for the first inclusion and \ref{UpperLowerBoundsMeetJoin} for the second. We have also used {upperBoundUpsetlowerBoundDownset} for $(x\wedge A^{u})^l = (\upset(x\wedge A^{u}))^l$.

The left-hand set is a singleton. The right is either a singleton or empty. Thus both sets are singletons with the same content.

Point (2) is dual.
\end{proof}

\begin{proposition}
Let $L$ be a Boolean lattice with complement and $a,b\in L$. Then $[a,b]$ is a Boolean lattice with complementation $x\mapsto \widetilde{x} = (\overline{x} \wedge b)\vee a$. 
\end{proposition}
\begin{proof}
Clearly $[a,b]$ inherits distributivity from $L$. All we need to show is that for all $x\in [a,b]$ the complement of $x$ in $[a,b]$ is $\widetilde{x}$. We calculate
\begin{align*}
x \wedge \widetilde{x} &= x\wedge ((\overline{x} \wedge b)\vee a) = (x\wedge(\overline{x} \wedge b))\vee (x\wedge a) = (( x\wedge \overline{x}) \wedge b)\vee (x\wedge a) = (\bot \wedge b)\vee a = \bot \vee a = a \\
x \vee \widetilde{x} &= x\vee ((\overline{x} \wedge b)\vee a) = ((x\vee \overline{x}) \wedge (x\vee b))\vee a = (\top \wedge b) \vee a = b\vee a = b.
\end{align*}
\end{proof}

\begin{proposition}
An algebra of sets is a Boolean algebra with as top the unit $\Omega$, as bottom the empty set $\emptyset$ and as complement $A\mapsto A^c = \Omega\setminus A$.
\end{proposition}

\subsubsection{Duality and complementation}
TODO: dual expression can be obtained by taking the complement? Dual statement of equality is equality of complements?

TODO: general for ortholattices?

\subsubsection{Boolean rings}
TODO: define ring above!
\begin{definition}
Let $\sSet{R,+,\cdot, 0, 1}$ be a ring. We call $R$ a \udef{Boolean ring} if each $x\in R$ is idempotent: $x^2 = x$.
\end{definition}

\begin{lemma}
Let $\sSet{R,+,\cdot, 0, 1}$ be a Boolean ring. Then
\begin{enumerate}
\item $x = -x$ for all $x\in R$;
\item $R$ is commutative.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) We calculate
\[ x+x = (x+x)^2 = x^2 + x^2 + x^2 + x^2 = x+x+x+x. \]
Subtracting $x+x$ from both sides gives $x+x = 0$.

(2) Let $x,y\in R$. We then have
\[ x+y = (x+y)^2 = x^2 + xy + yx + y^2 = x + xy + yx + y. \]
So $xy = -yx = yx$, using point (1).
\end{proof}

\begin{lemma}
Every subring of a Boolean ring is a Boolean ring.
\end{lemma}

\begin{proposition}
Let $R$ be a set and $0,1\in R$.
\begin{enumerate}
\item If $\sSet{R, \vee, \wedge, 0, 1, c}$ is a Boolean algebra, then $\sSet{R, +, \cdot, 0 , 1}$ is a Boolean ring with operations defined by
\begin{align*}
&+: (x,y) \mapsto (x\wedge y^c)\vee (x^c \wedge y) \\
&\cdot: (x,y) \mapsto x \wedge y.
\end{align*}
\item If $\sSet{R, +, \cdot, 0 , 1}$ is a Boolean ring, then $\sSet{R, \vee, \wedge, 0, 1, c}$ is a Boolean algebra with operations defined by
\begin{align*}
&\vee: (x,y) \mapsto x+y - x\cdot y \\
&\wedge: (x,y) \mapsto x \cdot y \\
&c: x\mapsto x^c = 1 + x
\end{align*}
\end{enumerate}
\end{proposition}
Note we need the existence of $1$ to define the complement.
\begin{proof}
TODO
\end{proof}

TODO: \url{https://en.wikipedia.org/wiki/Boolean_ring} (Maybe later in ring section?)

\subsubsection{Identities in Boolean algebras}
TODO rewrite!!!!

Given any set $U$ we can form the family $\powerset(U)$ for which $U$ is a universe set.

The set theoretic operations of union, intersection, difference, symmetric difference and complementation can be restricted to $\powerset(U)$. In other words $\powerset(U)$ is closed w.r.t. these operations.

\begin{proposition} \label{setBooleanAlgebra}
Given a set $U$, the operations $\cap, \cup, ^c$ form a Boolean algebra with bottom $\emptyset$ and top $U$: $\forall A,B,C\subset U$: $\powerset(U)$ is closed under $\cap, \cup, ^c$ and
\[ \begin{array}{l c c}
\text{\textbf{Commutativity}} & A\cup B= B\cup A & A\cap B = B\cap A \\
\text{\textbf{Identity}} & A\cup\emptyset = A & A\cap U = A \\
\text{\textbf{Distributivity}} & A\cup(B\cap C) = (A\cup B)\cap(A\cup C) & A\cap(B\cup C) = (A\cap B)\cup(A\cap C) \\
\text{\textbf{Complements}} & A\cup A^c = U & A\cap A^c = \emptyset
\end{array} \]
\end{proposition}
The two columns are duals of each other.

TODO: distributivity for arbitrary union and intersection.

\begin{corollary} \label{BooleanConsequences}
Let $A,B\subseteq U$ be sets. Then
\[ \begin{array}{l c c}
\text{\textbf{Idempotency}} & A\cup A = A & A\cap A = A \\
\text{\textbf{Domination}} & A\cup U = U & A\cap \emptyset = \emptyset \\
\text{\textbf{Absorption}} & A\cup(A\cap B) = A & A\cap(A\cup B) = A \\
\text{\textbf{Associativity}} & A\cup(B\cup C) = (A\cup B)\cup C & A\cap(B\cap C) = (A\cap B)\cap C
\end{array} \]
\end{corollary}
\begin{proof}
Using set theory the proof of these statements is simple. It is also possible to prove the equalities using only the properties of Boolean algebras listed in lemma \ref{setBooleanAlgebra} and the properties derived here. We only prove the first column. The proof of the second column can be obtained easily by duality.

(1) $A = A\cup(A\cap A^c) = (A\cup A)\cap (A\cup A^c) = (A\cup A)\cap U = A\cup A$.

(2) $U = U\cup (U\cap A) = (U\cup U)\cap (U\cup A) = U\cap (U\cup A) = (A\cup U)\cap U = (A\cup U)$.

(3) $A\cup(A\cap B) = (A\cap U)\cup(A\cap B) = A\cap(U\cup B) = A\cap U = A$.

(4) TODO \url{https://proofwiki.org/wiki/Operations_of_Boolean_Algebra_are_Associative}
\end{proof}

\section{Residuated lattices}


\section{Completions}
TODO: Dedekind-MacNeille completion.

\section{Formal concept analysis}
\url{file:///C:/Users/user/Downloads/978-3-540-31881-1.pdf}
\url{file:///C:/Users/user/Downloads/978-3-662-49291-8.pdf}

\begin{definition}
A \udef{context} is a triple $\seq{G,M,I}$ where $G$ is a set of \udef{objects}, $M$ is a set of \udef{attributes} and $I\subseteq G\times M$ is a binary relation.

For $g\in G, m\in M$ we interpret $gIm$ as ``the object $g$ has the attribute $m$''.



A \udef{concept} is a pair $\seq{A,B}$ where $A\subset G$ is a set of objects and $B\subset M$ is a set of attributes such that
\begin{itemize}
\item $A = \setbuilder{g\in G}{\forall m\in B: gIm}$;
\item $B = \setbuilder{m\in M}{\forall g\in A: gIm}$
\end{itemize}
\end{definition}
The letters $G$ and $M$ come from the German: Gegenstände and Merkmale. The $I$ is for ``incidence relation'' (I think).

\section{Filters and ideals}
\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set. A subset $F\subseteq P$ is called
\begin{itemize}
\item an \udef{order filter} if
\begin{itemize}
\item $F$ is downward directed;
\item $F$ is an up set in $P$;
\end{itemize}
\item an \udef{order ideal} if
\begin{itemize}
\item $F$ is upward directed;
\item $F$ is a down set in $P$.
\end{itemize}
\end{itemize}
In addition $F$ is called \udef{proper} if $F \neq P$.

The set of ideals on $P$ is denoted $\ideals(P)$ and the set of filters on $P$ is denoted $\filters(P)$.
\end{definition}
Many authors also require filters and ideals to be non-empty.

\begin{lemma}
Let $P$ be an ordered set and $x\in P$.
\begin{enumerate}
\item The principal up set $\upset x$ is an order filter.
\item The principal down set $\downset x$ is an order ideal.
\end{enumerate}
\end{lemma}
If the order is not a preorder, then a principal filter/ideal may be empty.

\begin{example}
Let $X$ be a set.
\begin{itemize}
\item The set of finite subsets of $X$ is an ideal.
\item The set of countable subsets $X$ is an ideal.
\item A subset $A$ of $X$ is called \udef{cofinite} if $X\setminus A$ is finite. The set of cofinite subsets of $X$ is a filter.
\item A subset $A$ of $X$ is called \udef{cocountable} if $X\setminus A$ is countable. The set of cocountable subsets of $X$ is a filter.
\end{itemize}
\end{example}

\begin{lemma}
Let $P$ be an ordered set.
\begin{enumerate}
\item If $P$ has a least element $l$, then a filter $F$ is proper \textup{if and only if} it does not contain $l$.
\item If $P$ has a greatest element $g$, then an ideal $I$ is proper \textup{if and only if} it does not contain $g$.
\end{enumerate}
\end{lemma}


\begin{lemma}
Let $\sSet{S,\leq}$ be a poset $J\subseteq S$ a subset.
\begin{enumerate}
\item If $S$ is a $\wedge$-semilattice, then $J$ is a filter \textup{if and only if}
\begin{enumerate}
\item $J$ is an up set;
\item $J$ is a $\wedge$-subsemilattice.
\end{enumerate}
\item If $S$ is a $\vee$-semilattice, then $J$ is an ideal \textup{if and only if}
\begin{enumerate}
\item $J$ is a down set;
\item $J$ is a $\vee$-subsemilattice.
\end{enumerate}
\end{enumerate}
\end{lemma}
\begin{proof}
TODO
\end{proof}

\begin{lemma}
Let $L$ be a lattice and $J\subseteq L$ a subset. Then
\begin{enumerate}
\item $J$ is a filter \textup{if and only if}
\begin{enumerate}
\item $\forall a,b\in J: \qquad a\wedge b\in J$;
\item $\forall x\in L, \forall b\in J: \quad x\vee b \in J$;
\end{enumerate}
\item $J$ is an ideal \textup{if and only if}
\begin{enumerate}
\item $\forall a,b\in J: \qquad a\vee b\in J$;
\item $\forall x\in L, \forall b\in J: \quad x\wedge b \in J$.
\end{enumerate}
\end{enumerate}
\end{lemma}

\subsection{Filter bases and subbases}

\begin{lemma}
Let $\sSet{P,\Yleft}$ be an ordered set and $\{F_i\}_{i\in I}$ a family of subsets.
\begin{enumerate}
\item If $F_i$ is a filter for all $i\in I$, then $\bigcap_{i\in I}F_i$ is a filter;
\item If $F_i$ is an ideal for all $i\in I$, then $\bigcap_{i\in I}F_i$ is an ideal.
\end{enumerate}
\end{lemma}

\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set and $B\subseteq P$ a subset. Then
\begin{itemize}
\item the \emph{filter generated by $B$} is
\[ \mathfrak{F}\{B\} \defeq \bigcap\setbuilder{B \subseteq S\subseteq P}{\text{$S$ is a filter}} \]
we call $B$ a \udef{filter subbasis} of $F$. If $B$ is downward directed, it is called a \udef{filter basis} of $F$;
\item the \emph{filter basis generated by $B$} as
\[ \mathfrak{FB}\{B\} \defeq \bigcap\setbuilder{B \subseteq S\subseteq P}{\text{$S$ is downward directed}}. \]
\end{itemize}
\end{definition}

If $P$ is not downward directed, there may not exists any $S \supseteq B$ that is downward directed, in which case $\mathfrak{FB}\{B\} =$ TODO.

\begin{proposition}
Let $\sSet{P,\Yleft}$ be an ordered set and $B\subseteq P$ a subset. Then
\begin{enumerate}
\item if $P$ is downward directed, then $\mathfrak{FB}\{B\}$ is a filter basis;
\item $\mathfrak{F}\{B\} = \upset\mathfrak{FB}\{B\}$.
\end{enumerate}
\end{proposition}
In particular, if $S$ is a filter base, then $\upset S$ is a filter.

\begin{lemma}
Let $\sSet{P,\Yleft}$ be an ordered set.

If $P$ is downward directed and $\exists \bot \in \min(P)$ and $B \subseteq P$ a filter basis, then $\mathfrak{F}\{B\}$ is a proper filter \textup{if and only if} $\bot \notin B$; 
\end{lemma}

\begin{proposition}
Let $\sSet{P,\Yleft}$ be an ordered set. Then for all filter bases $B,C$ in $P$: $B$ is finer than $C$ \textup{if and only if} $\mathfrak{F}\{B\} \supseteq \mathfrak{F}\{C\}$.
\end{proposition}

\begin{proposition} \label{filterGenerationSemilattice}
Let $S$ be a $\wedge$-semilattice and $B\subseteq S$ a subset. Then
\begin{enumerate}
\item $\mathfrak{FB}\{B\} = \Cl_\wedge(B)$;
\item $\mathfrak{F}\{B\} = \upset\Cl_\wedge(B)$.
\end{enumerate}
\end{proposition}

\subsection{Ordering filters and ideals}

\begin{proposition}[The lattices of filters and ideals]
Let $P$ be an ordered set and $I$ an index set.
\begin{enumerate}
\item If $P$ is a $\wedge$-semilattice, the set $\filters(P)$ of filters on $P$ is a complete bounded sublattice of $\sSet{\powerset(P), \subseteq}$, with top $P$ and bottom $\emptyset$. Let $\{F_i\}_{i\in I} \in \filters(L)^I$ be a set of filters. Then
\[ \bigwedge \{F_i\}_{i\in I} = \bigcap_{i\in I}F_i \qquad\text{and}\qquad
\bigvee \{F_i\}_{i\in I} =  \closure_\wedge\left(\bigcup_{i\in I}F_i\right). \]
\item If $P$ is a $\vee$-semilattice, the set $\ideals(P)$ of ideals on $P$ is a complete bounded sublattice of $\sSet{\powerset(P), \subseteq}$, with top $P$ and bottom $\emptyset$. Let $\{J_i\}_{i\in I} \in \filters(L)^I$ be a set of ideals. Then
\[ \bigwedge \{J_i\}_{i\in I} = \bigcap_{i\in I}J_i \qquad\text{and}\qquad
\bigvee \{J_i\}_{i\in I} =  \closure_\vee\left(\bigcup_{i\in I}J_i\right). \]
\end{enumerate}
\end{proposition}
\begin{proof}
TODO
\end{proof}

\begin{proposition} \label{joinProperFilter}
Let $L$ be a $\wedge$-semilattice and $\{F_i\}_{i\in I} \in \filters(L)^I$ be set of filters. Then $\bigvee \{F_i\}_{i\in I}$ is a proper filter \textup{if and only if} $\{F_i\}_{i\in I}\mesh \{F_i\}_{i\in I}$.
\end{proposition}

\subsubsection{Maximal filters and ideals}
\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set.
\begin{itemize}
\item A \udef{maximal filter} or \udef{ultrafilter} is a coatom in $\filters(P)$.
\item A \udef{maximal ideal} is a coatom in $\ideals(P)$.
\end{itemize}
We denote the set of ultrafilters on $P$ as $\ultrafilters(P)$.
\end{definition}

\begin{proposition}
Let $S$ be a bounded $\wedge$-semilattice. A filter $F\in \filters(S)$ is an ultrafilter \textup{if and only if} $\forall x\in S$:
\[ x\notin F \;\iff\; \exists y\in F: x\wedge y = \bot. \]
\end{proposition}
\begin{proof}
First assume $F$ is an ultrafilter. Then for all $x\in F$, the filter $\mathfrak{F}\big\{F\cup \{x\}\big\}$ is either $F$ or $S$. In other words, $x\notin F$ is equivalent to $\mathfrak{F}\big\{F\cup \{x\}\big\} = S$. Now a filter is equal to $S$ iff $\bot$ is an element and, by \ref{filterGenerationSemilattice} we have that $\bot \in \mathfrak{F}\big\{F\cup \{x\}\big\}$ iff it is the intersection of $x$ and some $y\in F$. This concludes the forward direction.

Now for the other direction, take some filter $F$ satisfying the condition. Then $F$ is automatically proper ($\bot$ is not in $F$). Assume $G\supseteq F$ is another proper filter. Assume, towards a contradiction, that $G\setminus F \neq \emptyset$. Then take $x\in G\setminus F$. By hypothesis there exists a $y\in F$ (and thus also in $G$) such that $x\wedge y = \bot$, meaning $\bot \in G$ by $\wedge$-closure. Thus $G$ is not proper.
\end{proof}

\begin{proposition}[Ultrafilter lemma] \label{ultrafilterLemma}
Every proper filter is contained in an ultrafilter.
\end{proposition}
\begin{corollary}
Let $S$ be a bounded $\wedge$-semilattice. Then $\filters(S)$ is a coatomistic lattice.
\end{corollary}
In other words, for every $F\in \filters(S)$: we have
\[ F = \bigcap_{\substack{U\in \ultrafilters(S) \\ U\geq F}} U. \]
\begin{proof}
TODO! Need Boolean??????
\end{proof}

\subsubsection{Prime filters and ideals}
\begin{definition}
Let $\sSet{P,\Yleft}$ be an ordered set.
\begin{itemize}
\item A \udef{prime filter} is a meet-irreducible element in $\filters(L)$.
\item A \udef{prime ideal} is a meet-irreducible element in $\ideals(L)$.
\end{itemize}
\end{definition}

\begin{proposition}
Let $\sSet{P,\Yleft}$ be an ordered set.
\begin{enumerate}
\item A filter $F$ is prime \textup{if and only if} $F^c$ is an ideal.
\item An ideal $I$ is prime \textup{if and only if} $I^c$ is a filter.
\end{enumerate}
\end{proposition}
\begin{proof}

\end{proof}

\begin{lemma} \label{maximalPrimeFiltersIdeals}
Every maximal is prime. If Boolean, then every prime is maximal.
\end{lemma}
\begin{proof}
TODO \ref{atomsJoinIrriducible}
\end{proof}

\begin{proposition}
Let $L$ be a lattice.
\begin{enumerate}
\item A filter $F\in \filters(L)$ is prime \textup{if and only if}
\begin{enumerate}
\item $F$ is proper;
\item $\forall x,y\in L$: $x\vee y \in F \implies x\in F$ or $y\in F$.
\end{enumerate}
\item An ideal $I\in \ideals(L)$ is prime \textup{if and only if}
\begin{enumerate}
\item $I$ is proper;
\item $\forall x,y\in L$: $x\wedge y \in I \implies x\in I$ or $y\in I$.
\end{enumerate}
\end{enumerate}
\end{proposition}
If $L$ is only a $\wedge$-semilattice (resp. $\vee$-semilattice), then only the direction $\Rightarrow$ holds in general.
\begin{proof}
(1) Assume $F$ is a prime filter. Then $F \neq \top = \powerset(L)$, so it is proper. Now assume $x\vee y\in F$, meaning $\upset x\vee y \subseteq F$. Thus
\[ F = \Cl_\wedge (F\cup \upset(x\vee y)) = (F\vee \upset x) \cap (F\vee \upset y). \]
Because $F$ is prime, we have $F = F\vee \upset x$ or $F\vee \upset y$.

Now assume TODO \url{http://www.ascent-journals.com/IJPEM/Vol3No3/1-sagi.pdf} using \ref{joinIrreducibleLemma}.
\end{proof}



\subsection{Free and principal filters}
\begin{definition}
Let $L$ be a complete lattice and $F\subseteq P$ a filter.
\begin{itemize}
\item The \udef{kernel} of the filter $F$ is $\ker F \defeq \bigwedge F$.
\item A filter is called \udef{principal} if $\ker F \in F$;
\item A filter is called \udef{free} if $\ker F = \bot$.
\end{itemize}
The set of principal filters in $P$ is denoted $\filters_*(P)$ and the set of free filters in $P$ is denoted $\filters_0(P)$.
\end{definition}
The only filter that is both principal and free is $L$. A proper filter cannot be both principal and free.

\begin{lemma}
Let $L$ be a lattice and $F$ a principal filter in $L$. Then $F = \upset \ker F$.
\end{lemma}

\begin{lemma} \label{finiteFiltersPrincipal}
Let $L$ be a finite lattice. Then every filter in $L$ is principal.
\end{lemma}
\begin{proof}
Every filter $F$ in a finite lattice is finite, so $\bigwedge F$ is a finite meet, and thus must be in $F$.
\end{proof}

\begin{proposition}
Let $X$ be a set and $F$ a free filter in $\filters_0(\powerset(X))$. If $A\in F$, then $F$ is finer than the cofinite filter of $A$.
\end{proposition}
\begin{proof}
As filters are upwards closed, ``$F$ finer than the cofinite filter of $A$'' means the cofinite filter of $A$ is a subset of $F$. So take some cofinite subset $C$ of $A$, such that $A\setminus C = \{x_1, \ldots, x_n\}$ is finite. Now for each $x_i$ we can find a set $f_i\in F$ such that $x_i\notin f_i$, because if this was not possible, then $x_i \in \bigcap F$, but $\bigcap F = \emptyset$ due to $F$ being free. Also $\bigcap_{i=1}^n f_i \in F$, because $F$ is closed under finite intersections.

So $(A\setminus C)\cap (\bigcap_{i=1}^n f_i) = \emptyset$, or equivalently $\bigcap_{i=1}^n f_i \subseteq X\setminus (A\setminus C)$, meaning $X\setminus (A\setminus C) \in F$ and thus $C = A\cap (X\setminus (A\setminus C)) \in F$.
\end{proof}
\begin{corollary}
A filter of subsets of $X$ is free \textup{if and only if} it is finer than the cofinite filter of $X$.
\end{corollary}

\begin{proposition}
Let $\sSet{P,\Yleft}$ be a complete ordered set (TODO: do we need Boolean lattice??) and $F\subseteq P$ a filter. Then there exists a unique pair of filters $F_*$ and $F_0$ such that $F_*$ is principal, $F_0$ is free and
\[ F = F_* \wedge F_0 \qquad P = F_* \vee F_0. \]
\end{proposition}
We call $F^*$ the \udef{principal part} and $F^0$ the \udef{free part} of the filter.
\begin{proof}

\end{proof}


\chapter{The poset of subsets}
\begin{definition}
Let $U$ be a set. Then $\sSet{\powerset(U), \subseteq}$ is a partially ordered set. We call $U$ the \udef{universe} of this poset.
\end{definition}

Any family of sets $\mathcal{F}$ may be seen as a subset of the poset with universe $\bigcup \mathcal{F}$.

\begin{proposition} \label{posetPowerset}
Let $\mathcal{F}$ be a family of sets. Then $\sSet{\mathcal{F}, \subseteq}$ is a poset.

Conversely, every poset $(P,\preceq)$ is isomorphic to $\sSet{\mathcal{F}, \subseteq}$ for some family of sets $\mathcal{F}$ with universe $P$.
\end{proposition}
\begin{proof}
This is just a reformulation of \ref{orderedSetPowerset}.
\end{proof}
\begin{corollary} \label{MooreFamily}
Let $\mathcal{F}$ be a family of subsets of $U$. If
\begin{itemize}
\item $\mathcal{F}$ is closed under arbitrary intersections; and
\item $U \in \mathcal{F}$;
\end{itemize}
then $\sSet{\mathcal{F},\subseteq}$ is a complete lattice.

Conversely, every complete lattice is isomorphic to such a lattice.
\end{corollary}
Note that in general the join in such a lattice is \emph{not} given by the union, $\bigvee \neq \bigcup$!
\begin{proof}
Such a family of sets is a complete lattice by \ref{completeLatticeBasic}.

For the converse, the isomorphism is given by $x\mapsto \downset x$, as in \ref{orderedSetPowerset}. We just need to show that the meet translates to the intersection, i.e. $\downset \bigwedge Q = \bigcap_{x\in Q}\downset x$. We calculate, using \ref{minMaxUpsetDownset} and \ref{boundsFromPrincipalImages}:
\[ \downset \bigwedge Q = \downset \max(Q^l) = \downset Q^l = \downset \bigcap_{x\in Q} \downset x \subseteq \bigcap_{x\in Q} \downset x. \]
For the other inclusion we just note that a lattice order is in particular a  preorder and so we can use \ref{TODO}.
\end{proof}

\begin{definition}
A family of sets $\mathcal{F}$ satisfying the hypothesis of \ref{MooreFamily}, i.e.
\begin{itemize}
\item $\mathcal{F}$ is closed under arbitrary intersections; and
\item $U \in \mathcal{F}$;
\end{itemize}
is called a \udef{Moore family} or \udef{topped intersection structure}.
\end{definition}

TODO: join is given by union if directed?? (+CPO)??

\section{The complete Boolean lattice of subsets}
\begin{lemma}
Let $U$ be a universe set. Consider the poset $\sSet{\powerset(U), \subseteq}$ and let $\mathcal{F}\subseteq \powerset(U)$. Then
\begin{enumerate}
\item $\sup(\mathcal{F}) = \bigcup \mathcal{F}$;
\item $\inf(\mathcal{F}) = \bigcap \mathcal{F}$.
\end{enumerate}
(Assuming relativised intersection TODO!)
\end{lemma}
\begin{corollary}
Let $U$ be a universe set. Then $\sSet{\powerset(U), \subseteq}$ is a bounded, complete, distributive lattice with top $U$ and bottom $\emptyset$.
\end{corollary}
\begin{proof}
TODO ref distributivity.
\end{proof}

\subsection{Complementation}
\begin{definition}
Let $U$ be a universe and $A\subseteq U$. The \udef{complement} of $A$ w.r.t. $U$ is
\[ A^c \defeq U\setminus A. \]
\end{definition}

\begin{lemma}
The complement $^c$ is a lattice-theoretical complement.
\end{lemma}
\begin{proof}
For all $A\subseteq U$ we have $A\cup A^c = U$ and $A\cap A^c = \emptyset$ from \ref{differenceProperties}.
\end{proof}
\begin{corollary}
Let $U$ be a universe set. Then $\sSet{\powerset(U), \subseteq}$ is a Boolean lattice.
\end{corollary}

In particular de Morgan's laws can be formulated in this context as:
\begin{proposition}
Let $U,A,B$ be sets, then
\begin{align*}
(A\cup B)^c &= (A^c)\cap (B^c); \\
(A\cap B)^c &= (A^c)\cup (B^c).
\end{align*}
Where complementation is with respect to $U$.

This can be extended to arbitrary families of sets:
\begin{align*}
\left(\bigcup \mathcal{E}\right)^c &= \bigcap\setbuilder{A^c}{A\in\mathcal{E}} \\
\left(\bigcap \mathcal{E}\right)^c &= \bigcup\setbuilder{A^c}{A\in\mathcal{E}}
\end{align*}
where $\mathcal{E}$ is a family of sets.
\end{proposition}

\subsection{Expressing set theoretic operations with $\cup,\cap, ^c$}
\begin{proposition}
Let $A,B\subseteq U$ be sets. Then
\begin{enumerate}
\item $A\setminus B = A \cap B^c$;
\item $A\symdiff B = (A\cup B)\cap (A^c\cup B^c)$.
\end{enumerate}
\end{proposition}
\begin{corollary}
Let $A,B \subseteq U$ be sets. Then
\begin{enumerate}
\item $A\setminus B = B^c\setminus A^c$;
\item $A \symdiff B = A^c \symdiff B^c$;
\item $A \symdiff A^c = U$.
\end{enumerate}
\end{corollary}

\subsection{Filters and ideals}

\begin{proposition}
Let $U$ be a set. If $U$ is infinite, then there exists a non-principal ultrafilter in $\filters(\powerset(U))$.
\end{proposition}
This proposition assumes the ultrafilter lemma \ref{ultrafilterLemma}.
\begin{proof}
Consider the cofinite filter $F = \setbuilder{A\subseteq U}{U\setminus A\;\text{is finite}}$. By the ultrafilter lemma, \ref{ultrafilterLemma}, we can extend $F$ to an ultrafilter $\mathcal{U}$. Now $\mathcal{U}$ does not contain any sets of the form $\{x\}$ with $x\in U$. If it did, then it would contain both $\{x\}$ and $U\setminus\{x\}$, meaning it would also contain $\emptyset$ and thus would not be proper and in particular not an ultrafilter.
\end{proof}

\section{Grills}
\begin{definition}
Let $X$ be a set. Let $\mathcal{A} \subseteq \powerset(X)$. The \udef{grill} of $\mathcal{A}$ is defined as the polar $\mathcal{A}^{\mesh}$.
\end{definition}

\begin{lemma}
Let $X$ be a set, $\powerset(X)$ be ordered by inclusion, $A, B\in \powerset(X)$ and $\mathcal{A} \subseteq \powerset(X)$. Then
\begin{enumerate}
\item $\upset A\mesh$ = $A\mesh$;
\item $\upset \mathcal{A}^{\mesh} = \mathcal{A}^{\mesh} = (\upset \mathcal{A})^{\mesh}$;
\item $((\mathcal{A}^{\mesh})^{\mesh})^{\mesh} = \mathcal{A}^{\mesh}$;
\item $(\mathcal{A}^{\mesh})^{\mesh} = \upset \mathcal{A}$.
\end{enumerate}
\end{lemma}
\begin{proof}
(1) If $B$ meshes with $A$, then any superset of $B$ also meshes with $A$. The opposite inclusion is given by \ref{TODO}.

(2) We calculate using \ref{upDownsetUnionIntersection}
\[ \upset \mathcal{A}^{\overrightarrow{\mesh}} = \upset \bigcap_{A\in\mathcal{A}} A\mesh = \upset \bigcap_{A\in\mathcal{A}} \upset A\mesh = \bigcap_{A\in\mathcal{A}} \upset A\mesh = \bigcap_{A\in\mathcal{A}} A\mesh = \mathcal{A}^{\overrightarrow{\mesh}} \]

TODO

(3) TODO (general for polars using $\mesh^\transp = \mesh$ (?)).

(4) By \ref{GreensTheoremCorollary} this is a consequence of (2) and (3).
\end{proof}

\section{Indicator functions}
The family $\powerset(U)$ can be bijectively mapped to the family of functions $(U\to \{0,1\})$, by mapping each set $A$ to its indicator function $\chi_A$.

\begin{definition}
Let $U$ be a set and $A\subseteq U$. The \udef{indicator function} or \udef{characteristic function} of $A$ as an element of $\powerset(U)$ is defined as
\[ \chi_A: U\to \{0,1\}: x\mapsto \begin{cases}
1 & x\in A \\ 0 & x\notin A.
\end{cases} \]
\end{definition}
\begin{lemma}
Let $A,B$ be elements of $\powerset(U)$. Then
\begin{enumerate}
\item $\chi_{A\cap B} = \min\{\chi_A,\chi_B\} = \chi_A\cdot \chi_B$;
\item $\chi_{A\cup B} = \max\{\chi_A,\chi_B\} = \chi_A + \chi_B - \chi_A\cdot \chi_B$;
\item $\chi_{A^c} = \underline{1}-\chi_A$; and thus $\chi_A + \chi_{A^c} = \underline{1}$;
\item $\chi_{A\Delta B} \begin{aligned}[t] &= \chi_A + \chi_B - \underline{2}\cdot\chi_A\cdot \chi_B \\
&= |\chi_A - \chi_B| \\
&= \chi_A + \chi_B \mod 2 \defeq \begin{cases}
1 & (\chi_A + \chi_B = 1) \\
0 & \text{(else)}
\end{cases}
\end{aligned}$.
\end{enumerate}
Where all operations are defined point-wise.
\end{lemma}

\begin{proposition}
The indicator functions define a bijection between $\powerset(U)$ and $(U\to \{0,1\})$.
\end{proposition}

\section{Closure under set operations}
We say a family of sets $\mathcal{F}$ is closed under an operation if the result of this operation acting on sets in $\mathcal{F}$ is again in $\mathcal{F}$.

\begin{definition}
A family of sets $\mathcal{F}\subseteq\powerset(U)$ is called
\begin{itemize}
\item \udef{closed under complementation} if $A^c\in\mathcal{F}$ for all $A\in\mathcal{F}$;
\item \udef{closed under relative complements} if $A\setminus B\in\mathcal{F}$ for all $A \supset B\in\mathcal{F}$;
\item \udef{closed under set difference} if $A\setminus B\in\mathcal{F}$ for all $A, B\in\mathcal{F}$;
\end{itemize}
and
\begin{itemize}
\item \udef{closed under finite unions} if $A\cup B \in\mathcal{F}$ for all $A,B\in\mathcal{F}$;
\item \udef{closed under finite intersections} if $A\cap B \in\mathcal{F}$ for all $A,B\in\mathcal{F}$;
\item \udef{closed under disjoint unions} if $\biguplus_{i\in I}A_i \in\mathcal{F}$ for any indexed family of disjoint sets $\{A_i\}_{i\in I}$;
\item \udef{closed under countable monotone unions} if $\bigcup_{i=1}^\infty A_i \in\mathcal{F}$ for any indexed family of sets $\{A_i\}_{i\in \N}$ such that $i\leq j \implies A_i \subseteq A_j$;
\item \udef{closed under countable monotone intersections} if $\bigcap_{i=1}^\infty A_i \in\mathcal{F}$ for any indexed family of sets $\{A_i\}_{i\in \N}$ such that $i\leq j \implies A_i \supseteq A_j$.
\end{itemize}
Our definition of closure under relative complements is \emph{not} the same as closure under set difference! Our definition is non-standard as they are usually taken to be the same thing.
\end{definition}

\subsection{Complementation, relative complementation and set difference}
In general the notions of closure under complementation, relative complementation and set difference are distinct, the only implication being from set difference to relative complementation.

\begin{lemma} \label{complementTypesUnionClosure}
Let $\mathcal{F}$ be a family of sets that is closed under finite (disjoint) unions. Then
\[ \begin{tikzcd}[row sep=0]
\text{$\mathcal{F}$ is closed under set differences} \arrow[dr, Rightarrow] & \\
\text{$\mathcal{F}$ is closed under complementation} \arrow[r,Rightarrow] & \text{$\mathcal{F}$ is closed under relative complements.}
\end{tikzcd} \]
\end{lemma}
\begin{proof}
Assume $A\supset B$, then $A\setminus B = A^c \uplus B$. This is a disjoint union.
\end{proof}

\begin{lemma}
Let $\mathcal{F}$ be a family of sets that is closed under finite intersections. Then
\[ \text{closure under complements} \quad\implies\quad \text{closure under set difference} \quad\iff\quad \text{closure under relative complements.} \]
All three are equivalent if $\mathcal{F}$ contains the universe set.
\end{lemma}
\begin{proof}
$A\setminus B = A\cap B^c$ and $A\setminus B = A\setminus (B\cap A)$.
\end{proof}

\begin{lemma} \label{closureSetDifference}
Let $\mathcal{F}$ be a family of sets. Then
\[ \text{closure under set differences} \quad\implies\quad \text{closure under finite intersections.} \]
\end{lemma}
\begin{proof}
$A\cap B = A\setminus (A\setminus B)$.
\end{proof}

Any non-empty family of sets that is closed under set differences is also an order-theoretic ring.

\subsection{Types of closure for unions and intersections}
\begin{lemma} \label{unionsIntersectionClosureImplications}
Let $\mathcal{F}$ be a family of sets. Then we have the following implications for closure under unions:
\[ \begin{tikzcd}[row sep=tiny]
&& \text{countable disjoint $\uplus$} \\
\text{arbitrary $\cup$} \arrow[r, Rightarrow] & \text{countable $\cup$} \arrow[ur, Rightarrow] \arrow[r, Rightarrow] \arrow[dr, Rightarrow] & \text{countable monotone $\cup$} \\
&& \text{finite $\cup$}
\end{tikzcd} \]
and for closure under intersections:
\[ \begin{tikzcd}[row sep=0em]
&& \text{countable monotone $\cap$} \\
\text{arbitrary $\cap$} \arrow[r, Rightarrow] & \text{countable $\cap$} \arrow[ur, Rightarrow] \arrow[dr, Rightarrow] &  \\
&& \text{finite $\cap$}
\end{tikzcd} \]
\end{lemma}


The implications in \ref{unionsIntersectionClosureImplications} for unions can be simplified, if $\mathcal{F}$ is closed under relative complementation:
\begin{lemma} \label{typesOfUnionsRelativeComplementation}
Let $\mathcal{F}$ be a family of sets that is closed under relative complementation. Then we have the following implications for closure under unions:
\[ \begin{tikzcd}[row sep=0em]
\text{arbitrary $\cup$} \arrow[r, Rightarrow] & \text{countable $\cup$} \arrow[r, Rightarrow] \arrow[dr, Rightarrow] & \text{countable disjoint $\uplus$} \arrow[r, Rightarrow] & \text{countable monotone $\cup$} \\
&& \text{finite $\cup$} &
\end{tikzcd} \]
\end{lemma}
\begin{proof}
We need to prove that closure under countable disjoint unions implies closure under countable monotone unions.

Assume $\mathcal{F}$ closed under countable disjoint unions. Let $\{A_i\}_{i\in \N}$ be a monotonically increasing family of sets. Then we can recursively define a family $\{D_i\}_{i\in \N}$ by $D_0=\emptyset$ and
\[ D_{i+1} = A_{i+1}\setminus D_i. \]
This is allowed because $A_{i+1}\supset A_i \supset D_i$. By induction we see that $\{D_i\}_{i\in \N}$ is a disjoint family and has the same union as $\{A_i\}_{i\in \N}$.
\end{proof}

These implications can be further simplified, if $\mathcal{F}$ is closed under set differences:
\begin{lemma}
Let $\mathcal{F}$ be a family of sets that is closed under set differences. Then we have the following implications for closure under unions:
\[ \begin{tikzcd}[row sep=0em]
\text{arbitrary $\cup$} \arrow[r, Rightarrow] & \text{countable $\cup$} \arrow[r, Leftrightarrow] & \text{countable disjoint $\uplus$} \arrow[r, Rightarrow] \arrow[dr, Rightarrow] & \text{countable monotone $\cup$} \\
&&& \text{finite $\cup$}
\end{tikzcd} \]
\end{lemma}
\begin{proof}
We just need to prove that closure under countable disjoint unions implies closure under countable unions.

This can be done with the same construction of $\{D_i\}_{i\in \N}$ as before because now the assignment $D_{i+1} = A_{i+1}\setminus D_i$ works for arbitrary families $\{A_i\}_{i\in \N}$, not just monotone ones.
\end{proof}

\section{Filters}

\begin{proposition}
Let $X$ be a set and $F\in\filters(\powerset(X))$ a proper filter. Then $F \subseteq F^{\overrightarrow{\mesh}}$.
\end{proposition}
\begin{proof}
Every set in $F$ meshes with every other set in $F$. If not, i.e. $f,g\in F$ such that $f\cap g = \emptyset$, then $\emptyset\in F$ and $F$ would not be proper.
\end{proof}

\subsection{Ultrafilters}
\begin{definition}
Let $X$ be a set and $F\in\filters(\powerset(X))$ a filter. We call $F$ an \udef{ultrafilter} if $F = F^{\overrightarrow{\mesh}}$.
\end{definition}

TODO characterisations. Ultrafilters are maximally fine (-> ~ Zorns lemma).

\begin{proposition}
An ultrafilter is either principal or free.
\end{proposition}

\begin{proposition}
An ultrafilter is sequential \textup{if and only if} it is principal.
\end{proposition}

\section{Monotone classes}
\begin{definition}
A family of sets $\mathcal{F}$ is called a \udef{monotone class} if it is closed under both countable monotone unions and countable monotone intersections.
\end{definition}
\begin{lemma}
Any arbitrary intersection of monotone classes is a monotone class.
\end{lemma}

\subsection{Dynkin systems}
\begin{definition}
A \udef{Dynkin system} of sets (also known as a \udef{$\lambda$-system} or \udef{d-system}) is a pair of a set $\Omega$ and a collection of sets $D\subset\powerset(\Omega)$ such that
\begin{itemize}
\item $\Omega\in D$;
\item if $A\in D$, then $A^c\in D$;
\item if $(A_i)_{i\in\N}$ is a countable sequence of pairwise disjoint sets in $D$, then $\biguplus_{i=1}^\infty A_i\in D$.
\end{itemize}
\end{definition}

\begin{lemma}
A pair of a set $\Omega$ and a family of subsets $D$ is a Dynkin system \textup{if and only if}
\begin{itemize}
\item $\Omega\in D$;
\item $D$ is closed under relative complements: if $A,B\in D$ and $A\supset B$, then $A\setminus B\in D$;
\item $D$ is closed under countable monotone unions.
\end{itemize}
\end{lemma}
\begin{proof}
Call the original set of axioms Ax1 and this set of axioms Ax2.

$\boxed{\text{Ax1}\implies\text{Ax2}}$ Point (2) follows from \ref{complementTypesUnionClosure} and point (3) follows from \ref{typesOfUnionsRelativeComplementation}.

$\boxed{\text{Ax2}\implies\text{Ax1}}$ Point (2) follows immediately. For point (3): let $A,B$ be disjoint sets. Then $A^c \supset B$ and so $A\cup B = (A^c\setminus B)^c \in D$, meaning $D$ is closed under finite unions of disjoint sets. Now let $(A_i)_{i\in\N}$ be a countable sequence of pairwise disjoint sets. Then
\[ \biguplus_{i=1}^\infty A_i = \bigcup_{i=1}^\infty \left(\biguplus_{j=1}^i A_j\right) \]
which is a countable monotone union.
\end{proof}

\begin{lemma}
A Dynkin system is a monotone class.
\end{lemma}
\begin{proof}
If $\bigcap_{i=1}^\infty A_i$ is a countable monotone intersection, then $\left(\bigcap_{i=1}^\infty A_i\right)^c = \bigcup_{i=1}^\infty A_i^c$ is a countable monotone union.
\end{proof}
\begin{lemma}
Any arbitrary intersection of Dynkin systems is a Dynkin system.
\end{lemma}

\section{$\pi$-systems}
TODO: directed set!
\begin{definition}
A \udef{$\pi$-system} is a collection of sets $P$ such that
\begin{itemize}
\item $P$ is not empty;
\item if $A,B\in P$, then $A\cap B\in P$.
\end{itemize}
\end{definition}

\begin{lemma}
Let $\mathcal{F}$ be a collection of sets. If $\mathcal{F}$ is closed under set differences, then it is a $\pi$-system.
\end{lemma}
\begin{proof}
By \ref{closureSetDifference}.
\end{proof}

For $\pi$-systems the intersection implications in \ref{unionsIntersectionClosureImplications} reduce to:
\begin{lemma} \label{piSystemunionsIntersectionClosureImplications}
Let $\mathcal{F}$ be a $\pi$-system. Then we have the following implications for closure under intersections:
\[ \text{arbitrary $\cap$} \quad\implies\quad \text{countable $\cap$} \quad\iff\quad \text{countable monotone $\cap$} \]
\end{lemma}
\begin{proof}
We need to prove that closure under countable monotone intersections implies closure under countable intersections.

Assume $\mathcal{F}$ is a $\pi$-system closed under countable monotone intersections. Let $\{A_i\}_{i\in \N}$ be an indexed family of sets. Then we can define the family $\{B_i\}_{i\in \N}$ recursively by $B_1 = A_1$ and
\[ B_{i+1} = B_i \cap A_{i+1}. \]
By induction we see that $\{B_i\}_{i\in \N}$ is monotone and has the same intersection as $\{A_i\}_{i\in \N}$.
\end{proof}

\subsection{Intersections structures}
\begin{definition}
Let $\mathcal{F} \subseteq \powerset(U)$ be a family of sets. We call $\mathcal{F}$ an \udef{intersection structure} if it is closed under arbitrary intersections.

If an intersection structure contains the universe set, it is called a \udef{topped intersection structure} or \udef{closure system}.
\end{definition}

\subsection{Ring}
\subsubsection{Order-theoretic ring}
TODO: sublattice!
\begin{definition}
An \udef{order-theoretic ring} of sets is a non-empty collection of sets $\mathcal{R}$ such that
\begin{itemize}
\item if $A,B\in \mathcal{R}$, then $A\cup B\in \mathcal{R}$;
\item if $A,B\in \mathcal{R}$, then $A\cap B\in \mathcal{R}$.
\end{itemize}
\end{definition}

\subsubsection{Semi-rings}
\begin{definition}
A \udef{semi-ring} is a non-empty collection of sets $\mathcal{S}$ such that
\begin{itemize}
\item if $A,B\in \mathcal{S}$, then $A\cap B\in \mathcal{S}$;
\item if $A,B\in \mathcal{S}$, then $A\setminus B$ is a finite disjoint union of sets in $\mathcal{S}$.
\end{itemize}
\end{definition}

\begin{lemma}
Let $\mathcal{S}$ be a semi-ring. Then $\emptyset \in \mathcal{S}$.
\end{lemma}
\begin{proof}
Because $\mathcal{S}$ is non-empty, we can take $A\in \mathcal{S}$. Then $A\setminus A = \emptyset$ is a finite disjoint union of sets in $\mathcal{S}$, so $\emptyset \in \mathcal{S}$.
\end{proof}

\subsubsection{Measure-theoretic rings}
\begin{definition}
A \udef{(measure-theoretic) ring} of sets is a non-empty collection of sets $\mathcal{R}$ such that
\begin{itemize}
\item if $A,B\in \mathcal{R}$, then $A\cup B\in \mathcal{R}$;
\item if $A,B\in \mathcal{R}$, then $A\setminus B\in \mathcal{R}$.
\end{itemize}
\end{definition}
By \ref{closureSetDifference} a measure-theoretic ring is in particular a $\pi$-system and an order-theoretic ring.

\begin{lemma}
A non-empty collection of sets $\mathcal{R}$ is a measure-theoretic ring \textup{if and only if}
\begin{itemize}
\item it is closed under finite intersections;
\item it is closed under symmetric differences.
\end{itemize}
\end{lemma}
\begin{proof}
By the identities $A\cup B = (A\symdiff B)\symdiff (A\cap B)$ and $A\setminus B = A\symdiff (A\cap B)$.
\end{proof}

\begin{lemma}
Let $\mathcal{S}$ be a semi-ring. Then the smallest ring $\mathcal{R}$ containing $\mathcal{S}$ is
\[ \mathfrak{R}\{\mathcal{S}\} = \setbuilder{E_1\uplus\ldots\uplus E_n}{\text{$E_i\in \mathcal{S}$ are pairwise disjoint}}. \]
We call this the ring \udef{generated} by $\mathcal{S}$.
\end{lemma}
\begin{proof}
Every ring containing $\mathcal{S}$ must contain $\mathfrak{R}\{\mathcal{S}\}$, so if it is a ring it is automatically the smallest. We just need to show it is a ring. Let $E,F$ be arbitrary elements of $\mathfrak{R}\{\mathcal{S}\}$. We need to show that both $E\setminus F$ and $E\cup F$ are in $\mathfrak{R}\{\mathcal{S}\}$.

Now $E\cup F = (E\setminus F) \uplus F$ can be written as a disjoint union, so we just need to write $E\setminus F$ as a pairwise disjoint union of elements of $\mathcal{S}$. To that end write $E = \biguplus_{i=0}^nE_i$ and $\biguplus_{j= 0}^mF_j$. Then
\[ E\setminus F = \biguplus_{i=0}^n \left[ \Big(\big((E_j\setminus F_1)\setminus F_2\big)\setminus \ldots\Big)\setminus F_m \right]. \]
By industion and using the semi-ring property we can see that this is expressible as a finite pairwise disjoint union of elements of $\mathcal{S}$, and thus is an element of $\mathfrak{R}\{\mathcal{S}\}$.
\end{proof}

\subsubsection{$\sigma$- and $\delta$-rings}
\begin{definition}
A \udef{$\sigma$-ring} of sets is a collection of sets $\mathcal{R}$ such that
\begin{itemize}
\item $\mathcal{R}$ is a measure-theoretic ring;
\item $\mathcal{R}$ is closed under countable unions.
\end{itemize}
A \udef{$\delta$-ring} of sets is a collection of sets $\mathcal{R}$ such that
\begin{itemize}
\item $\mathcal{R}$ is a measure-theoretic ring;
\item $\mathcal{R}$ is closed under countable intersections.
\end{itemize}
\end{definition}

\subsection{Algebras of sets}
\begin{definition}
An \udef{algebra of sets} on a set $\Omega$ (also known as a \udef{field of sets}) is a ring that contains $\Omega$.
\end{definition}

In principle we can thus define
\begin{itemize}
\item order-theoretic algebra;
\item semi-algebra;
\item measure-theoretic algebra;
\item $\sigma$-algebra;
\item $\delta$-algebra.
\end{itemize}

Some of these notions coincide.

\begin{lemma}
Let $\mathcal{A}$ be a family of sets. Then
\begin{enumerate}
\item $\mathcal{A}$ is an order-theoretic algebra \textup{if and only if} it is a measure-theoretic algebra;
\item $\mathcal{A}$ is a $\sigma$-algebra \textup{if and only if} it is a $\delta$-algebra.
\end{enumerate}
\end{lemma}

So we define define \udef{semi-algebra}, \udef{algebra} and \udef{$\sigma$-algebra}.

\begin{lemma} \label{setAlgebraCriteria}
A family of sets $\mathcal{A}$ is a semi-algebra on $\Omega$ \textup{if and only if}
\begin{itemize}
\item $\Omega\in\mathcal{A}$;
\item if $A,B\in \mathcal{A}$, then $A\cap B\in \mathcal{A}$;
\item if $A\in \mathcal{A}$, then $A^c$ is a finite disjoint union of sets in $\mathcal{A}$.
\end{itemize}
A family of sets $\mathcal{A}$ is an algebra on $\Omega$ \textup{if and only if}
\begin{itemize}
\item $\Omega\in\mathcal{A}$;
\item if $A\in \mathcal{A}$, then $A^c\in \mathcal{A}$;
\item if $A,B\in \mathcal{A}$, then $A\cup B\in \mathcal{A}$.
\end{itemize}
A family of sets $\mathcal{A}$ is a $\sigma$-algebra on $\Omega$ \textup{if and only if}
\begin{itemize}
\item $\Omega\in\mathcal{A}$;
\item if $A\in \mathcal{A}$, then $A^c\in \mathcal{A}$;
\item if $(A_i)_{i\in\N}$ is a countable sequence of sets in $\mathcal{A}$, then $\bigcup_{i=1}^\infty A_i\in \mathcal{A}$.
\end{itemize}
\end{lemma}

\begin{example}
For any set $\Omega$, the power set $\powerset(\Omega)$ is a $\sigma$-algebra on $\Omega$.
\end{example}

\begin{lemma} \label{algebraMonotoneClass}
An algebra $\mathcal{A}$ is a $\sigma$-algebra \textup{if and only if} $\mathcal{A}$ is a monotone class.
\end{lemma}
\begin{lemma} \label{DynkinPiSystem}
A Dynkin system is a $\sigma$-algebra \textup{if and only if} it is a $\pi$-system.
\end{lemma}


\begin{lemma}
\begin{enumerate}
\item The countable monotone union of a sequence of $\sigma$-algebras is an algebra, but not necessarily a $\sigma$-algebra.
\item Any arbitrary intersection of $\sigma$-algebras is a $\sigma$-algebra.
\end{enumerate}
\end{lemma}

\begin{lemma}
Let $\mathcal{A}$ be a $\sigma$-algebra on $\Omega$ and $B\subset \Omega$. Then $B\cap \mathcal{A} = \setbuilder{B\cap A}{A\in\mathcal{A}}$ is a $\sigma$-algebra on $B$.
\end{lemma}

\section{Generators}
\begin{definition}
Let $\mathcal{F}$ be a family of subsets of $\Omega$. Then we define
\begin{itemize}
\item the $\sigma$-algebra generated by $\mathcal{F}$, $\sigma\{\mathcal{F}\}$;
\item the monotone class generated by $\mathcal{F}$, $\mathfrak{M}\{\mathcal{F}\}$; and
\item the Dynkin system generated by $\mathcal{F}$, $\mathfrak{D}\{\mathcal{F}\}$;
\end{itemize}
the intersection of all such families $\subseteq \powerset(\Omega)$ that contain $\mathcal{F}$.

In each case we call $\mathcal{F}$ the \udef{generator} of the system.
\end{definition}
These intersections are again $\sigma$-algebras, monotone classes and Dynkin systems, respectively. So these generated families are the smallest such families containing $\mathcal{F}$.

\begin{example}
\begin{itemize}
\item If $\mathcal{A}$ is a $\sigma$-algebra, then $\sigma\{\mathcal{A}\} = \mathcal{A}$.
\item If $\mathcal{A} = \{A\}$, a single set, then $\sigma\{\mathcal{A}\} = \{\emptyset, A,A^c,\Omega\}$.
\end{itemize}
\end{example}

\begin{lemma} \label{unitGeneratedSets}
A universe set for $\mathcal{F}$ is also a universe set for $\sigma\{\mathcal{F}\}$, $\mathfrak{M}\{\mathcal{F}\}$ and $\mathfrak{D}\{\mathcal{F}\}$.
\end{lemma}

\begin{proposition}[Monotone class theorem] \label{monotoneClassTheorem}
Let $\mathcal{A}$ be an algebra. Then
\[ \mathfrak{M}\{\mathcal{A}\} = \sigma\{\mathcal{A}\}. \]
\end{proposition}
\begin{proof}
Every $\sigma$-algebra is a monotone class, so $\mathfrak{M}\{\mathcal{A}\} \subset \sigma\{\mathcal{A}\}$.

For the other inclusion it is enough to show that $\mathfrak{M}\{\mathcal{A}\}$ is an algebra: using \ref{algebraMonotoneClass} we have
\[ \text{$\mathfrak{M}\{\mathcal{A}\}$ is an algebra} \implies \text{$\mathfrak{M}\{\mathcal{A}\}$ is a $\sigma$-algebra} \implies \sigma\{\mathcal{A}\}\subset\mathfrak{M}\{\mathcal{A}\}. \]
In particular, due to \ref{setAlgebraCriteria}, we verify $\Omega\in \mathfrak{M}\{\mathcal{A}\}$, $B^c \in \mathfrak{M}\{\mathcal{A}\}$ and $B\cup C \in \mathfrak{M}\{\mathcal{A}\}$.

$\boxed{\Omega\in \mathfrak{M}\{\mathcal{A}\}}$ By \ref{unitGeneratedSets}.

$\boxed{B^c \in \mathfrak{M}\{\mathcal{A}\}}$ Define
\[ \mathcal{E}_1 = \setbuilder{B\in\mathfrak{M}\{\mathcal{A}\}}{B^c\in\mathfrak{M}\{\mathcal{A}\}} \]
which is a monotone class by De Morgan's laws:
\[ (B_i)_{i=1}^\infty\subset \mathcal{E}_1 \implies (B_i^c)_{i=1}^\infty\subset \mathfrak{M}\{\mathcal{A}\} \implies \bigcup_{i=1}^\infty B_i^c = \left(\bigcap_{i=1}^\infty B_i\right)^c \in\mathfrak{M}\{\mathcal{A}\} \implies \bigcap_{i=1}^\infty B_i \in \mathcal{E}_1. \]
Also $\mathcal{E}_1\subset \mathfrak{M}\{\mathcal{A}\}$, so $\mathcal{E}_1 = \mathfrak{M}\{\mathcal{A}\}$ by minimality, so
\[ B\in\mathfrak{M}\{\mathcal{A}\} \iff B\in\mathcal{E}_1 \implies B^c\in\mathfrak{M}\{\mathcal{A}\}. \]

$\boxed{B\cup C \in \mathfrak{M}\{\mathcal{A}\}}$ Define
\begin{align*}
\mathcal{E}_2 &= \setbuilder{B\in\mathfrak{M}\{\mathcal{A}\}}{\forall C\in\mathcal{A}: B\cup C \in\mathfrak{M}\{\mathcal{A}\}} \\
\mathcal{E}_3 &= \setbuilder{B\in\mathfrak{M}\{\mathcal{A}\}}{\forall C\in\mathfrak{M}\{\mathcal{A}\}: B\cup C \in\mathfrak{M}\{\mathcal{A}\}}.
\end{align*}
Now $\mathcal{E}_2$ and $\mathcal{E}_3$ are monotone classes: by \ref{setAssociativityCommutativity} and \ref{setDistributivity}, for $k=1,2$
\[ (B_i)_{i=1}^\infty\subset \mathcal{E}_k \implies \forall C: (B_i\cup C)_{i=1}^\infty\subset \mathfrak{M}\{\mathcal{A}\} \implies \forall C: \bigcup_{i=1}^\infty B_i\cup C = \left(\bigcup_{i=1}^\infty B_i\right)\cup C \in\mathfrak{M}\{\mathcal{A}\} \implies \bigcup_{i=1}^\infty B_i \in \mathcal{E}_k. \]
Now clearly $\mathcal{A}\subseteq\mathcal{E}_2$, so by minimality $\mathcal{E}_2 = \mathfrak{M}\{\mathcal{A}\}$. Moreover,
\[ D\in\mathcal{A}\implies \forall C\in \mathcal{E}_2: C\cup D\in \mathfrak{M}\{\mathcal{A}\} \implies \forall C\in \mathfrak{M}\{\mathcal{A}\}: D\cup C\in \mathfrak{M}\{\mathcal{A}\} \implies D\in \mathcal{E}_3. \]
So $\mathcal{A}\subseteq\mathcal{E}_3$ and by minimality $\mathcal{E}_3 = \mathfrak{M}\{\mathcal{A}\}$, which means that
\[ B\in\mathfrak{M}\{\mathcal{A}\} \iff B\in\mathcal{E}_3 \implies \forall C\in\mathfrak{M}\{\mathcal{A}\}: B\cup C\in\mathfrak{M}\{\mathcal{A}\}. \]
\end{proof}
\begin{corollary}
Let $\mathcal{A}$ be an algebra and $M$ a monotone class with $\mathcal{A}\subseteq M$, then $\sigma\{\mathcal{A}\}\subseteq M$.
\end{corollary}

\begin{proposition} \label{generatedDynkinSigma}
If $\mathcal{F}$ is a $\pi$-system on $\Omega$, then
\[ \mathfrak{D}\{\mathcal{F}\} = \sigma\{\mathcal{F}\}. \]
\end{proposition}
\begin{proof}
Every $\sigma$-algebra is a Dynkin system, so $\mathfrak{D}\{\mathcal{F}\} \subset \sigma\{\mathcal{F}\}$.

For the other inclusion it is enough to show that $\mathfrak{D}\{\mathcal{F}\}$ is a $\pi$-system: using \ref{DynkinPiSystem}, we have
\[ \text{$\mathfrak{D}\{\mathcal{F}\}$ is a $\pi$-system} \implies \text{$\mathfrak{D}\{\mathcal{F}\}$ is a $\sigma$-algebra} \implies \sigma\{\mathcal{F}\}\subset\mathfrak{D}\{\mathcal{F}\}. \]

To this end we define
\[ \mathcal{D}_B = \setbuilder{A\subset\Omega}{A\cap B\in\mathfrak{D}\{\mathcal{F}\}} \qquad \text{for some $B\in\mathfrak{D}\{\mathcal{F}\}$,} \]
which we claim is a Dynkin system.
\begin{itemize}[leftmargin=2.5cm]
\item[$\boxed{\Omega\in\mathcal{D}_B}$] Because $\Omega\cap B = B$.
\item[$\boxed{A^c\in\mathcal{D}_B}$] Let $A\in\mathcal{D}_B$. Then
\[ A^c\cap B = (\Omega\setminus A)\cap B = (\Omega\cap B)\setminus(A\cap B) \in \mathfrak{D}\{\mathcal{F}\}, \]
so $A^c\in\mathcal{D}_B$.
\item[$\boxed{\biguplus_{i\in \N}A_i \in \mathcal{D}_B}$] Let $(A_i)_{i=1}^\infty$ be a disjoint family of sets in $\mathcal{D}_B$. Then, using \ref{setDistributivity},
\[ \left(\bigcup_{i=1}^\infty A_i\right)\cap B = \bigcup_{i=1}^\infty (A_i\cap B) \in \mathfrak{D}\{\mathcal{F}\}, \]
so $\bigcup_{i=1}^\infty A_i\in\mathcal{D}_B$.
\end{itemize}
Now because $\mathcal{F}$ is a $\pi$-system, we have $\mathcal{F}\subset\mathcal{D}_B$ and thus $\mathcal{D}_B\subset\mathfrak{D}\{\mathcal{F}\}$.

Now for all $B\in\mathcal{F}$, we have
\[ A\in\mathcal{F}\implies A\cap B\in\mathcal{F}\implies A\cap B\in\mathfrak{D}\{\mathcal{F}\} \implies A\in \mathcal{D}_B. \]
So $\mathcal{F}\subset \mathcal{D}_B$ if $B\in\mathcal{F}$. In this case we then also have $\mathfrak{D}\{\mathcal{F}\}\subset \mathcal{D}_B$.

In fact this holds for all $B\in\mathfrak{D}\{\mathcal{F}\}$:
\[ B\in\mathfrak{D}\{\mathcal{F}\} \implies \forall A\in\mathcal{F}: B\in\mathcal{D}_A \implies  \forall A\in\mathcal{F}: B\cap A \in \mathfrak{D}\{\mathcal{F}\} \implies \mathcal{F}\subset\mathcal{D}_B \implies \mathfrak{D}\{\mathcal{F}\}\subset \mathcal{D}_B. \]
Consequently,
\[ B,C\in\mathfrak{D}\{\mathcal{F}\} \implies C\in\mathcal{D}_B \implies C\cap B\in\mathfrak{D}\{\mathcal{F}\}, \]
meaning $\mathfrak{D}\{\mathcal{F}\}$ is a $\pi$-system.
\end{proof}
\begin{corollary}[$\pi$-$\lambda$ theorem] \label{piLambdaTheorem}
Let $P$ be a $\pi$-system and $D$ a Dynkin system with $P\subseteq D$, then $\sigma\{P\} \subseteq D$.
\end{corollary}
\begin{corollary}
If $\mathcal{A}$ is an algebra, then $\mathfrak{M}\{\mathcal{A}\} = \mathfrak{D}\{\mathcal{A}\} = \sigma\{\mathcal{A}\}$.
\end{corollary}

\subsection{Product $\sigma$-algebras}
\subsubsection{Finite products}
\begin{definition}
Let $X,Y$ be sets and $\mathcal{A}, mathcal{B}$ $\sigma$-algebras on $X,Y$, respectively. Then the \udef{product $\sigma$-algebra} of $\mathcal{A}$ and $\mathcal{B}$ is
\[ \mathcal{A}\otimes\mathcal{B} \defeq \sigma\setbuilder{A\times B}{A\in \mathcal{A}, B\in \mathcal{B}}. \]
\end{definition}
Notice that in general for $\sigma$-algebras $\mathcal{A},\mathcal{B}$, to set $\setbuilder{A\times B}{A\in \mathcal{A}, B\in\mathcal{B}}$ is not a $\sigma$-algebra. It is necessary to take the closure.

\begin{example}
Take $\Omega = \{a,b,c\}$. Define the $\sigma$-algebras $\mathcal{A},\mathcal{B}$ on $\Omega$ by
\begin{align*}
\mathcal{A} &= \{\emptyset, \{a\}, \{b,c\}, \Omega\} \\
\mathcal{B} &= \{\emptyset, \{a, b\}, \{c\}, \Omega\}.
\end{align*}
Then $\{a\}\times\{a,b\} \in \setbuilder{A\times B}{A\in \mathcal{A}, B\in\mathcal{B}}$, but
\[ (\{a\}\times\{a,b\})^c = \Big(\{b,c\}\times \{a,b,c\}\Big) \cup \Big(\{a, b ,c\}\times\{c\}\Big) \]
is not in $\setbuilder{A\times B}{A\in \mathcal{A}, B\in\mathcal{B}}$, so it is not a $\sigma$-algebra.
\end{example}

\begin{lemma}
Let $X,Y$ be sets and $A\subseteq X, B\subseteq Y$ subsets. Then
\[ (A\times B)^c = A^c\times B \uplus A\times B^c \uplus A^c\times B^c = A^c\times Y \cup X\times B^c. \]
\end{lemma}
\begin{proof}
We have $X\times Y = (A\uplus A^c)\times (B\uplus B^c)$ and the lemma follows by \ref{productUnionIntersection}.
\end{proof}

\subsubsection{Infinite products}
\begin{definition}
Let $I$ be an index set, $\{X_i\}_{i\in I}$ a set of sets and $\{\mathcal{A}_i\}_{i\in I}$ a set of $\sigma$-algebras such that for all $i\in I$, $\mathcal{A}_i$ is a $\sigma$-algebra on $X_i$. We define the \udef{product $\sigma$-algebra} $\bigotimes_{i\in I}\mathcal{A}_i$ on $\prod_{i\in I}X_i$ as
\[ \bigotimes_{i\in I}\mathcal{A}_i \defeq \sigma\setbuilder{\prod_{i\in I}A_i}{\forall i\in I: A_i\in\mathcal{A}_i\; \text{and}\; \setbuilder{i\in I}{A_i\neq X_i}\;\text{is finite}}. \]
\end{definition}

\begin{proposition}
We may replace ``is finite'' with ``is countable'' in the definition.
\end{proposition}
\begin{proof}
TODO (can we??)
\end{proof}

\chapter{Well-founded ordered sets}
\begin{definition}
A poset is called
\begin{itemize}
\item \udef{well-founded} if every non-empty subset has a minimal element;
\item \udef{converse well-founded} if every non-empty subset has a maximal element.
\end{itemize}

A \udef{well-ordering} on a set $U$ is a total order $\leq$ on $U$ such that $\sSet{U,\leq}$ is well-founded.

A set $A$ is \udef{well-orderable} if it admits a well-ordering.
\end{definition}
It turns out a well-order is what is needed to do recursion and induction.

\begin{lemma}
Every well-ordering has a least element.
\end{lemma}
\begin{proof}
A minimal element for a total order is always a least element.
\end{proof}

\begin{lemma} \label{wellOrderingSubsets}
Let $(U,\leq_U)$ be a well-ordered set and $f: W \rightarrowtail U$ an injection. Then $W$ is well-ordered by
\[ \forall x,y\in W: x\leq_W y \defequiv f(x) \leq_U f(y). \]


In particular, if $W\subseteq U$ is a subset, then $\leq_W$ is the left- and right-restriction of $\leq$ to $W$, $\leq|_W^W$.
\end{lemma}

\section{Succession}
Every well-ordered set $U$ must have a least element and at its low end it looks like $\N$:
\begin{itemize}
\item let $0_U$ denote the least element of $U$;
\item we can define $S_U(x) \defeq \min\{y\in P\;|\;x<y\}$.
\end{itemize}
This successor function is defined for all $x\in U$, except the maximum (if it exists).

\begin{definition}
Let $(U,\leq)$ be a well-ordered set.
\begin{itemize}
\item The values of the partial function $S: U\not\to U$ are the \udef{successor points} of $U$.
\item A \udef{limit point} is an element $x\in U$ that is neither $0_U$ nor a successor. The first limit point (i.e. the least point in the set of limit points) is denoted $\omega$ or $\omega_U$.
\item The points below $\omega$ are called \udef{finite points} and the points above, and including, $\omega$ are the \udef{infinite points} of $U$.
\end{itemize}
\end{definition}

If $P$ is a poset, we can always add a point on top of all the rest: We can take, e.g. the set
\[ t_P = \{ x\in P\;|\;x\notin x \}. \]
This is guaranteed, by proposition \ref{russelParadox}, not to be in $P$.
The poset $P\cup t_P$ is called the \udef{successor} $\operatorname{Succ}(P)$ of $P$.

\section{Initial segments}
TODO: streamline
\begin{definition}
Let $(U,\leq)$ be a well-ordered set. An \udef{initial segment} $I$ of $U$ is a downward closed subset:
\[ \forall y\in I: \forall x\in U: x\leq y \implies x\in I. \]
We write $I \sqsubseteq U$.
\end{definition}
Each element $y$ of $U$ determines a proper initial segment of points strictly below $y$:
\[ \seg(y) \defeq \{ x\in U\;|\; x < y \} \sqsubsetneq U. \]
We have $\seg(S_U(y)) = \seg(y)\cup\{y\}$.

Conversely, each proper initial segment is of the form $\seg(x)$:
\begin{proposition}
Let $(U,\leq)$ be a well-ordered set and $W$ a subset of $U$. Then $W$ is an initial segment \textup{if and only if} either $W=U$ or $\exists! x\in U: W = \seg(x)$.
\end{proposition}
\begin{proof}
The direction $\Rightarrow$ is trivial. For the other direction, assume $W \sqsubsetneq U$ and let $x= \min(U\setminus W)$. Showing that $W=\seg(x)$ is not difficult.
\end{proof}
We may then, in some sense, view $x$ as the length of $\seg(x)$. We identify $t_U$ as the length of $U$. Let $U$ be a well-ordered set. We define $\len_U$ which maps initial segments of $U$ to $\operatorname{Succ}(U)$ by
\[ \len_U(V) = \begin{cases}
x & \exists x\in U: V=\seg(x) \\
t_U & V = U.
\end{cases} \]

Each well-ordered set $U$ can be viewed as a proper initial segment of another:
\[ U = \seg_{\operatorname{Succ}(U)}(t_U)\sqsubsetneq \operatorname{Succ}(U). \]
\begin{lemma} \label{orderingInitialSegments}
Let $(U,\leq)$ be a well-ordered set and $x,y\in U$, then
\begin{align*}
\seg(x) = \seg(y) &\iff x = y; \\
\seg(x) \sqsubseteq \seg(y) &\iff x \leq y; \\
\seg(x) \sqsubsetneq \seg(y) &\iff x < y.
\end{align*}
\end{lemma}
\begin{proposition} \label{wosetIsomorphicToInitialSegments}
Any well-ordered set $(U,\leq)$ is order isomorphic to the set of its proper initial segments ordered by inclusion, $(\seg_U[U], \sqsubseteq)$.
\end{proposition}
\begin{proof}
The function $\seg_U$ is an order embedding by lemma \ref{orderingInitialSegments}. By lemma \ref{orderReflectionIsInjective} it must be injective and thus $U =_o \seg_U[U]$.
\end{proof}
\begin{lemma}
The family of initial segments of a well-ordered set $U$ is
\begin{enumerate}
\item well-ordered by $\sqsubseteq$; and
\item closed under arbitrary unions.
\end{enumerate}
\end{lemma}
\begin{lemma} \label{unionInitialSegments}
Let $(U,\leq)$ be a well-ordered set and $t\in U$. Then $\bigcup\{ \seg(u)\;|\; u<t \}$ is an initial segment and thus equal to $\seg(v)$ for some $v$. Also
\[ \seg(v) \leq \seg(t) \leq \seg(S_U(v)). \]
\end{lemma}
\begin{proof}
For the first inequality: let $x\in \seg(v)$, so $\exists u<t: x\in\seg(u)$ so $x<t$ and $x\in \seg(t)$.

For the second inequality: assume, towards a contradiction, that $\seg(t)>\seg(S_U(v))$. Then $S_U(v) < t$ and so $\seg(S_U(v))\subseteq \seg(v)$ and thus $v\in\seg(v)$, a contradiction.
\end{proof}

\begin{proposition} \label{injectionsExpansive}
Every order-preserving injection $f: U\rightarrowtail U$ of a well-ordered set into itself is expansive.
\end{proposition}
\begin{proof}
Assume $f: U\rightarrowtail U$ injective but not expansive, i.e. $\exists x\in U: f(x)<x$ then let
\[ x^* = \min\{x\in U\;|\;f(x)<x\}. \]
Then $f(x^*)<x^*$ and $f(f(x^*)) < f(x^*)$ by order preservation. Then $f(x^*)$ is a smaller element in the set, yielding a contradiction.
\end{proof}
\begin{corollary} \label{properInitialSegmentNotIsomorphic}
No well-ordered set is isomorphic with one of its proper initial
segments, and hence no two distinct initial segments of a well-ordered set are
isomorphic.
\end{corollary}


\section{Transfinite induction and recursion}
The principles of induction and recursion can be generalised to well-ordered sets.

In general induction and recursion use the predecessor to define / prove a property of the successor. In general well-ordered sets, there are limit points that have no predecessor. For this reason it is easiest to generalize the principles of proof by \textit{complete
induction} and definition by \textit{complete recursion}. Then we take the set of all predecessors, not the one predecessor that may or may not exist.

\begin{theorem}[Transfinite induction]
Let $U$ be a well-ordered set and $P$ a unary definite predicate. We can prove $P(x)$ holds for all $x\in U$ by proving the strong induction step $\forall x\in U: \forall y<x: P(y)\implies P(x)$.

Or, in other symbols,
\[ \text{if}\quad  \forall x\in U: \left[\forall y < x: P(y)\implies P(x)\right] \quad \text{then}\quad \forall x\in U: P(x) \]
\end{theorem}
\begin{proof}
Assume, towards a contradiction, the induction step and that $\exists x\in P: \neg P(x)$. Then the set of all such $x$ has a least element (due to $U$ being well-ordered). Let
\[ x^* = \min\{ x\in U\;|\; \neg P(x) \}, \]
then all elements smaller than $x^*$ must not be in this set: $\forall y<x^*: P(y)$, so that by the induction step $P(x^*)$.
\end{proof}
Notice that the ``base step'' ($\nexists y\in U: y<0$, so $\forall y<0: P(y)\implies P(x)$) is vacuously true.

It is often as easy to repeat this argument as appeal to the theorem.

\begin{theorem}[Transfinite recursion]
Let $U$ be a well-ordered set, $E$ some non-empty set and $h: (U\not\to E) \to E$ some function.

There is exactly one function $f:U\to E$ which satisfies
\[ f(x) = h(f|_{\seg(x)}) \qquad \forall x\in U. \]
\end{theorem}
\begin{proof}
Like when proving recursion on $\N$, we will consider ``approximations'' of the function $f$, i.e. functions $\seg(t) \to E$ which satisfy the requirement for all $x<t$.

This is the subject of the following lemma:
\begin{lemma*}
Let $U$ be a well-ordered set, $E$ some non-empty set and $h: (U\not\to E) \to E$ some function.

For all $t\in U$, there is exactly one function $\sigma_t:\seg(t)\to E$ which satisfies
\[ \sigma_t(x) = h(\sigma_t|_{\seg(x)}) \qquad \forall x < t. \]
\end{lemma*}
\begin{proof}[Proof of lemma] \renewcommand{\qedsymbol}{$\dashv$ (Lemma)}
The proof goes by transfinite induction. Fix an arbitrary $t\in U$. Assume the induction hypothesis:
\[ \forall u<t: \exists! \sigma_u\in (\seg(u)\to E): \forall x<u: \sigma_u(x) = h(\sigma_u|_{\seg(x)}). \]
We need to prove that this implies there exists exactly one $\sigma_t$ satisfying the condition. We consider three cases: $t$ is the least point $0_U$, a successor point or a limit point.
\begin{itemize}[leftmargin=2.5cm]
\item[\boxed{t = 0_U}] Then $\seg(t) = \emptyset$ and we must have $\sigma_t = \emptyset$.
\item[\boxed{t = S_U(v)}] If $t$ is the successor of $v$, we can set
\[ \sigma_t = \sigma_v\cup\{ (v,h(\sigma_v)) \}. \]
\item[\boxed{t\in \operatorname{Limit}(U)}] The set of functions $\{\sigma_u\;|\; u<t\}$ is a chain in the poset $((U\not\to E),\subseteq)$ which is inductive, see \ref{inductive}. Let $\sigma_t$ be the least upper bound.

To prove $\{\sigma_u\;|\; u<t\}$ is a chain, assume not i.e.
\[ x<u<v<t \implies \sigma_u(x) = \sigma_v(x) \]
fails for some $x<u<v$. Take the least such $x$ (we are effectively doing transfinite induction) so then
\[ \sigma_u|_{\seg(x)} = \sigma_v|_{\seg(x)}, \]
and by the induction hypothesis
\[ \sigma_u(x) = h(\sigma_u|_{\seg(x)}) = h(\sigma_v|_{\seg(x)}) = \sigma_v(x). \]
This is a contradiction, proving we do indeed have a chain.

Finally we verify
\begin{itemize}
\item the domain of $\sigma_t$ is $\seg(t)$; indeed
\[ \dom(\sigma_t) = \bigcup\{\dom(\sigma_u)\;|\; u< t \} = \bigcup\{ \seg(u)\;|\; u<t \} \]
which is an initial segment and thus equal to $\seg(v)$ for some $v$. By lemma \ref{unionInitialSegments}
\[ v\leq t \leq S_U(v). \]
Then either $t=v$ or $t=S_U(v)$. The latter is excluded because $t$ was a limit point.
\item $\sigma_t$ satisfies the condition (easily by transfinite induction);
\item $\sigma_t$ is unique (also easily by transfinite induction).
\end{itemize}
\end{itemize}
\end{proof}

Now consider the well-ordered set $\operatorname{Succ}(U)$ and extend $h$ to $h': (\operatorname{Succ}(U)\not\to E) \to E$ by
\[ h'(\sigma) = \begin{cases}
h(\sigma) & \sigma\in (U\not\to E) \\
\text{an arbitrary element of $E$} & \sigma \notin (U\not\to E).
\end{cases} \]
We can then apply the lemma to $\operatorname{Succ}(U)$ and $h'$. Because $\seg(t_U) = U$, this gives a unique function $\sigma_{t_U}: U\to E$. We take this as our $f$.
\end{proof}


\chapter{Fixed points}

\begin{definition}
A monotone mapping $\pi : P \to Q$ on a inductive posets
 is \udef{countably continuous} if for every non-empty, countable chain $S\subseteq P$:
 \[ \pi(\sup S) = \sup\pi[S]. \]
\end{definition}

\begin{definition}
Let $(P,\leq)$ be a poset and $f: P\to P$ a function from $P$ to $P$.
\begin{itemize}
\item A \udef{fixed point} is an element $x^*\in P$ such that
\[ f(x^*) = x^*. \]
\item A \udef{strongly least fixed point} is a fixed point such that
\[ \forall y\in P: f(y)\leq y \implies x^* \leq y. \]
\item The \udef{orbit} of an element $p$ of $P$ is a sequence $\N\to P$ defined recursively:
\begin{align*}
p_0 &= p \\
p_{n+1} &= f(p).
\end{align*}
Sometimes we use orbit to mean the set $\{p_n\in P\;|\; n\in \N\}$.
\end{itemize}
\end{definition}

\begin{theorem}[Continuous least fixed point theorem]
Let $\pi:P\to P$ be a countably continuous, monotone mapping on an inductive poset $(P,\leq)$. Then $\pi$ has a unique strongly least fixed point $x^*\in P$.
\end{theorem}
\begin{proof}
As $P$ is inductive, it has a least element $\bot$. The orbit $\{x_n\in P\;|\; n\in \N\}$ of $\bot$ is a chain: $\bot \leq \pi(\bot)$ and the rest follows by induction on $n$, using the monotonicity of $\pi$. Thus the orbit has a supremum. Let $x^*$ be this supremum.

Then, by countable continuity,
\[ \pi(x^*) = \pi(\sup\{x_n\in P\;|\; n\in \N\}) = \sup\pi[\{x_n\in P\;|\; n\in \N\}] = \sup\{x_{n+1}\in P\;|\; n\in \N\} = x^*. \]

To prove $x^*$ is a strongly least fixed point, let $y\in P$ assume $\pi(y)\leq y$. Then we apply induction on $n$:
\begin{itemize}[leftmargin=3cm]
\item[Basis step] $x_0 = \bot \leq y$.
\item[Induction step] $x_n \leq y \implies x_{n+1} = \pi(x_n)\leq \pi(y) \leq y$.
\end{itemize}
\end{proof}

Iteration lemma.

Fixed point theorem.

Least fixed point theorem.

Hitchhiker's guide:
Knaster-Tarski fixed point; Tarksi fixed point

\chapter{Graphs}
\chapter{Trees}