\url{file:///C:/Users/user/Downloads/0-8176-4442-3.pdf}
\url{https://link.springer.com/content/pdf/10.1007%2F978-0-387-84895-2.pdf}
\url{https://zr9558.files.wordpress.com/2014/08/a-guide-to-distribution-theory-and-fourier-transforms.pdf}
\url{file:///C:/Users/user/Downloads/978-0-8176-4675-2.pdf}

Integral mean value theorem \url{https://en.wikipedia.org/wiki/Mean_value_theorem#Mean_value_theorems_for_definite_integrals}

TODO: Hölder, Minkowski, Lyapounov

TODO: Moore-Osgood

\chapter{Limits}

TODO: squeeze theorem!

\section{Bachmann-Landau notation}
\subsection{Asymptotic bounds: $O, \Theta, \Omega$}
\begin{definition}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g: X\setminus\{x_0\}\to V$ be functions. The statement
\begin{itemize}
\item ``$f(x) = O(g(x))$ as $x\to x_0$'' means there exists a neighbourhood $S$ of $x_0$ and a constant $M\in\R$ such that
\[ \forall x\in S:\; \norm{f(x)} \leq M\norm{g(x)}; \]
\item ``$f(x) = \Omega(g(x))$ as $x\to x_0$'' means there exists a neighbourhood $S$ of $x_0$ and a constant $M\in\R$ such that
\[ \forall x\in S:\; \norm{f(x)} \geq M\norm{g(x)}; \]
\item ``$f(x) = \Theta(g(x))$ as $x\to x_0$'' means there exists a neighbourhood $S$ of $x_0$ and constants $M_1,M_2\in\R$ such that
\[ \forall x\in S:\; M_1\norm{g(x)} \leq \norm{f(x)} \leq M_2\norm{g(x)}. \]
\end{itemize}
We may add the word ``uniformly'' to these statements to mean we can take $S=X$.

We may suppress the $x$ dependence for legibility and write e.g\ $f = O(g)$ instead.
\end{definition}

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g: X\setminus\{x_0\}\to V$ be functions. Then
\begin{enumerate}
\item $f = O(g)$ \textup{if and only if} $g = \Omega(f)$ as $x\to x_0$;
\item $f = \Theta(g)$ \textup{if and only if} $f = O(g)$ and $f = \Omega(g)$ as $x\to x_0$.
\end{enumerate}
\end{lemma}

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f: X\setminus\{x_0\}\to V$ be functions. Then ``being $\Theta(f)$ as $x\to x_0$'' is an equivalence relation.
\end{lemma}

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g: X\setminus\{x_0\}\to V$ be functions. Then
\begin{enumerate}
\item $f(x) = O(g(x))$ as $x\to x_0$ \textup{if and only if} there exists a neighbourhood $S$ of $x_0$ such that $\norm{f(x)}/\norm{g(x)}$ is bounded on $S$;
\item $f(x) = \Omega(g(x))$ as $x\to x_0$ \textup{if and only if} there exists a neighbourhood $S$ of $x_0$ such that $\norm{f(x)}/\norm{g(x)}$ is bounded below on $S$ by a strictly positive constant.
\end{enumerate}
\end{lemma}

\subsection{Asymptotic domination and equality: $o,\sim,\omega$}
\begin{definition}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g: X\setminus\{x_0\}\to V$ be functions. The statement
\begin{itemize}
\item ``$f(x) = o(g(x))$ as $x\to x_0$'' means $\lim_{x\to x_0} \frac{\norm{f(x)}}{\norm{g(x)}} = 0$;
\item ``$f(x) \sim_{x_0} g(x)$'' means $\lim_{x\to x_0} \frac{\norm{f(x)}}{\norm{g(x)}} = 1$;
\item ``$f(x) = \omega(g(x))$ as $x\to x_0$'' means $\lim_{x\to x_0} \frac{\norm{f(x)}}{\norm{g(x)}} = \infty$.
\end{itemize}
\end{definition}

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g: X\setminus\{x_0\}\to V$ be functions.

Then $f = o(g)$ \textup{if and only if} $g = \omega(f)$ as $x\to x_0$.
\end{lemma}

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g: X\setminus\{x_0\}\to V$ be functions. Then
\begin{enumerate}
\item $f\sim_{x_0} g \iff (f-g)\in o(g)$ as $x\to x_0$;
\item $\sim_{x_0}$ is an equivalence relation;
\item $f \sim_{x_0} g \implies f = \Theta(g)$ as $x\to x_0$.
\end{enumerate}
\end{lemma}

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space and $(V,\norm{\cdot})$ a normed space. Let $x_0 \in X$ and $f,g, h,k: X\setminus\{x_0\}\to V$ be functions. Then
\begin{enumerate}
\item if $f = o(h)$ and $g = O(k)$, then $fg = o(hk)$ as $x\to x_0$;
\item if $f = O(h)$ and $g = O(k)$, then $fg = O(hk)$ as $x\to x_0$;
\item if $f = o(h)$ and $h = O(k)$, then $f = o(k)$ as $x\to x_0$.
\end{enumerate}
\end{lemma}

\chapter{Differentiation}
\url{file:///C:/Users/user/Downloads/978-1-4614-3894-6.pdf}
\url{file:///C:/Users/user/Downloads/2011_Bookmatter_TheRicciFlowInRiemannianGeomet.pdf}

\section{Derivatives of functions between normed groups}
\begin{definition}
Let $G, H$ be normed groups, $f:G\to H$ a function and $x_0\in G$. We call $f$ \udef{differentiable} if there exists a continuous homomorphism $A_{x_0}$ such that
\[ \lim_{x\to 1}\frac{\norm{f(xx_0)f(x_0)^{-1}A_{x_0}(x)^{-1}}}{\norm{x}} = 0. \]
We call $A_{x_0}$ a \udef{derivative} of $f$ at $x_0$.
\end{definition}

\begin{proposition}
Let $G, H$ be normed groups, $f:G\to H$ a function and $x_0\in G$. There exists at most one derivative of $f$ at $x_0$.
\end{proposition}
\begin{proof}
TODO
\end{proof}

\subsection{Fréchet derivatives on normed vector spaces}

\section{Directional derivatives}

\section{For real normed vector spaces}
TODO: directional / Gateaux derivative for locally convex TVSs?
\subsection{Directional derivatives}
\begin{definition}
Let $V,W$ be normed vector spaces and $f:U\subseteq V\to W$ a function defined on an open subset $U$. For $a,u\in V$, we call
\[ \partial_u f|_a \defeq \lim_{t\to 0} \frac{f(a+tu) - f(a)}{t} \]
the \udef{directional derivative} of $f$ at $a$ in the direction $u$,if it exists.

\begin{itemize}
\item If $V= \R^n$, then we define $\pd{f}{x^i}f \defeq \partial_{\vec{e}_i}f$, where $\mathcal{E} = \seq{\vec{e}_i}_{i=1}^n$ is the standard basis of $\R^n$. These directional derivatives are called the \udef{partial derivatives} w.r.t. the basis $\mathcal{E}$.
\item If $V = \R$, then there is, up to scalar multiplication, only one direction $u$. We denote the directional derivative $f'(a) \defeq \partial_u f|_a$.
\end{itemize}
\end{definition}
For a given function $f:V\to W$, the directional derivative is a partial function of both a direction and a point:
\[ (V\times V) \not\to W:\quad (u,a) \mapsto \partial_u f(a)  \]

Partial application in the first argument gives a function
\[ \partial_u f:\; V\not\to W:\; a\mapsto \partial_u f(a) \defeq \partial_u f|_a \]
that is also referred to as the \udef{directional derivative} of $f$ in the direction $u$.

\begin{lemma}
Let $f,g: V\to W$, $u\in V$ and $\lambda\in\F$, then
\begin{enumerate}
\item $\partial_u(f+g) = \partial_uf + \partial_u g$;
\item $\partial_u(fg) = (\partial_uf)g + f(\partial_u g)$;
\item $\partial_u(\lambda f) = \lambda \partial_uf$.
\end{enumerate}
\end{lemma}

\begin{proposition} \label{derivativeBilinearForm}
Let $B: V_1 \oplus V_2 \to W$ be a bilinear form. Then, for $(x,y),(a,b)\in V_1\oplus V_2$
\[ \partial_{(x,y)}B|_{(a,b)} = B(x,b) + B(a,y). \]
\end{proposition}
\begin{proof}
We calculate
\begin{align*}
\partial_{(x,y)}B|_{(a,b)} &= \lim_{t\to 0} \frac{B(a+tx, b+ty) - B(a,b)}{t} \\
&= \lim_{t\to 0} \frac{1}{t} (B(a,b) + tB(a,y) + tB(x,b) + t^2B(x,y) - B(a,b)) \\
&=B(x,b) + B(a,y) + \lim_{t\to 0} tB(x,y) \\
&= B(x,b) + B(a,y).
\end{align*}
\end{proof}

\subsubsection{Partial derivatives}
TODO notation $D^\alpha$ for multiindex $\alpha$. Also $|\alpha| = \sum_i \alpha_i$.

\subsubsection{Gateaux derivative}
\begin{definition}
Partial application of the directional derivative in the second argument gives a function
\[ \diff{_af}: V\not\to W: u\mapsto \diff{_af}(u) \defeq \partial_u f|_a = \lim_{t\to 0} \frac{f(a+tu) - f(a)}{t} \]
that is referred to as the \udef{Gateaux differential} of $f$ at the point $a$.

If $\diff{_af}: V\not\to W$ is a bounded linear map, we will refer to it as the \udef{Gateaux derivative}.
\end{definition}
The Gateaux differential is homogeneous even if it is not linear:
\begin{lemma}
Let $f:V\to W$ be a function between normed spaces and $a,u\in V$. If $\partial_u f$ is defined at $a$, then
\[ \diff{_a f}(\lambda u) = \partial_{\lambda u}f(a) = \lambda\partial_u f(a) = \lambda \diff{_a f}(u) \qquad \forall \lambda\in\F. \]
\end{lemma}
\begin{proof}
$\partial_{\lambda u}f(a) = \lim_{t\to 0} \frac{f(a+t\lambda u) - f(a)}{t} = \lim_{t\lambda\to 0} \frac{f(a+t\lambda u) - f(a)}{t \lambda / \lambda} = \lambda\partial_u f(a)$.
\end{proof}

TODO mean value theorem?

\subsection{Hadamard derivative}

\subsection{Fréchet derivative}
\begin{definition}
If a function has a (bounded linear) Gateaux derivative at $a$ and the limit in the definition of the derivative
\[ \diff{_af}: V\not\to W: u\mapsto \diff{_af}(u) \defeq \partial_u f|_a = \lim_{t\to 0} \frac{f(a+tu) - f(a)}{t} \]
is uniform in all $u$ on the $S(\vec{0},1)$, then we say the function is \udef{(Fréchet) differentiable} at $a$ and has \udef{Fréchet derivative} $\diff{_af}$.

We may also write $\diff{f}$, leaving the $a$ implicit.
\end{definition}

\begin{proposition}
Let $V,W$ be normed vector spaces and $f:U\subseteq V\to W$ a function defined on an open subset $U$. Let $a\in V$.

Then $f$ is Fréchet differentiable at $a$ \textup{if and only if} there exists a bounded linear map $A: V\to W$ such that $f(a+x)$ can be written as
\[ f(a+x) = f(a) + A(x) + o(x) \qquad \text{as} \qquad x\to 0. \]
In this case $A = \diff{_af}$.
\end{proposition}
\begin{proof}
First assume $f$ is Fréchet differentiable at $a$. Then
\begin{multline*}
\forall \varepsilon>0:\exists \delta>0: \; \forall u\in S(\vec{0},1): \forall t\in\R: \; t< \delta \implies \varepsilon > \\ \norm{\frac{f(a+tu) - f(a)}{t} - \diff{_af}(u)} = \frac{\norm{f(a+tu) - f(a)- \diff{_af}(tu)}}{|t|} = \frac{\norm{f(a+tu) - f(a)- \diff{_af}(tu)}}{\norm{tu}}.
\end{multline*}

Now each vector $x$ in $V$ can be written as $tu$ for some $t\in\R$ and $u\in S(\vec{0},1)$, so this can be written as
\[ \forall \varepsilon>0:\exists \delta>0: \; \forall x\in V: \; \norm{x}< \delta \implies  \varepsilon > \frac{\norm{f(a+x) - f(a)- \diff{_af}(x)}}{\norm{x}} \]
which is exactly the statement $f(a+x) = f(a) + \diff{_af}(x) + o(x)$ as $x\to 0$.

The logic can be reversed to obtain the equivalence.
\end{proof}

\begin{proposition}
If a function is Fréchet differentiable at a point $a$, then it is continuous at $a$.
\end{proposition}
\begin{proof}
Assume $f$ is has Fréchet derivative $A$. Then
\[ 0 = \lim_{x\to a} \norm{f(x) - f(a) - \diff{_af}(x-a)} = \norm{\lim_{x\to a}f(x) - f(a) - \diff{_af}(\lim_{x\to a} x-a)} = \norm{\lim_{x\to a}f(x) - f(a)}. \]
\end{proof}

\begin{lemma}
The Fréchet derivative is the same for equivalent norms.
\end{lemma}

\subsubsection{Link with Gateaux derivative}
\url{https://link.springer.com/content/pdf/bbm%3A978-3-642-16286-2%2F1.pdf}
\url{http://www.m-hikari.com/ams/ams-password-2008/ams-password17-20-2008/behmardiAMS17-20-2008.pdf}
\begin{proposition}
If a function between subsets of normed spaces is Fréchet differentiable, it is also Gateaux differentiable and the Fréchet derivative is equal to the Gateaux derivative.
\end{proposition}
\begin{proof}
Let $A$ be the Fréchet derivative of $f: U\subseteq V\to W$. Then for all $u\in V$
\begin{align*}
0 &= \lim_{t\to 0} \frac{\norm{f(a+tu) - f(a) - A(tu)}}{\norm{tu}} = \lim_{t\to 0} \frac{\norm{(f(a+tu) - f(a))/t - A(u)}}{\norm{u}} \\
&= \frac{\norm{\lim_{t\to 0}(f(a+tu) - f(a))/t - A(u)}}{\norm{u}} = \frac{\norm{\diff{_af}(u) - A(u)}}{\norm{u}}. 
\end{align*}
\end{proof}
For this reason we will also denote the Fréchet derivative of $f$ at $a$ as $\diff{_a f}$. We will sometimes also write $f'(a)$.

\begin{example}
TODO!

There are functions that have a Gateaux derivative, but not a Fréchet derivative at certain points. For example
\[ f: \R^2\to \R: (x,y) \mapsto \begin{cases}
\frac{xy}{x^2+y^2} & (x,y)\neq (0,0) \\0 & (x,y) = (0,0)
\end{cases} \]
which has $\partial_{\vec{u}}f(\vec{0}) = 0$ for all $\vec{u}\in \R^2$ and thus the Gateaux derivative at zero is $\diff{f} = 0$.

Composing $f$ with $t\mapsto (t,t^2)$ yields the function $t\mapsto \begin{cases}
t^{-2} & t\neq 0 \\ 0 & t=0
\end{cases}$, which is not continuous at $0$. So $f$ is not continuous at zero and a fortiori is not Fréchet differentiable.
\end{example}

\begin{proposition}
If there exists a basis $\beta$ of $V$ such that the partial derivatives of $f:U\subseteq V\to W$ w.r.t. $\beta$ exist and are continuous in $a\in V$, then $f$ is Fréchet differentiable in $a$.
\end{proposition}
\begin{proof}

\end{proof}
TODO for finite dimensions! Expand to criterion for Gateaux to Fréchet.
\begin{example}

\end{example}

\subsubsection{The Jacobian}
\begin{definition}
Let $f:U\subseteq\R^m\to\R^n$ be a function. Then $A_{\diff{f}}$ is a matrix with
\[ [A_{\diff{f}}]_{ij} = [\diff{f}\vec{e}_j]_i = \left[\pd{f}{x^j}\right]_i. \]
This matrix is called the \udef{Jacobian} $J_f$.
\end{definition}


\subsection{Differentiation in a convergence algebra}

\begin{proposition}[Leibniz rule]
Let $A$ be a normed algebra and $a,b\in (\R \to A)$ elements that have derivatives. Then
\[ (ab)' = a'b + ab'. \]
\end{proposition}
\begin{proof}
We calculate
\begin{align*}
0 &= 0\cdot a'(t)b'(t) = \lim_{\epsilon \to 0} \epsilon a'(t)b'(t) \\
&= \lim_{\epsilon \to 0} \epsilon \frac{a(t+\epsilon) - a(t)}{\epsilon}\frac{b(t+\epsilon) - b(t)}{\epsilon} \\
&= \lim_{\epsilon \to 0}\frac{a(t+\epsilon)b(t+\epsilon) - a(t+\epsilon)b(t) - a(t)b(t+\epsilon) + a(t)b(t)}{\epsilon} + \frac{a(t)b(t)}{\epsilon} - \frac{a(t)b(t)}{\epsilon} \\
&= \lim_{\epsilon \to 0} \frac{a(t+\epsilon)b(t+\epsilon) - a(t)b(t)}{\epsilon} - \frac{a(t+\epsilon) - a(t)}{\epsilon}b(t) - a(t)\frac{b(t+\epsilon) - b(t)}{\epsilon} \\
&= (ab)' - a'b - ab'.
\end{align*}
\end{proof}

\begin{proposition} \label{derivativeIdempotent}
Let $A$ be an algebra and $p\in A$ such that $p^2 = p$ and $p'$ exists. Then
\begin{enumerate}
\item $p' = pp'+ p'p$;
\item $pp'p = 0$;
\item $(p')^2 = p'pp' + p(p')^2p$;
\item $p^{\prime\prime} = 2(p')^2 + pp^{\prime\prime} + p^{\prime\prime}p$;
\item $pp^{\prime\prime}p = -2p(p')^2p$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) We calculate $p' = (p^2)' = pp'+ p'p$.

(2) Multiply (1) by $p$ on the left and right.

(3) We calculate $(p')^2 = (pp'+ p'p)(pp'+ p'p) = pp'pp' + pp'p'p + p'ppp' + p'pp'p = 0p + pp'p'p + p'pp' + p'0$.

(4) Take derivative of (1).

(5) Multiply (3) by $p$ on the left and right.
\end{proof}
\begin{corollary}
Let $\Tr$ be a trace functional on $A$ and $p\in A$ as before. Then $\Tr(p') = 0$.
\end{corollary}
\begin{proof}
$\Tr(p') = \Tr(pp'+ p'p) = \Tr(p^2p')+ \Tr(p'p^2) = \Tr(pp'p) + \Tr(pp'p) = 2Tr(0) = 0$.
\end{proof}
\begin{proposition}
Let $p_0,p_1$ be differentiable idempotents such that $p_0p_1 = 0 = p_1p_0$. Then $p_0'p_1 = -p_0p_1'$.
\end{proposition}
\begin{proof}
We have $0 = p_0p_1$, so $0 = 0' = p_0'p_1 + p_0p_1'$.
\end{proof}
\begin{corollary}
Let $p_0,p_1$ be differentiable idempotents such that $p_0p_1 = 0 = p_1p_0$. Then
\begin{enumerate}
\item $p_1p_0'p_0 = -p_1p_1'p_0$;
\item $p_1p_0'p_1 = 0$;
\item $p_1(p_0')^2p_1 = p_1p_1'p_0p_1'p_1$;
\item $p_0(p_0')^2p_1 = 0$;
\item $p_1p^{\prime\prime}_0p_1 = 2p_1(p_0')^2p_1$.
\end{enumerate}
If in addition $p_2$ is a differentiable idempotent such that $p_0p_2 = 0 p_2p_0$ and $p_1p_2 = 0 p_2p_1$, then
\begin{enumerate} \setcounter{enumi}{5}
\item $p_1p_0'p_2 = 0$.
\end{enumerate}
\end{corollary}
\begin{proof}
(1) We have
\[ p_1p_0'p_0 = p_1(p_1p_0')p_0 = -p_1(p_1'p_0)p_0 = -p_1p_1'p_0. \]

(2) We have $p_1p_0'p_1 = -(p_1'p_0)p_1 = -p_1'(p_0p_1) = 0$.

(3) We have $p_1(p_0')^2p_1 = (p_1p_1p_0')(p_0'p_1p_1) = (p_1p_1'p_0)(p_0p_1'p_1)$.

(4) We have $p_0(p_0')^2p_1 = (p_0p_0')(p_0'p_1) = -(p_0p_0')(p_0p_1') = -(p_0p_0'p_0)p_1' = 0$.

(5) We have, using \ref{derivativeIdempotent}, $p_1p^{\prime\prime}_0p_1 = p_1(2(p'_0)^2 + p_0p_0^{\prime\prime} + p_0^{\prime\prime}p_0)p_1 = 2p_1(p_0')^2p_1$.

(6) We have $(p_1p_0')p_2 = - (p_1'p_0)p_2 = - p_1'(p_0p_2) = 0$.
\end{proof}
\begin{corollary} \label{derivativeIdempotentOffDiagonal}
Let $p_0,p_1$ be differentiable idempotents such that $p_0p_1 = 0 = p_1p_0$ and $p_0 + p_1 = 1$. Then
\begin{enumerate}
\item $p_0' = p_0p_0'p_1 + p_1p_0'p_0$;
\item $p_0p_0' = p_0'p_1$ and $p_0'p_0 = p_1p_0'$.
\end{enumerate}
\end{corollary}
\begin{proof}
(1) We have
\[ p_0' = (p_0 + p_1)p_0'(p_0 + p_1) = \cancel{p_0p_0'p_0} + p_0p_0'p_1 + p_1p_0'p_0 + \cancel{p_1p_0'p_1}. \]

(2) We have, using point (1),
\[ p_0p_0' = p_0(p_0p_0'p_1) + p_0(p_1p_0'p_0) = p_0p_0'p_1 = (p_0p_0'p_1)p_1 + (p_1p_0'p_0)p_1 = p_0'p_1. \]
The other equation is similar.
\end{proof}


\begin{proposition}
Let $A$ be a convergence algebra and $a: U\subseteq\C \to A$.

If $a$ is differentiable and $a(t)^{-1}$ exists for all $t\in \R$, then
\[ \od{a^{-1}}{t} = -a^{-1}a'a^{-1}. \]
\end{proposition}
\begin{proof}
We have
\begin{align*}
\od{}{t}a^{-1} &= \lim_{h\to 0}\frac{a(t+h)^{-1} - a(t)^{-1}}{h} \\
&= \lim_{h\to 0} -\frac{a(t)^{-1}a(t+h)a(t+h)^{-1} - a(t)^{-1}a(t)a(t+h)^{-1}}{h} \\
&= \lim_{h\to 0} -\frac{a(t)^{-1}\Big(a(t+h) - a(t)\Big)a(t+h)^{-1}}{h} \\
&= -a(t)^{-1}\left(\lim_{h\to 0}\frac{\big(a(t+h) - a(t)\big)a(t+h)^{-1}}{h}\right)\Big(\lim_{h\to 0}a(t+h)^{-1}\Big) \\
&= -a(t)^{-1}a'a^{-1}.
\end{align*}
\end{proof}

\section{Analytic functions}
TODO: multiindex notation
\begin{definition}
Let $M$ be a convergence module over a ring $R$ and $n\in\N$. A function $f: R^n\to M$ is called \udef{analytic} if
\[ f(x) = \sum_{I\in\N^n}c_I(x-x_0)^I \]
where $c_I\in M^n$ and $x_0\in R^n$.
\end{definition}

\subsection{Taylor expansion}
Radius of convergence

\subsection{Properties of analytic functions}
\begin{proposition}
Let $f$ be an analytic function. Then
\begin{enumerate}
\item $f$ is continuous;
\item $f$ is differentiable.
\end{enumerate}
\end{proposition}

\section{Classification of spaces}
\begin{definition}
Let $X,Y$ be subsets of normed vector spaces and $X$ be open. We call a function $f: X\to Y$
\begin{itemize}
\item \udef{smooth} at $x_0\in V$ if all derivatives of $f$ at $x_0$ exist;
\item \udef{analytic} at $x_0\in V$ if the Taylor series of $f$ at $x_0$ exists and has non-zero radius of convergence.
\end{itemize}
\end{definition}
\begin{lemma}
Let $f: X\to Y$ be a smooth function. Then all derivatives are continuous.
\end{lemma}

\begin{definition}
Let $X,Y$ be subsets of normed vector spaces and $X$ be open.
\begin{itemize}
\item $\cont^r(X,Y)$ is the space of functions in $(X \to Y)$ whose first $r$ derivatives exist and are continuous;
\item $\cont^\infty(X,Y)$ is the space of functions in $(X \to Y)$ that are smooth at all points in $X$;
\item $\cont^\omega(X,Y)$ is the space of functions in $(X \to Y)$ that are analytic at all points in $X$.
\end{itemize}
If $Y = \C$, we write $\cont^r(X), \cont^\infty(X)$ and $\cont^\omega(X)$. We can also use subscripts $_0$ and $_c$ to denote the extra conditions of vanishing at infinity and having compact support.
\end{definition}



\chapter{Non-standard analysis}
\url{http://www.lightandmatter.com/calc/}

\begin{proposition}
Let $f:\R\to\R$ be a real function. Then $f$ is continuous at $x\in\R$ \textup{if and only if} for all infinitesimal $\delta$ there exists an infinitesimal $\epsilon$ such that
\[ f(x+\delta) = f(x) + \epsilon. \]
Alternatively we can state this as
\[ f(x+\delta) \approx f(x) \]
for all infinitesimal $\delta$.
\end{proposition}

Clearly continuity is a requirement for differentiability: if $f(x+\delta) - f(x)$ is not infinitesimal, then $\frac{f(x+\delta) - f(x)}{\delta}$ will not be finite.

\begin{lemma} \label{chainLemma}
Let $f:\R\to\R$ be a real function and $y:\R\to\R$ a continuous function. Assume $f$ differentiable at $y_0\in\im(y)$. Consider $f$ as depending on $y$ and $y$ as depending on $x$. Then
\[ \left.\dod{f}{y}\right|_{y_0} = \st\left(\frac{\Delta_y f}{\Delta y}\right) = \st\left(\frac{\Delta_x f\circ y}{\Delta_x y}\right). \]
\end{lemma}
\begin{proof}
We calculate, setting $y_0 = y(x_0)$ and using continuity of $y$,
\begin{align*}
\st\left(\frac{\Delta_x f\circ y}{\Delta_x y}\right) &= \st\left(\frac{f(y(x_0+\Delta x)) -f(y(x_0))}{y(x_0+\Delta x) - y(x_0)}\right) = \st\left(\frac{f(y(x_0)+\delta) -f(y(x_0))}{y(x_0)+\delta - y(x_0)}\right) \\
&= \st\left(\frac{f(y(x_0)+\delta) -f(y(x_0))}{\delta}\right) = \left.\dod{f}{y}\right|_{y_0}.
\end{align*}
\end{proof}

\begin{proposition}[Chain rule]
Let $y,f$ be real functions, differentiable at points $x_0$ and $y_0=y(x_0)$, respectively. Then
\[ \left.\dod{f}{y}\right|_{y_0} \left.\dod{y}{x}\right|_{x_0} = \left.\dod{f\circ y}{x}\right|_{x_0}. \]
\end{proposition}
\begin{proof}
We calculate, using \ref{chainLemma},
\[ \left.\dod{f}{y}\right|_{y_0} \left.\dod{y}{x}\right|_{x_0} = \st\left(\frac{\Delta_y f}{\Delta y}\frac{\Delta_x y}{\Delta x}\right) = \st\left(\frac{\Delta_x f\circ y}{\Delta_x y}\frac{\Delta_x y}{\Delta x}\right) = \st\left(\frac{\Delta_x f\circ y}{\Delta x}\right) = \left.\dod{f\circ y}{x}\right|_{x_0}. \]
\end{proof}

\chapter{Series and sequences}
\input{series}

\chapter{Real functions}
\input{realFunctions}
\section{Transformations}
TODO + transforming the graph (translation x/y, scaling x/y)


\chapter{Measure theory}
TODO (bounded) finitely additive signed measures form Riesz spaces.

\section{Measurable spaces and measurable functions}
\begin{definition}
Let $\Omega$ be a non-empty set and $\mathcal{A}$ a $\sigma$-algebra on $\Omega$.

The pair $(\Omega, \mathcal{A})$ is called a \udef{measurable space}.

The elements of $\mathcal{A}$ are called \udef{events}.
\end{definition}


\subsection{Properties of measure spaces}
\subsubsection{Separated measure spaces}
\begin{definition}
Let $\sSet{\Omega,\mathcal{A}}$ be a measurable space and $x,y\in \Omega$. Then $x,y$ are called \udef{separated} or \udef{distinguishable} if there exists $A\in \mathcal{A}$ such that $x\in A$ and $y\notin A$.

The measurable space $\sSet{\Omega,\mathcal{A}}$ is called \udef{separated} if all distinct $x,y\in \Omega$ are separated.
\end{definition}

\begin{lemma}
The relation that relates indistinguishable points is an equivalence relation.

This relation is the identity relation \textup{if and only if} the measurable space is separated.
\end{lemma}

\subsection{Measurable functions}
\begin{definition}
Let $(\Omega_1, \mathcal{A}_1)$ and $(\Omega_2, \mathcal{A}_2)$ be measurable spaces.

A function $f:\Omega_1 \to \Omega_2$ is called \udef{measurable} if
\[ \forall E\in\mathcal{A}_2: f^{\preimf}(E) \in\mathcal{A}_1. \]
We may also say $f$ is \udef{$\mathcal{A}_1/\mathcal{A}_2$-measurable} to emphasise which $\sigma$-algebras are being used.

We denote the set of $\mathcal{A}_1/\mathcal{A}_2$-measurable functions by $\meas(\mathcal{A}_1, \mathcal{A}_2)$, or by $\meas(\Omega_1, \Omega_2)$ if the $\sigma$-algebras are clear from context.
\end{definition}
Suppose we are moving around in $\Omega_1$ and tracking the output of the function in $\Omega_2$. We would like to be able to explore the contents of an event in $\Omega_2$ from within an event in $\Omega_1$.

\begin{lemma} \label{measurableFromGeneratingSet}
Let $(\Omega_1, \mathcal{A}_1)$ and $(\Omega_2, \mathcal{A}_2)$ be measurable spaces and $\mathcal{A}_2$ is generated by $\mathcal{S}$.

Then $f: \Omega_1\to \Omega_2$ is measurable \textup{if and only if} $\forall S\in\mathcal{S}: f^{-1}[S] \in \mathcal{A}_1$.
\end{lemma}

\begin{lemma} \label{constantFunctionsMeasurable}
Any constant function $\underline{a}: \sSet{\Omega_1,\mathcal{A}_1} \to \sSet{\Omega_2,\mathcal{A}_2}: x\mapsto a$ is measurable.
\end{lemma}
\begin{proof}
For any $A\in\mathcal{A}_2$ we have
\[ \underline{a}^{\preimf}(A) = \begin{cases}
\emptyset & (a\notin A) \\
\Omega_1 & (a\in A).
\end{cases} \]
In both cases $\underline{a}^{\preimf}(A)\in\mathcal{A}_1$.
\end{proof}

\begin{lemma} \label{measurabilityCodomainPartition}
Let $(\Omega_1, \mathcal{A}_1)$, $(\Omega_2, \mathcal{A}_2)$ be measurable spaces, $f: \Omega_1 \to \Omega_2$ a function and $B\in \mathcal{A}_2$.

Then $f$ is measurable \textup{if and only if} both $f|^B$ and $f|^{B^c}$ are measurable.
\end{lemma}
\begin{proof}
For the direction $\Rightarrow$, let $\iota_1: f^\preimf(B)\to \Omega_2$ and $\iota_2: f^\preimf(B)^c\to \Omega_2$ be the inclusion functions, which are measurable by definition of sub-measurable space. Then $f|^B = f\circ \iota_1$ and $f|^{B^c} = f\circ \iota_2$ are measurable.

For the other direction, take $A\in \mathcal{A}_2$. Then
\[ f^{\preimf}(A) = f^\preimf(A\cap B) \cup f^\preimf(A\cap B^c) = (f|^B)^\preimf(A\cap B) \cup (f|^{B^c})^\preimf(A\cap B^c) \in \mathcal{A}_1, \]
so $f$ is measurable.
\end{proof}

\subsubsection{$\sigma$-algebras generated by functions}
\begin{definition}
Let $\Omega_1$ be a set and $\sSet{\Omega_2, \mathcal{A}}$ a measurable space. Let $f: \Omega_1\to \Omega_2$ be a function. The \udef{pull-back $\sigma$-algebra} or the $\sigma$-algebra \udef{generated} by $f$ is
\[ \sigma(f) \defeq \setbuilder{f^{-1}[A]}{A\in \mathcal{A}}. \]
\end{definition}

The pull-back $\sigma$-algebra is a $\sigma$-algebra.

\begin{lemma}
Let $(\Omega_1, \mathcal{A}_1)$ and $(\Omega_2, \mathcal{A}_2)$ be measurable spaces and $f: \Omega_1\to \Omega_2$ a function. Then $f$ is $\mathcal{A}_1/\mathcal{A}_2$-measurable \textup{if and only if} $\sigma(f) \subseteq \mathcal{A}_1$.
\end{lemma}

\begin{lemma}
Let $\Omega_1$ be a set, $\sSet{\Omega_2, \mathcal{A}}$ a measurable space and $f: \Omega_1\to \Omega_2$ a function. Then $x,y\in \sSet{\Omega_1,\sigma(f)}$ are indistinguishable \textup{if and only if} $f(x), f(y) \in \sSet{\Omega_2,\mathcal{A}}$ are indistinguishable.
\end{lemma}
\begin{proof}
TODO For all $A\in\mathcal{A}$, we have $f(x)\in A \iff x\in f^{-1}[A]$ and $y\in f^{-1}[A]\iff f(y)\in A$. The indistinguishability of $x,y$ means the left-hand sides are equivalent. The indistinguishability of $f(x),f(y)$ means the right-hand sides are equivalent.
\end{proof}
\begin{corollary}
Let $\Omega_1$ be a set, $\sSet{\Omega_2, \mathcal{A}}$ a measurable space and $f: \Omega_1\to \Omega_2$ a function. Then
\begin{enumerate}
\item $\ker(f)$ is a subset of the indistinguishability relation of $\sigma(f)$;
\item if $\sSet{\Omega_2, \mathcal{A}}$ is separated, then $ker(f)$ equals the indistinguishability relation of $\sigma(f)$.
\end{enumerate}
\end{corollary}


\subsubsection{The Doob-Dynkin property}
\begin{definition}
A measurable set $\sSet{\Omega,\mathcal{A}}$ is said to have the \udef{Doob-Dynkin property} if for any set $\Omega_1$, measurable space $\sSet{\Omega_2,\mathcal{A}_2}$ and function $f: \Omega_1 \to \Omega_2$, a function $g: \Omega_1\to \Omega$ is $\sigma\{f\}/\mathcal{A}$-measurable \textup{if and only if} it factors through $f$, i.e.
\[\exists h\in \meas(\mathcal{A}_2\to \mathcal{A}):\quad g = h\circ f. \]
\end{definition}

\begin{example}
The measurable space $\sSet{\Omega, \mathcal{A}} = \sSet{\{0,1\}, \{\emptyset,\Omega\}}$ does not have the Doob-Dynkin property. 

Take, for example, any sets $\Omega_1, \Omega_2$ and equip $\Omega_2$ with the $\sigma$-algebra $\{\emptyset, \Omega_2\}$. Then for any function $f:\Omega_1 \to \Omega_2$, we have $\sigma(f) = \{\emptyset, \Omega_1\}$ and thus any function $g: \Omega_1 \to \Omega$ is measurable. Clearly it is not true that any function between arbitrary sets factors through any other function.
\end{example}


\begin{proposition}
A measurable set $\sSet{\Omega,\mathcal{A}}$ has the Doob-Dynkin property \textup{if and only if} $\mathcal{A}$ is
\begin{itemize}
\item separated; and
\item for any measurable space $\sSet{\Omega_1,\mathcal{A}_1}$, subset $D\subseteq \Omega_1$ and measurable function $f: \sSet{D,\mathcal{A}_1|_D} \to \sSet{\Omega,\mathcal{A}}$, $f$ can be extended to a measurable function on $\sSet{\Omega_1,\mathcal{A}_1}$.
\end{itemize}
\end{proposition}
\begin{proof}
TODO {functionsLeftRightRelations}

\url{http://www.numdam.org/article/SPS_1990__24__46_0.pdf}
\url{https://mathoverflow.net/questions/263863/does-the-doob-dynkin-lemma-hold-for-any-measurable-space-that-separates-points}

\url{https://math.stackexchange.com/questions/2193181/proof-of-doob-dynkin-lemma-when-x-isnt-assumed-surjective}
\end{proof}


\subsection{Borel $\sigma$-algebras}
\begin{definition}
Let $(X,\mathcal{T})$ be a topological space. The $\sigma$-algebra on $X$ generated by $\mathcal{T}$ is called the \udef{Borel $\sigma$-algebra} of $(X,\mathcal{T})$. The measurable space consisting of $X$ equipped with the Borel $\sigma$-algebra is called the \udef{Borel-measurable space}.
\end{definition}
Clearly the Borel $\sigma$-algebra is also generated by the closed sets.

\begin{lemma}
Let $(X,\mathcal{T})$ be a topological space. If $\mathcal{T}$ has a countable basis $\mathcal{B}$, then the Borel $\sigma$-algebra is generated by the basis $\mathcal{B}$.
\end{lemma}

TODO:
\begin{align*}
\mu(B) &= \sup\setbuilder{\mu(C)}{C\subseteq B, \; \text{$C$ compact}} \\
&= \inf\setbuilder{\mu(O)}{B\subseteq O, \; \text{$O$ open}}.
\end{align*}
cfr compact open topology??

\begin{lemma}
Every continuous function between topological spaces is a measurable function between Borel-measurable spaces.
\end{lemma}

\begin{proposition} \label{pointWiseConvergenceMeasurable}
Let $(\Omega,\mathcal{A})$ be a measurable space and $\sSet{X,\xi}$ a $T_1$ and $C_2$ topological space. We equip $X$ with its Borel $\sigma$-algebra $\mathcal{B}$.

Suppose that a sequence of measurable functions $f_n : \Omega \to Y$ converges pointwise to a function $f:\Omega\to X$. Then $f$ is measurable.
\end{proposition}
\begin{proof}
Pick arbitrary $B\in \mathcal{B}$. By \ref{AnySetCountableIntersectionOfOpenSets} we can write $B = \bigcap_{k\in\N}O_k$ for some sequence $\seq{O_k}$ of open sets. Then we have, using the fact that $\sSet{X,\xi}$ is a sequntial space (TODO ref),
\begin{align*}
x\in f^{\preimf}[B] &\iff f(x)\in B \\
&\iff \forall k\in\N: f(x)\in O_k\\
&\iff \forall k\in\N: \exists n_0\in\N: \forall n\geq n_0: f_n(x)\in O_k \\
&\iff \forall k\in\N: \exists n_0\in\N: \forall n\geq n_0: x\in f^{\preimf}_n[O_k] \\
&\iff x\in \bigcap_{k\in\N}\bigcup_{n_0\in\N}\bigcap_{n\geq n_0}f^{\preimf}_n[O_k].
\end{align*}
So $f^{\preimf}[B] = \bigcap_{k\in\N}\bigcup_{n_0\in\N}\bigcap_{n\geq n_0}f^{\preimf}_n[O_k]$, which is an element of $\mathcal{A}$ because all $f^{\preimf}_n[O_k]$ are in $\mathcal{A}$.
\end{proof}

\url{https://math.stackexchange.com/questions/1343860/limit-of-measurable-functions-is-measurable}


\subsubsection{Measurable real-valued functions}
Unless stated otherwise we always consider the real numbers equipped with the Borel $\sigma$-algebra.

\begin{proposition}[Doob-Dynkin lemma]
TODO: $[0,1]$ and $[-\infty,\infty]$ have the Doob-Dynkin property.
\end{proposition}

\begin{proposition}
Let $\mathcal{B}$ be the Borel $\sigma$-algebra on $\overline{\R}$. Then the following equalities hold for any $b\in\overline{\R}$:
\begin{align*}
\mathcal{B} &= \sigma\setbuilder{\interval[c]{a,b}}{a\in \overline{\R}}\\
&= \sigma\setbuilder{\interval[o]{a,b}}{a\in \overline{\R}} \\
&= \sigma\setbuilder{\interval[oc]{a,b}}{a\in \overline{\R}} \\
&= \sigma\setbuilder{\interval[co]{a,b}}{a\in \overline{\R}}.
\end{align*}
\end{proposition}
\begin{proof}
TODO
\end{proof}
\begin{corollary} \label{measurablesSetsRealMeasurableFunction}
Let $\sSet{\Omega, \mathcal{A}}$ be a measurable space and $f: \Omega \to \overline{\R}$ a function. Then the following are equivalent:
\begin{enumerate}
\item $f$ is measurable;
\item $\setbuilder{\{f\geq a\}\big.}{a\in\R} \subseteq \mathcal{A}$;
\item $\setbuilder{\{f > a\}\big.}{a\in\R} \subseteq \mathcal{A}$;
\item $\setbuilder{\{f \leq a\}\big.}{a\in\R} \subseteq \mathcal{A}$;
\item $\setbuilder{\{f < a\}\big.}{a\in\R} \subseteq \mathcal{A}$.
\end{enumerate}
\end{corollary}

\begin{proposition} \label{measurablesSetsTwoRealMeasurableFunctions}
Let $\sSet{\Omega, \mathcal{A}}$ be a measurable space and $f,g: \Omega \to \overline{\R}$ measurable functions. Then
\begin{enumerate}
\item $\{f < g\} \in \mathcal{A}$;
\item $\{f \leq g\} \in \mathcal{A}$;
\item $\{f = g\} \in \mathcal{A}$;
\item $\{f \neq g\} \in \mathcal{A}$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) This follows from \ref{measurablesSetsRealMeasurableFunction} and
\[ \{f < g \} = \bigcup_{r\in\Q}\{f<r\}\cap \{r < g\}. \]

(2) Complement of (1).

(3) From $\{f = g\} = \{f \leq g\}\cap \{g \leq f\}$.

(4) Complement of (3).
\end{proof}

\begin{proposition} \label{operationsOnRealMeasurableFunctions}
Let $\sSet{\Omega, \mathcal{A}}$ be a measurable space and $f,g: \Omega \to \overline{\R}$ measurable functions and $a,b\in \overline{\R}$. Then
\begin{enumerate}
\item $f+g$ is measurable;
\item $f\cdot g$ is measurable.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) For all $a\in\R$, we have $\{f + g \geq a\} = \{f \geq a - g\}$. The right-hand side is in $\mathcal{A}$ for all $a\in R$ by \ref{measurablesSetsTwoRealMeasurableFunctions}. The inclusion of the left-hand side in $\mathcal{A}$ proves the measurability of $f+g$ by \ref{measurablesSetsRealMeasurableFunction}.

(2) We use \ref{measurabilityCodomainPartition} to show measurability by partitioning the codomain of $f\cdot g$ into $\{-\infty, 0, +\infty\}$ and $\R\setminus\{0\}$.
For the former restriction, we have
\begin{align*}
(f\cdot g)^\preimf(\{+\infty\}) = \big(\{f = +\infty\}\cap \{g > 0\}\big) &\cup \big(\{f > 0\} \cap \{g = +\infty\}\big) \\ &\cup \big(\{f = -\infty\}\cap \{g < 0\}\big) \\ &\cup \big(\{f < 0\} \cap \{g = -\infty\}\big),
\end{align*}
so $(f\cdot g)^\preimf(\{+\infty\})\in\mathcal{A}$. Similarly $(f\cdot g)^\preimf(\{-\infty\})\in\mathcal{A}$ and $(f\cdot g)^\preimf(\{0\})\in\mathcal{A}$.

Now consider the latter restriction. We can write $(f\cdot g)|^{\R\setminus\{0\}}$ as $f'\cdot g'$, where $f'$ and $g'$ take only finite and non-zero values.

From point (1) and the equality
\[ f'\cdot g' = \frac{1}{4}(f'+g')^2 - \frac{1}{4}(f'-g')^2, \]
the measurability of $f'\times g'$ follows if we can show the measurability of $h^2$ and $-h$, given a measurable $h:\Omega \to \R$.

To show measurability of $h^2$, take arbitrary $a\in\R$. Then
\[ \{h^2 \geq a\} = \begin{cases}
\Omega & (a < 0) \\
\{h \geq \sqrt{a}\} \cup \{h \leq -\sqrt{a}\} & (a \geq 0)
\end{cases}, \]
so $\{h^2 \geq a\} \in \mathcal{A}$ and $h^2$ is measurable by \ref{measurablesSetsRealMeasurableFunction}.

To show measurability of $-h$, take arbitrary $a\in\R$. Then
\[ \{ -g \geq a \} = \{g \leq -a\} \in \mathcal{A}, \]
so $-g$ is measurable by \ref{measurablesSetsRealMeasurableFunction}.
\end{proof}
\begin{corollary}
The function $af+bg$ is measurable for all $a,b\in\overline{\R}$.
\end{corollary}
\begin{proof}
Constant functions are always measurable, by \ref{constantFunctionsMeasurable}, and $af + bg = \underline{a}f + \underline{b}g$, which is measurable by the proposition.
\end{proof}

\begin{proposition} \label{limitOperationsOnRealMeasurableFunctions}
Let $\sSet{\Omega, \mathcal{A}}$ be a measurable space and $\seq{f_n: \Omega \to \overline{\R}}_{n\in\N}$ a sequence measurable functions. Then
\begin{enumerate}
\item $\inf_{n\in\N}f_n$ is measurable;
\item $\sup_{n\in\N}f_n$ is measurable;
\item $\liminf_{n\in\N}f_n$ is measurable;
\item $\limsup_{n\in\N}f_n$ is measurable.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Take arbitrary $a\in\R$. Then
\[ \{\inf_{n\in\N}f_n \geq a\} = \bigcap_{n\in\N}\{f_n \geq a\}, \]
so $\{\inf_{n\in\N}f_n \geq a\} \in \mathcal{A}$ and thus $\inf_{n\in\N}f_n$ is measurable by \ref{measurablesSetsRealMeasurableFunction}.

(2) We have $\sup_{n\in\N}f_n = -\inf_{n\in\N}(-f_n)$, so the result follows from \ref{operationsOnRealMeasurableFunctions} and point (1).

(3) We have $\liminf_{n\in\N}f_n = \sup_{n\in\N} \inf_{m\geq n}f_m$.

(4) We have $\limsup_{n\in\N}f_n = \inf_{n\in\N} \sup_{m\geq n}f_m$.
\end{proof}
\begin{corollary}
If $\seq{f_n}\to f$ pointwise, then $f$ is measurable.
\end{corollary}
\begin{proof}
We have $\lim_{n\in\N}f_n = \limsup_{n\in\N}f_n$.
\end{proof}
This corollary is a special case of \ref{pointWiseConvergenceMeasurable}.
\begin{corollary} \label{infiniteSumMeasurable}
Let $\sSet{\Omega, \mathcal{A}}$ be a measurable space and $\seq{f_n: \Omega \to \overline{\R}}_{n\in\N}$ a sequence measurable functions such that $\sum_{n\in\N}f_n$ converges everywhere. Then $\sum_{n\in\N}f_n$ is measurable.
\end{corollary}

\subsubsection{Measurable complex-valued functions}
\begin{proposition}
Let $\sSet{\Omega,\mathcal{A}}$ be a measurable space. Then $\meas(\Omega, \R)$ is a complex vector space.
\end{proposition}
\begin{proof}
TODO. Cfr. \ref{operationsOnRealMeasurableFunctions}.
\end{proof}


\section{Measures and generalisations}
\subsection{Contents}
\begin{definition}
Let $\mathcal{S}$ be a semi-ring on a set $\Omega$ and $\sSet{M,+,0}$ a commutative monoid. An $M$-valued \udef{content} on $\mathcal{S}$ is a map $\mu: \mathcal{S} \to M$ satisfying
\begin{itemize}
\item $\mu(\emptyset) = 0$;
\item $\mu$ is \udef{(finitely) additive}: let $\seq{A_n}_{n=0}^k\in \mathcal{S}^*$ be a string of pairwise disjoint sets such that $A_0 \uplus \ldots \uplus A_{k} \in \mathcal{S}$, then
\[ \mu(A_0 \uplus \ldots \uplus A_{k}) = \mu(A_0) + \ldots + \mu(A_{k}). \]
\end{itemize}
If $M = \overline{\R^+}$, then we call the content \udef{positive}. A positive measure is called \udef{finite} if $\im(\mu) \subseteq \R^+$.
\end{definition}
Note that $\emptyset\in \mathcal{S}$ by \ref{emptysetElementSemiring}.

\begin{lemma}
If $\mathcal{S}$ is a ring and $\mu$ a content on $\mathcal{S}$, then finite additivity is implied by
\[ \forall A\perp B\in \mathcal{S}:\qquad \mu(A\uplus B) = \mu(A) + \mu(B). \]
\end{lemma}

\begin{example}
For semirings finite additivity is not implied by binary additivity. Take the semiring
\[ \mathcal{S} = \big\{\emptyset,\; \{1\},\; \{2\},\; \{3\},\; \{1,2,3\}\big\} \]
and consider the content
\[ \mu(\emptyset) = 0,\quad \mu\{1\} = 1, \quad \mu\{2\} = 1, \quad \mu\{3\} = 1, \quad \mu\{1,2,3\} = 0. \]
This satisfies binary additivity, but not finite additivity.
\end{example}

\begin{lemma} \label{contentsOnSemiRingToRing}
Let $\mathcal{S}$ be a semi-ring on $\Omega$. Every content $\mu_\mathcal{S}$ on $\mathcal{S}$ extends uniquely to a content $\mu$ on $\mathfrak{R}\{\mathcal{S}\}$, the ring generated by $\mathcal{S}$.
\end{lemma}
\begin{proof}
The extension of $\mathcal{S}$ to $\mathfrak{R}\{\mathcal{S}\}$ is exactly the closure under disjoint unions, see \ref{ringFromSemiRing}. We extend $\mu$ to this closure by defining
\[ \mu(A\uplus B) = \mu(A) + \mu(B) \]
for all disjoint $A,B\in \mathfrak{R}\{\mathcal{S}\}$. 

Now both $A$ and $B$ are finite disjoint unions of sets in $\mathcal{S}$ and thus so is $A\uplus B$. If $A\uplus B \in \mathcal{S}$, then the extension corresponds to the original definition by finite additivity.
\end{proof}

\begin{lemma} \label{emptysetNullset}
If there exists an $A\in \mathcal{S}$ such that $\mu(A)$ is cancellative, then the requirement $\mu(\emptyset) = 0$ is redundant.
\end{lemma}
\begin{proof}
We calculate $\mu(A) = \mu(A \uplus \emptyset) = \mu(A) + \mu(\emptyset)$, so $\mu(\emptyset) = 0$.
\end{proof}
For positive contents this is requirement is $\mu(A) < \infty$.

\begin{proposition} \label{semiringPositiveContent}
Let $\mathcal{S}$ be a semi-ring on a set $\Omega$, $\mu$ a positive content and $A,B\in \mathcal{S}$. Then
\begin{enumerate}
\item $A\subseteq B$ implies $\mu(A) \leq \mu(B)$;
\item $A\cup B\in\mathcal{S}$ implies $\mu(A \cup B) \leq \mu(A) + \mu(B)$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Because $\mathcal{S}$ is a semi-ring, we can write $B = A \uplus (B\setminus A) = A \uplus (C_0 \uplus \ldots \uplus C_k)$ for some $C_0,\ldots, C_k\in\mathcal{S}$. By finite additivity, we have
\[ \mu(B) = \mu(A) + \mu(C_0) + \ldots + \mu(C_k). \]
As $\mu(C_0) + \ldots + \mu(C_k)$ is positive, we have $\mu(A) \leq \mu(B)$.

(2) We can write $A\cup B = (A\setminus B) \uplus (A\cap B) \uplus (B\setminus A)$. Because $\mathcal{S}$ is a semi-ring, we can write $A\setminus B = C_0 \uplus \ldots \uplus C_k$ and $B\setminus A = D_0 \uplus \ldots \uplus D_l$ for some $C_0,\ldots, C_k, D_0,\ldots, D_l\in\mathcal{S}$. By finite additivity, we have
\begin{align*}
\mu(A\cup B) &= & \hspace{-5em} \mu(C_0) + \ldots + \mu(C_k) + &\mu(A\cap B) + \mu(D_0) + \ldots + \mu(D_l) \\
\mu(A) &= & \hspace{-5em} \mu(C_0) + \ldots + \mu(C_k) + &\mu(A\cap B) \\
\mu(B) &= & &\mu(A\cap B) + \mu(D_0) + \ldots + \mu(D_l).
\end{align*}
Thus
\[ \mu(A)+\mu(B) = \mu(C_0) + \ldots + \mu(C_k) + 2\mu(A\cap B) + \mu(D_0) + \ldots + \mu(D_l). \]
As $\mu(A\cap B)$ is positive, we have $\mu(A\cup B) \leq \mu(A)+\mu(B)$.
\end{proof}

\begin{proposition} \label{ringPositiveContent}
Let $\mathcal{S}$ be a \emph{ring} on a set $\Omega$, $\mu$ a positive content and $A,B\in \mathcal{S}$. Then
\begin{enumerate}
\item $A\subseteq B$ and $\mu(A)<\infty$ implies $\mu(B\setminus A) = \mu(B) - \mu(A)$;
\item $\mu(A \cup B) + \mu(A\cap B) = \mu(A) + \mu(B)$;
\item let $\seq{A_n}_{n\in \N}$ be a sequence of disjoint sets in $\mathcal{S}$ such that $\biguplus_{n\in\N}A_n \in \mathcal{S}$, then
\[ \mu\Big(\biguplus_{n\in\N}A_n\Big) \geq \sum_{n\in\N}\mu(A_n). \]
\end{enumerate}
\end{proposition}
\begin{proof}
(1) As $\mathcal{S}$ is a ring, we have $B\setminus A\in\mathcal{S}$. The result follows from rearranging $\mu(B) = \mu\big((B\setminus A) \uplus A\big) = \mu(B\setminus A) + \mu(A)$.

(2) We calculate
\begin{align*}
\mu(A \cup B) + \mu(A\cap B) &= \mu\big((A\setminus B)\uplus (A\cap B) \uplus (B\setminus A)\big) + \mu(A\cap B) \\
&= \mu(A\setminus B) + \mu(A\cap B) + \mu(B\setminus A) + \mu(A\cap B) \\
&= \mu\big((A\setminus B) \uplus (A\cap B)\big) + \mu\big((B\setminus A) \uplus \mu(A\cap B)\big) \\
&= \mu(A) + \mu(B).
\end{align*}

(3) Consider the sequence
\[ \seq{\mu\Big(\biguplus_{n=0}^k A_n\Big)}_{k\in \N} = \enspace \seq{\sum_{n=0}^k\mu(A_n)}_{k\in\N}. \]
This sequence is increasing, so its limit is the supremum of its terms. Thus
\[ \sum_{n\in\N}\mu(A_n) = \sup_{k\in\N}\mu\Big(\biguplus_{n=0}^k A_n\Big) \leq \mu\Big(\biguplus_{n\in\N}A_n\Big). \]
The last inequality follows straight from monotonicity \ref{semiringPositiveContent} and the fact that the supremum preserves the inequality.
\end{proof}

\subsubsection{Null sets}
\begin{definition}
Let $\mathcal{S}$ be a semi-ring on a set $\Omega$ and $\mu$ a positive content. A set $A\subseteq \Omega$ is called a \udef{null set} if there exists $B\in \mathcal{S}$ such that $A\subseteq B$ and $\mu(B) = 0$.

The content is called \udef{complete} if all null sets are elements of $\mathcal{S}$.
\end{definition}
If $A\in\mathcal{S}$ is a null set, then $\mu(A) \leq \mu(B) = 0$, so $\mu(A) = 0$.

\begin{lemma} \label{measureNullSet}
Let $\mu$ be a positive content on a semi-ring $\mathcal{S}$. If $A\in \mathcal{S}$ is a null set, then $\mu(A) = 0$.
\end{lemma}
\begin{proof}
By definition there exists $B\in\mathcal{S}$ such that $A\subseteq B$ and $\mu(B) = 0$. By monotonicity $0 = \mu(B)\geq \mu(A) \geq 0$, so $\mu(A) = 0$.
\end{proof}

\begin{definition}
Let $\mu$ be a positive content on a semi-ring with universe $\Omega$.

A proposition $P(x)$ referencing some $x\in\Omega$ is said to be true \udef{almost everywhere} (or a.e.) if $\setbuilder{x\in\Omega}{\text{$P(x)$ is false}}$ is a null set.
\end{definition}

\subsection{Pre-measures}
\begin{definition}
A \udef{pre-measure} is a content $\mu:\mathcal{S} \to M$ that is \udef{countably additive} or \udef{$\sigma$-additive}: let $\seq{A_n}$ be a sequence of pair-wise disjoint sets in $\mathcal{S}$ such that $\biguplus_{n\in \N}A_n \in \mathcal{S}$, then
\[ \mu\left(\biguplus_{n\in\N}A_n\right) = \sum_{n\in\N}\mu(A_n). \]
\end{definition}

\begin{example}
\begin{itemize}
\item For any non-empty set $\Omega$ define
\[ \mu: \powerset(\Omega)\to [0,\infty]: E\mapsto \begin{cases}
\#(E) & \text{($E$ is finite)} \\
\infty & \text{($E$ is infinite)}
\end{cases}. \]
Then $(\Omega, \powerset(\Omega),\mu)$ is a measure space and $\mu$ is called the \udef{counting measure}.
\item Let $(\Omega,\mathcal{A})$ be a measurable space and $x\in\Omega$ and define
\[ \delta_x: \mathcal{A}\to [0,\infty]: E\mapsto \begin{cases}
1 & (x\in E) \\ 0 & (x\notin E)
\end{cases}. \]
Then $(\Omega,\mathcal{A},\delta_x)$ is a measure space and $\delta_x$ is called a \udef{Dirac measure}.
\end{itemize}
\end{example}

\begin{lemma} \label{countingMeasureCriterion}
Let $\Omega$ be a set. A measure on $\powerset(\Omega)$ is the counting measure \textup{if and only if} $\mu(\{\omega\}) = 1$ for all $\omega\in\Omega$.
\end{lemma}
\begin{proof}
For any finite $A\subseteq \Omega$ we have $A = \biguplus_{a\in A}\{a\}$ and thus $\mu(A) = \#(A)$ be $\sigma$-additivity.

If $A\subseteq \Omega$ is infinite, take $k\in \N$. We can find a subset $B\subseteq A$ of cardinality $k$ and thus we can write $\mu(A) = \mu(B) + \mu(A\setminus B) \geq \mu(B) = k$. Thus $\mu(A) \geq k$ for all $k\in \N$, meaning $\mu(A)$ is infinite.
\end{proof}

\begin{proposition} \label{premeasureSubadditive}
Let $\mathcal{S}$ be a semi-ring and $\mu: \mathcal{S} \to \overline{\R^+}$ a pre-measure. Then for any sequence $\seq{A_n}_{n\in \N}$ of sets in $\mathcal{S}$ such that $\bigcup_{n\in\N}A_n \in \mathcal{S}$, we have
\[ \mu\Big(\bigcup_{n\in\N}A_n\Big) \leq \sum_{n\in\N}\mu(A_n). \]
\end{proposition}
\begin{proof}
Take a sequence $\seq{A_n}$ in $\mathcal{S}$ such that $\bigcup_{n\in\N}A_n\in\mathcal{S}$ and define
\[ A_n' \defeq A_n \setminus\bigg(\bigcup_{k=0}^{n-1}E_k\bigg), \]
which is a finite disjoint union of sets in $\mathcal{S}$. Consider the sequence $\seq{A^{\prime\prime}_n}_{n\in\N}$ which contains the disjoint components of each $A'_n$ in order. This is a disjoint sequence in $\mathcal{S}$ and $\bigcup_{n\in \N}A_n = \biguplus_{n\in \N}A_n^{\prime\prime}$.
Then
\[ \mu\Big(\bigcup_{n\in\N}A_n\Big) \;=\; \mu\Big(\biguplus_{n\in\N}A_n^{\prime\prime}\Big) \;=\; \sum_{n\in\N}\mu(A_n^{\prime\prime}) \;\leq\; \sum_{n\in\N}\mu(A_n). \]
The last inequality follows from \ref{semiringPositiveContent}.
\end{proof}

\begin{lemma} \label{premeasureSubadditivityEquivalences}
Let $\mathcal{S}$ be a ring and $\mu: \mathcal{S} \to \overline{\R^+}$ a content. Then the following are equivalent:
\begin{enumerate}
\item $\mu$ is a pre-measure;
\item for any sequence $\seq{A_n}_{n\in \N}$ of disjoint sets in $\mathcal{S}$ such that $\biguplus_{n\in\N}A_n \in \mathcal{S}$, we have
\[ \mu\Big(\biguplus_{n\in\N}A_n\Big) \leq \sum_{n\in\N}\mu(A_n); \]
\item for any sequence $\seq{A_n}_{n\in \N}$ of sets in $\mathcal{S}$ such that $\bigcup_{n\in\N}A_n \in \mathcal{S}$, we have
\[ \mu\Big(\bigcup_{n\in\N}A_n\Big) \leq \sum_{n\in\N}\mu(A_n). \]
\end{enumerate}
\end{lemma}
\begin{proof}
$(1) \Leftrightarrow (2)$ Immediate from \ref{ringPositiveContent}.

$(2) \Leftrightarrow (3)$ The direction $\Leftarrow$ is immediate. The other direction follows from \ref{premeasureSubadditive}.
\end{proof}

\begin{proposition}
Let $\mathcal{S}$ be a ring and $\mu$ a positive content. The following are equivalent:
\begin{enumerate}
\item $\mu$ is a pre-measure;
\item $\mu$ is $\sigma$-chain-continuous;
\end{enumerate}
and imply
\begin{enumerate} \setcounter{enumi}{2}
\item $\lim_{n\to\infty}\mu(A_n) = \mu(A)$ for all monotonically decreasing sequences $\seq{A_n}_{n\in\N}$ of sets in $\mathcal{S}$ such that $A = \bigcap_{n\in\N} A_n \in\mathcal{A}$ and $\mu(A_0) < \infty$.
\end{enumerate}
If $\mu$ is finite, then all statements are equivalent.
\end{proposition}
\begin{proof}
$(1) \Rightarrow (2)$ Let $\{A_n\}_{n\in\N}$ be a countable chain. Then $\{B_n\}_{n\in \N}$, where $B_n \defeq A_{n}\setminus A_{n-1}$ (and $B_0 = A_0$) is a pairwise disjoint sequence. Also $\bigcup_{n\in \N}A_n = \biguplus_{n\in \N} B_n$ and $A_n = \biguplus_{k=0}^n B_k$. Then
\begin{multline*}
\mu\Big(\bigcup_{n\in \N}A_n\Big) = \mu\Big(\biguplus_{n\in \N} B_n\Big) = \sum_{n\in\N}\mu(B_n) = \lim_{n\to\infty}\sum_{k=0}^n\mu(B_k) \\ = \lim_{n\to\infty}\mu\Big(\biguplus_{k=0}^n B_k\Big) = \lim_{n\to\infty}\mu(A_n) = \sup_{n\in\N}\mu(A_n).
\end{multline*}

$(1) \Leftarrow (2)$ Let $\{B_n\}_{n\in\N}$ be a countable pairwise disjoint set of subsets. Set $A_n = \biguplus_{k=0}^nB_k$. Then $\{A_n\}_{n\in\N}$ is a countable chain, $\biguplus_{n\in \N} B_n = \bigcup_{n\in \N}A_n$, so
\begin{multline*}
\mu\Big(\biguplus_{n\in\N}B_n\Big) = \mu\Big(\bigcup_{n\in\N}A_n\Big) = \sup_{n\in\N}\mu(A_n) = \lim_{n\in\N}\mu(A_n) \\ = \lim_{n\in\N}\mu(\biguplus_{k=0}^nB_n) = \lim_{n\to\infty}\sum_{k=0}^n\mu(B_n) = \sum_{n\in\N}\mu(B_n).
\end{multline*}

$(2) \Rightarrow (3)$ Let $\{C_n\}_{n\in\N}$ be a monotonically decreasing sequence with $\mu(C_0) < \infty$. Then $D_n \defeq C_0\setminus C_n$ is an increasing sequence. The result follows by \ref{ringPositiveContent} and continuity of the subtraction.

The equivalence in the case that $\mu$ is finite is also clear.
\end{proof}

\begin{example}
Let $\mu$ be a content on the finite-cofinite algebra of $\N$ such that
\[ \mu(A) = \begin{cases}
0 & (\text{$A$ is finite}) \\ \infty & (\text{$A$ is cofinite})
\end{cases}. \]
This is clearly not a premeasure, but does satisfy point (3) of the proposition.
\end{example}

\subsection{Measures}
\begin{definition}
A \udef{measure} is a pre-measure that is defined on a $\sigma$-algebra.

If $\mu$ is a measure on a $\sigma$-algebra $\mathcal{A}$with universe $\Omega$, then we call $\sSet{\Omega, \mathcal{A}, \mu}$ a \udef{measure space}. The measure space is called
\begin{itemize}
\item \udef{finite} if $\mu(\Omega) < \infty$;
\item \udef{$\sigma$-finite} if there exists a sequence $\seq{A_n}\in \mathcal{A}^\N$ such that $\Omega = \bigcup_{n\in\N}A_n$ and $\mu(A_n)<\infty$ for all $n\in\N$.
\end{itemize}
\end{definition}

\begin{lemma} \label{sigmaFiniteSequences}
Let $\sSet{\Omega, \mathcal{A}, \mu}$ be a measure space. Then the following are equivalent:
\begin{enumerate}
\item $\mu$ is $\sigma$-finite;
\item there exists a monotone sequence $\seq{B_n}_{n\in \N}\in\mathcal{A}^\N$ such that $\bigcup_{n\in\N}B_n = \Omega$ and $\mu(B_n) < \infty$ for all $n\in\N$;
\item there exists a disjoint sequence $\seq{C_n}_{n\in \N}\in\mathcal{A}^\N$ such that $\biguplus_{n\in\N}C_n = \Omega$ and $\mu(C_n) < \infty$ for all $n\in\N$.
\end{enumerate}
\end{lemma}
\begin{proof}
$(1) \Rightarrow (2)$ By $\sigma$-finiteness, there exists a sequence $\seq{A_n}\in \mathcal{A}^\N$ such that $\Omega = \bigcup_{n\in\N}A_n$ and $\mu(A_n)<\infty$ for all $n\in\N$.

We set $B_n \defeq \bigcup_{k\leq n} A_k$, which is a sequence in $\mathcal{A}$ that satisfies the requirements.

$(2) \Rightarrow (3)$ We set $C_n \defeq B_n\setminus B_{n-1}$, (with $C_0 = B_0$). This is a sequence in $\mathcal{A}$ that satisfies the requirements.

$(3) \Rightarrow (1)$ Immediate.
\end{proof}

\subsubsection{Restrictions of measures}
\begin{lemma} \label{submeasurespace}
Let $\sSet{\Omega,\mathcal{A},\mu}$ be a measure space and let $E\in\mathcal{A}$ be an event. Then $\mathcal{A}' = \powerset(E)\cap\mathcal{A}$ is a $\sigma$-algebra on $E$ and $\sSet{E,\mathcal{A}',\mu|_{\mathcal{A}'}}$ is a measure space.
\end{lemma}
We will often write $\mu|_E$ to mean $\mu|_{\mathcal{A}'}$.
\begin{proof}
First we show that $\mathcal{A}'$ is a $\sigma$-algebra on $E$, using \ref{setAlgebraCriteria}.
\begin{itemize}
\item Clearly $E\in \mathcal{A}$ and $E\in\powerset(E)$, so $E\in\mathcal{A}\cap \powerset(E) = \mathcal{A}'$.
\item Complements are taken w.r.t. $E$. Take $A\in \mathcal{A}'$. Then $E\setminus A$ is a subset of $E$ and thus in $\powerset(E)$. Also $E\setminus A\in \mathcal{A}$, because it is a measure-theoretic ring (see \ref{setAlgebraCoincidence}). Thus $A^c = E\setminus A \in \mathcal{A}\cap \powerset(E) = \mathcal{A}'$.
\item Let $\seq{A_n}_{n\in \N}$ be a sequence of sets in $\mathcal{A}'$. Then $\bigcup_{n\in \N}A_n$ is a subset of $E$ and thus in $\powerset(E)$. Also $\bigcup_{n\in \N}A_n\in\mathcal{A}$ because $\mathcal{A}$ is a $\sigma$-algebra. Thus $\bigcup_{n\in \N}A_n\in\mathcal{A}'$.
\end{itemize}
\end{proof}

\subsubsection{Extensions to measures}
\begin{proposition}
Let $\mathcal{F}\subseteq \powerset(\Omega)$ be a $\pi$-system and $\mu_1, \mu_2: \sigma(\mathcal{F}) \to \overline{\R^+}$ two measures with $\mu_1(\Omega) = \mu_2(\Omega) < \infty$, then $\mu_1 = \mu_2$.
\end{proposition}
\begin{proof}
Define
\[ \mathcal{D} \defeq \setbuilder{A\in \sigma(\mathcal{F})}{\mu_1(A) = \mu_2}. \]
Clearly $\mathcal{F} \subseteq \mathcal{D}$, so if $\mathcal{D}$ is a Dynkin system, then $\sigma(\mathcal{F}) \subseteq \mathcal{D}$ by the $\pi-\lambda$ theorem \ref{piLambdaTheorem}. Then $\sigma(\mathcal{F}) = \mathcal{D}$ by construction and thus $\mu_1 = \mu_2$.

We just need to verify the definition of Dynkin system:
\begin{itemize}
\item $\Omega\in\mathcal{D}$ by assumption;
\item if $A\in\mathcal{D}$, then, by \ref{ringPositiveContent}, $\mu_1(A^c) = \mu_1(\Omega) - \mu_1(A) = \mu_2(\Omega) - \mu_2(A) = \mu_2(A^c)$, so $A^c\in \mathcal{D}$;
\item if $\seq{A_n}_{n\in\N}$ is a disjoint sequence of sets in $\mathcal{D}$, then
\[ \mu_1\Big(\biguplus_{n\in\N}A_n\Big) = \sum_{n\in\N}\mu_1(A_n) = \sum_{n\in\N}\mu_2(A_n) = \mu_2\Big(\biguplus_{n\in\N}A_n\Big), \]
so $\biguplus_{n\in\N}A_n\in\mathcal{D}$.
\end{itemize}
\end{proof}
\begin{corollary} \label{sigmaFiniteUniqueExtension}
Let $\mathcal{F}\subseteq \powerset(\Omega)$ be a $\pi$-system and $\mu_1, \mu_2: \sigma(\mathcal{F}) \to \overline{\R^+}$ two measures. Suppose
\begin{itemize}
\item $\mu_1$ and $\mu_2$ agree on $\mathcal{F}$, i.e.\ $\mu_1(E) = \mu_2(E)$ for all $E\in\mathcal{F}$; and
\item there exists a sequence $\seq{E_n}\subseteq \mathcal{F}$ such that
\begin{itemize}
\item $\mu_1(E_n) = \mu_2(E_n) < \infty$ for all $n\in\N$; and
\item $\bigcup_{n\in\N} E_n = \Omega$.
\end{itemize}
\end{itemize}
Then $\mu_1 = \mu_2$.
\end{corollary}
\begin{proof}
For all $E\in \mathcal{F}$, we have $\mu_1|_{E_n} = \mu_2|_{E_n}$ by the proposition. Pick some $A\in \sigma(\mathcal{F})$. Then we can construct a disjoint sequence
\[ A_n \defeq (A\cap E_n)\setminus \bigg(\bigcup_{k=0}^{n-1}E_k\bigg) \]
and calculate
\[ \mu_1(A) = \sum_{n\in \N}\mu_1(A_n) = \sum_{n\in \N}\mu_1|_{E_n}(A_n) = \sum_{n\in \N}\mu_2|_{E_n}(A_n) = \sum_{n\in \N}\mu_1(A_n) = \mu_2(A). \]
\end{proof}

\subsubsection{New measures from old ones}
\begin{lemma} \label{measuresPositiveLinear}
Let $(\Omega,\mathcal{A})$ be a measurable space. Positive linear combinations of measures are measures: let $\mu_1,\mu_2$ be measures on $(\Omega,\mathcal{A})$ and $0 \leq c \in \R$. Then $c\mu_1 + \mu_2$ is a measure on $(\Omega,\mathcal{A})$.
\end{lemma}

\begin{proposition}[Pushforward measure] \label{pushforwardMeasure}
Let $\sSet{\Omega_1, \mathcal{A}, \mu}$ be a measure space and $\sSet{\Omega_2, \mathcal{B}}$ a measurable space. Let $f: \Omega_1 \to \Omega_2$ be a measurable function. Then
\[ \nu = \mu\circ f^{-1}|_{\mathcal{B}}: \mathcal{B}\to [0,\infty]: B \mapsto \mu(f^{-1}[B]) \]
is a measure on $\sSet{\Omega_2, \mathcal{B}}$.
\end{proposition}
\begin{proof}
Clearly this is well-defined due to $f$ being measurable. We have
\[ \nu(\emptyset) = \mu(f^{-1}[\emptyset])  = \mu(\emptyset) = 0 \]
for every sequence $(E_n)$ in $\mathcal{B}$ of pairwise disjoint sets, we have
\[ \nu\left(\biguplus_{n\in\N}E_n\right) = \mu\left(f^{-1}\left[\biguplus_{n\in\N}E_n\right]\right) = \mu\biguplus_{n\in\N} f^{-1}[E_n]  = \sum_{n\in\N}\mu(f^{-1}[E_n]) = \sum_{n\in\N}\nu(E_n). \]
\end{proof}

\subsection{Outer measures}
\begin{definition}
Let $\Omega$ be a non-empty set. An \udef{outer measure} on $\Omega$ is a map $\nu: \powerset(\Omega)\to [0,\infty]$ satisfying
\begin{itemize}
\item $\nu(\emptyset) = 0$;
\item if $E\subseteq F\subseteq \Omega$, then $\nu(E)\leq \nu(F)$;
\item $\nu$ is \udef{$\sigma$-subadditive}: for every sequence $\seq{E_n}$ in $\powerset(\Omega)$, we have
\[ \nu\left(\bigcup_{n\in\N}E_n\right) \leq \sum_{n\in\N}\nu(E_n). \]
\end{itemize}
\end{definition}
A countably additive outer measure is a premeasure, but in general an outer measure is neither a premeasure nor a measure.

\begin{lemma}
In the definition we can replace $\sigma$-subadditivity by subadditivity of countable, pairwise disjoint sequences.
\end{lemma}
Cfr. \ref{premeasureSubadditive}.
\begin{proof}
Clearly $\sigma$-subadditivity implies the subadditivity of countable, pairwise disjoint sequences.

Now assume the subadditivity of countable, pairwise disjoint sequences and take a sequence $\seq{E_n}$ in $\powerset(\Omega)$. Then define
\[ E_n' \defeq E_n \setminus\bigg(\bigcup_{k=0}^{n-1}E_k\bigg), \]
which forms a disjoint sequence such that $\bigcup_{n\in \N}E_n = \biguplus_{n\in \N}E_n'$. We have
\[ \nu\Big(\bigcup_{n\in\N}E_n\Big) \;=\; \nu\Big(\biguplus_{n\in\N}E_n'\Big) \;\leq\; \sum_{n\in\N}\nu(E_n') \;\leq\; \sum_{n\in\N}\nu(E_n). \]
The last inequality follows from the monotonicity of the outer measure.
\end{proof}


\subsubsection{Carathéodory measurability}
\begin{definition}
Let $\Omega$ be a set and $\rho: \powerset(\Omega)\to \overline{\R^+}$ a function. Then $A\subseteq \Omega$ is called \udef{Carathéodory measurable} w.r.t.\ $\rho$ if
\[ \forall B\subseteq \Omega: \; \rho(B) = \rho(B\cap A) + \rho(B\cap A^c). \]
\end{definition}

\begin{lemma}
Let $\Omega$ be a set and $\rho: \powerset(\Omega)\to \overline{\R^+}$ a function. If $\rho(\emptyset) \neq 0$, then there exist no Carathéodory measurable sets.
\end{lemma}
\begin{proof}
We prove by contraposition, so assume that there exists a Carathéodory meaurable $A\subseteq \Omega$.
Then
\begin{align*}
\rho(A) &= \rho(A\cap A) + \rho(A\cap A^c) \\
&= \rho(A) + \rho(\emptyset),
\end{align*}
which implies that $\rho(\emptyset) = 0$.
\end{proof}

\begin{lemma} \label{CaratheodoryMeasurableInequality}
Let $\Omega$ be a set and $\nu: \powerset(\Omega)\to \overline{\R^+}$ an outer measure on $\Omega$. A subset $A\subseteq \Omega$ is Carathéodory measurable \textup{if and only if}
\[ \forall B\subseteq \Omega: \; \nu(B) \geq \nu(B\cap A) + \nu(B\cap A^c). \]
\end{lemma}
\begin{proof}
The other inequality follows from subadditivity.
\end{proof}

\begin{lemma} \label{nullSetsCaratheodoryMeasurable}
Let $\Omega$ be a set, $\nu: \powerset(\Omega)\to \overline{\R^+}$ an outer measure on $\Omega$ and $A\subseteq \Omega$ such that $\nu(A) = 0$ or $\nu(A^c) = 0$, then $A$ is Carathéodory measurable.
\end{lemma}
\begin{proof}
First assume $\nu(A) = 0$. Take arbitrary $B\subseteq \Omega$. Then $\nu(B\cap A) = 0$ by monotonicity. Also by monotonicity, we have
\[ \nu(B) \geq \nu(B\cap A^c) = \nu(B\cap A) + \nu(B\cap A^c) \]
and so $A$ is Carathéodory measurable by \ref{CaratheodoryMeasurableInequality}.

The case of $\nu(A^c) = 0$ is similar.
\end{proof}

\subsubsection{Regular outer measures}
\begin{definition}
Let $\Omega$ be a non-empty set. An outer measure $\nu: \powerset(\Omega)\to \overline{\R^+}$ is called \udef{regular} if every set $A\subseteq \Omega$ is contained in a Carathéodory measurable set $B\subseteq \Omega$ such that $\nu(A) = \nu(B)$.
\end{definition}

\begin{proposition}
Let $\nu$ be a regular outer measure on $\Omega$ with $\nu(\Omega) < \infty$. Then a set $A\subseteq \Omega$ is Carathéodory measurable \textup{if and only if}
\[ \nu(A) + \nu(A^c) = \nu(\Omega). \]
\end{proposition}
\begin{proof}
The direction $\Rightarrow$ is immediate.

For the direction, pick some arbitrary $B\subseteq\Omega$. Then, by regularity, $B$ is contained in some Carathéodory measurable $C\subseteq \Omega$ such that $\nu(B) = \nu(C)$.

Consider the following:
\begin{alignat*}{5}
\nu(&A) & &= \quad & \nu(A&\cap C) & &+ & \nu(A&\cap C^c) \\
&+ &&& & &&& &+ \\
\nu(&A^c) & \quad &= & \nu(A^c&\cap C) & \quad&+\quad & \nu(A^c&\cap C^c) \\
&\rotatebox[origin=c]{90}{$=$} &&& & &&& &\rotatebox[origin=c]{90}{$\leq$} \\
\nu(&\Omega) & &= & \nu(&C) & &+ & \nu(&C^c)
\end{alignat*}
The three equations in the rows are instances of the measurability of $C$. The left column is the assumption on $A$ and the right column follows by subadditivity from $C^c = (A\cap C^c) \cup (A^c\cap C^c)$. By consistencey of the square, we can extract the following inequality from the center column:
\[ \nu(C) \geq \nu(A\cap C) + \nu(A^c\cap C). \]
For $B$ we then have
\begin{align*}
\nu(B) = \nu(C) &\geq \nu(A\cap C) + \nu(A^c\cap C) \\
&\geq \nu(A\cap B) + \nu(A^c\cap B),
\end{align*}
by monotonicity. By \ref{CaratheodoryMeasurableInequality}, this is enough to prove measurability of $A$. 
\end{proof}

\subsubsection{Construction of outer measures}
\begin{proposition} \label{outerMeasureConstruction}
Let $\mathcal{X}$ be a family of subsets of $\Omega$ such that $\emptyset\in \mathcal{X}$ and let $\rho: \mathcal{X}\to \overline{\R^+}$ be a function such that $\rho(\emptyset) = 0$. Then
\[ \rho^*: \powerset(\Omega) \to \overline{R^+}:\quad X\mapsto  \inf\setbuilder{\sum_{n\in\N}\rho(A_n)}{\big(\seq{A_n}_{n\in\N}\subseteq \mathcal{X}\big) \land \big(X\subseteq \bigcup_{n\in\N}A_n\big)} \]
is an outer measure on $\Omega$.

If $\rho$ is a pre-measure, then $\rho(A) = \rho^*(A)$ for all $A\in\mathcal{X}$.
\end{proposition}
\begin{proof}
We verify that $\rho^*$ is an outer measure.
\begin{itemize}
\item We have $\rho(\emptyset) = 0$, so $\rho^*(\emptyset)\leq 0$, but there is no element of $\overline{\R^+}$ smaller than $0$.
\item Take $E\subseteq F\subseteq \Omega$. Then every cover of $F$ is a cover of $E$. So the least cover of $E$ is smaller than the least cover of $F$.
\item Fix a sequence $\seq{E_n}$ in $\powerset(\Omega)$. Take some arbitrary $\epsilon > 0$. For each $E_n$, we can find some sequence $\seq{A_{n,k}}\subseteq \mathcal{X}$ such that $E_n\subseteq \bigcup_{k\in\N}A_{n,k}$ and $\sum_{k\in\N}\rho(A_{n,k}) \leq \rho^*(E_n) + \frac{\epsilon}{2^n}$.
Now the countable set $\seq{A_{n,k}}_{n,k\in \N}$ is a cover of $\bigcup_{n\in\N}E_n$, so
\[ \rho^*\Big(\bigcup_{n\in\N}E_n\Big) \leq \sum_{n,k\in\N}\rho(A_{n,k}) = \sum_{n\in\N}\sum_{k\in\N}\rho(A_{n,k}) \leq \sum_{n\in\N}\big(\rho^*(E_n)+ \frac{\epsilon}{2^n}\big) = 2\epsilon + \sum_{n\in\N}\rho^*(E_n), \]
where we have used \ref{joinMeetUnion} and the fact that the infinite sums are suprema over finite sums.

As the $\epsilon> 0$ was arbitrary, we have that
\[ \rho^*\Big(\bigcup_{n\in\N}E_n\Big) \leq \sum_{n\in\N}\rho^*(E_n). \]
\end{itemize}
Finally, assume $\rho$ is a pre-measure and take $A\in\mathcal{X}$. By construction, $\rho^*(A) \leq \rho(A)$. 

For the other inequality, take an arbitrary sequence $\seq{A_n}_{n\in\N}$ in $\mathcal{X}$ such that $A \subseteq \bigcup_{n\in\N}A_n$. Then
\[ \sum_{n\in\N}\rho(A_n) \geq \sum_{n\in\N}\rho(A_n\cap A) \geq \rho\Big(\bigcup_{n\in\N}(A_n\cap A)\Big) = \rho(A), \]
using monotonicity \ref{semiringPositiveContent} and subadditivity \ref{premeasureSubadditive}.
\end{proof}


\subsubsection{The extension theorem}
\begin{lemma} \label{caratheodoryExtensionLemma}
Let $\Omega$ be a set, $\rho: \powerset(\Omega) \to \overline{\R^+}$ a function and $\seq{A_i}_{i\in\N}$ a pairwise disjoint sequence of subsets of $\Omega$ that are Carathéodory measurable w.r.t.\ $\rho$. Then
\[ \rho(B) = \sum_{i=0}^n \rho(B\cap A_i) + \rho\big(B\cap (\bigcap_{i=0}^nA_i^c)\big) \]
for all $B\in \powerset(\Omega)$.
\end{lemma}
\begin{proof}
The proof is by induction on $n$. The base case $n=0$ is just the Carathéodory measurability of $A_0$.

For the induction step, we calculate
\begin{align*}
\rho(B) &= \sum_{i=0}^n \rho(B\cap A_i) + \rho\big(B\cap (\bigcap_{i=0}^nA_i^c)\big) \\
&= \sum_{i=0}^n \rho(B\cap A_i) + \rho\big(B\cap (\bigcap_{i=0}^nA_i^c)\cap A_{n+1}\big) + \rho\big(B\cap (\bigcap_{i=0}^nA_i^c)\cap A_{n+1}^c\big) \\
&= \sum_{i=0}^n \rho(B\cap A_i) + \rho\big(B\cap A_{n+1}\big) + \rho\big(B\cap (\bigcap_{i=0}^{n+1}A_i^c)\big) \\
&= \sum_{i=0}^{n+1}\rho(B\cap A_i) + \rho\big(B\cap (\bigcap_{i=0}^{n+1}A_i^c)\big).
\end{align*}
We conclude by induction.
\end{proof}

\begin{proposition} \label{caratheodoryLemma}
Let $\Omega$ be a set and $\rho: \powerset(\Omega) \to \overline{\R^+}$ a function such that $\rho(\emptyset) = 0$. Let $\mathcal{A}$ be the set of Carathéodory measurable subsets of $\Omega$. Then
\begin{enumerate}
\item $\mathcal{A}$ is an algebra;
\item if $\rho$ is an outer measure, then $\mathcal{A}$ is a $\sigma$-algebra.
\end{enumerate}
Also,
\begin{enumerate} \setcounter{enumi}{3}
\item $\rho|_{\mathcal{A}}$ is a complete content;
\item if $\rho$ is an outer measure, then $\rho|_{\mathcal{A}}$ is a complete measure.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) We use \ref{setAlgebraCriteria} the check that $\mathcal{A}$ is an algebra.
\begin{itemize}
\item For all $B\in \powerset(\Omega)$, we have
\[ \rho(B) = \rho(B\cap \Omega) + 0 = \rho(B\cap \Omega) + \rho(\emptyset) = \rho(B\cap \Omega) + \rho(B\cap \Omega^c), \]
so $\Omega\in \mathcal{A}$.
\item Closure under complementation is clear as the definition of Carathéodory measurability is symmetric w.r.t.\ complementation.
\item Assume $A_1,A_2 \in \mathcal{A}$. Take arbitrary $B\in\powerset(\Omega)$. Then
\begin{align*}
\rho(B) &= \rho(B\cap A_1) + \rho(B\cap A_1^c) \\
&= \rho(B\cap A_1) + \rho(B\cap A_1^c\cap A_2) + \rho(B\cap A_1^c\cap A_2^c) \\
&= \rho(B\cap A_1) + \rho(B\cap A_1^c\cap A_2) + m\big(B\cap (A_1\cup A_2)^c\big) \\
&= \rho\big(B\cap (A_1\cup A_2)\cap A_1\big) + \rho\big(B\cap (A_1\cup A_2)\cap A_1^c\big) + \rho\big(B\cap (A_1\cup A_2)^c\big) \\
&= \rho\big(B\cap (A_1\cup A_2)\big) + \rho\big(B\cap (A_1\cup A_2)^c\big),
\end{align*}
so $A_1\cup A_2\in \mathcal{A}$.
\end{itemize}

(2) To show $\mathcal{A}$ is a $\sigma$-algebra, it is enough to show closure under countable disjoint unions by \ref{conditionAlgebraIsSigmaAlgebra}. Let $\seq{A_n}$ be a sequence of pairwise disjoint sets in $\mathcal{A}$. 

By \ref{caratheodoryExtensionLemma} and monotonicity, we have
\[ \rho(B) \geq \sum_{i=0}^n \rho(B\cap A_i) + \rho\big(B\cap (\bigcap_{i=0}^\infty A_i^c)\big) \]
for all $n\in \N$. Thus, taking the limit $n\to\infty$,
\[ \rho(B) \geq \sum_{i=0}^\infty \rho(B\cap A_i) + \rho\Big(B\cap \big(\biguplus_{i=0}^\infty A_i\big)^c\Big) \geq \rho\Big(B\cap \big(\biguplus_{i=0}^\infty A_i\big)\Big) + \rho\Big(B\cap \big(\biguplus_{i=0}^\infty A_i\big)^c\Big), \]
which is enough to prove the  Carathéodory measurability of $\biguplus_{i=0}^\infty A_i$ by \ref{CaratheodoryMeasurableInequality}.

(3) We just need to prove additivity. Take disjoint $A,B\in\mathcal{A}$. Then
\begin{align*}
\rho(A\uplus B) &= \rho\big((A\uplus B)\cap A\big) + \rho\big((A\uplus B)\cap A^c\big) \\
&= \rho(A) + \rho(B).
\end{align*}
Completeness follows from \ref{nullSetsCaratheodoryMeasurable}.

(4) Follows straight from \ref{premeasureSubadditivityEquivalences} because outer measures are $\sigma$-subadditive. 
\end{proof}

\begin{theorem}[Carathéodory-Fréchet-Hahn-Kolmogorov-Hopf extension theorem] \label{premeasureExtensionTheorem}
Let $\mathcal{S}$ be a semi-ring on a set $\Omega$ and $\mu: \mathcal{S}\to \overline{\R^+}$ a pre-measure, then $\mu$ can be extended to a complete measure on $\sigma(\mathcal{S})$.
\end{theorem}
\begin{proof}
We first construct the outer measure $\mu^*$ as in \ref{outerMeasureConstruction} and then restrict this to a complete measure as in \ref{caratheodoryLemma}. If we can prove that each $A\in \mathcal{S}$ is Carathéodory measurable, then the $\sigma$-algebra on which the measure is defined must contain $\sigma(\mathcal{S})$. In this case \ref{outerMeasureConstruction} gives $\mu^*(A) = \mu(A)$. Thus restricting the measure to $\sigma(\mathcal{S})$ gives the first result.

We prove that each set in $\mathcal{S}$ is Carathéodory measurable. Take $A\in \mathcal{S}$. Pick an arbitrary $B\subseteq \Omega$ and fix some $\epsilon > 0$. Then we can find a sequence $\seq{B_n}_{n\in\N}$ in $\mathcal{S}$, that covers $B$, such that
\[ \sum_{n\in\N}\mu(B_n) \leq \mu^*(B) + \epsilon. \]
The sets $B_n\cap A$ are all in $\mathcal{S}$ and cover $B\cap A$. The sets $B_n\setminus A$ can be written as $B_n\setminus A = \biguplus_{k\in\N}D_{n,k}$, where $D_{n,k}\subseteq\mathcal{S}$ and only finitely many are non-empty.
We have
\begin{align*}
\mu^*(B\cap A) &\leq \sum_{n\in\N}\mu(B_n\cap A) \\
\mu^*(B\setminus A) &\leq \sum_{n,k\in\N} \mu(D_{n,k}).
\end{align*}
Then
\[ \mu(B_n) = \mu\Big((B_n\cap A) \uplus \biguplus_{k\in\N}D_{n,k}\Big) = \mu(B_n\cap A) + \sum_{k\in \N}\mu(D_{n,k}),  \]
by finite additivity (as there are only finitely many non-zero terms of the sum), and we get
\begin{align*}
\mu^*(B\cap A) + \mu^*(B\setminus A) &\leq \sum_{n\in\N}\mu(B_n\cap A) + \sum_{n,k\in\N} \mu(D_{n,k}) \\
&= \sum_{n\in\N}\Big(\mu(B_n\cap A) + \sum_{k\in\N}\mu(D_{n,k})\Big) \\
&= \sum_{n\in\N}\mu(B_n) \leq \mu^*(B) + \epsilon.
\end{align*}
As $\epsilon >0$ is arbitrary, we have $\mu^*(B) \geq \mu^*(B\cap A) + \mu^*(B\setminus A)$. By \ref{CaratheodoryMeasurableInequality}, this is enough to show the Carathéodory measurability of $A$.
\end{proof}

\begin{lemma}
The outer measure constructed in \ref{outerMeasureConstruction} is regular.
\end{lemma}
\begin{proof}
TODO
\end{proof}

\subsection{Constructions}
\subsubsection{Product measures}

\begin{proposition} \label{productMeasure}
Let $\sSet{\Omega_1, \mathcal{A}_1,\mu_1}$, $\sSet{\Omega_2, \mathcal{A}_2, }$ be measure spaces. Then there exists a $\mu$ on $\mathcal{A}_1\otimes\mathcal{A}_2$ that satisfies
\[ \mu(A_1\times A_2) = \mu_1(A_1)\cdot\mu_2(A_2) \qquad \forall A_1\in\mathcal{A}_1, A_2\in\mathcal{A}_2. \]
If $\mu_1$ and $\mu_2$ are $\sigma$-finite, then this measure is unique and $\sigma$-finite.
\end{proposition}
\begin{proof}
The set $\mathcal{B} \defeq \setbuilder{A_1\times A_2}{A_1\in \mathcal{A}_1, A_2\in \mathcal{A}_2}$ is a semi-ring by \ref{productSemiring}. 

If $\mu$ is a pre-measure, then, by \ref{premeasureExtensionTheorem}, it extends to a measure on $\sigma(\mathcal{B}) = \mathcal{A}_1\otimes\mathcal{A}_2$.

We verify that $\mu$ is a pre-measure:
\begin{itemize}
\item $\mu(\emptyset) = \mu(\emptyset \times\emptyset) = \mu_1(\emptyset)\cdot \mu_2(\emptyset) = 0\cdot 0 = 0$.
\item Take $\seq{B_k\times C_k} \in \mathcal{B}^\N$ pairwise disjoint such that $\biguplus_{k\in\N}B_k\times C_k = B\times C\in \mathcal{B}$. Now consider the equivalence relation on $B$ which relates $x$ and $y$ if $\forall k\in\N: x\in B_k \iff y\in B_k$. Now partition $B = \biguplus_{i\in\N} B'_{i}$ according to this equivalence relation. 

Every $B_k$ is a disjoint union of $B_i'$s and we write $B_k = \biguplus_{i\in I_k}B_i'$ (indeed, if $x$ and $y$ are in the same equivalence class $B_i'$ and $x\in B_k$, then $y\in B_k$). 

We partition $C = \biguplus_{j\in\N}C'_j$ and define $J_k$ similarly. We calculate
\begin{align*}
\mu\Big(\biguplus_{k\in\N} B_k\times C_k \Big) &= \mu(B\times C) \\
&= \mu_1(B)\cdot\mu_2(C) \\
&= \mu_1\Big(\biguplus_{i\in\N}B'_{i}\Big)\cdot\mu_2\Big(\biguplus_{j\in\N}C'_{j}\Big) \\
&= \sum_{i,j\in\N}\mu_1(B'_{i})\cdot\mu_2(C'_{j}) \\
&= \sum_{k\in\N} \Big(\sum_{i\in I_k}\mu_1(B'_{i})\Big)\cdot\Big(\sum_{j\in J_k}\mu_2(C'_{j})\Big) \\
&= \sum_{k\in\N} \mu_1\Big(\biguplus_{i\in I_k}B'_{i}\Big)\cdot\mu_2\Big(\biguplus_{j\in J_k}C'_{j}\Big) \\
&= \sum_{k\in\N} \mu_1(B_k)\cdot\mu_2(C_{k}) \\
&= \sum_{k\in\N} \mu(B_k\times C_{k}).
\end{align*}
\end{itemize}
Now assume $\mu_1$ and $\mu_2$ are $\sigma$-finite, so there exist sequences $\seq{D_n}_{n\in\N}\in \mathcal{A}_1^\N$ and $\seq{E_n}_{n\in\N}\in \mathcal{A}_2^\N$ of finite measure whose unions are, resp., $\Omega_1$ and $\Omega_2$. Then $\seq{D_n\times E_n}_{n\in \N}$ is a sequence of finite measure whose union is $\Omega_1\times\Omega_2$. This shows $\sigma$-finiteness.

Uniqueness then follows from \ref{sigmaFiniteUniqueExtension}.
\end{proof}

\begin{definition}
The unique measure from \ref{productMeasure} is called the \udef{product measure} and is denoted $\mu_1\otimes \mu_2$.
\end{definition}

\begin{proposition} \label{setSectionMeasurable}
Let $\sSet{\Omega_1, \mathcal{A}_1,\mu_1}$, $\sSet{\Omega_2, \mathcal{A}_2, }$ be measure spaces and $Q\in \mathcal{A}_1\otimes\mathcal{A}_2$. Then
\begin{enumerate}
\item $\setbuilder{\omega\in\Omega_2}{(x,\omega)\in Q} = xQ \in\mathcal{A}_2$ for all $x\in\Omega_1$;
\item $\setbuilder{\omega\in\Omega_1}{(\omega, y)\in Q} = Qy \in\mathcal{A}_1$ for all $y\in\Omega_2$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Fix arbitrary $x\in\Omega_1$.

If $Q = A_1\times A_2$ for some $A_1\in\mathcal{A}_1$ and $A_2\in\mathcal{A}_2$, then
\[ xQ = \setbuilder{\omega\in\Omega_2}{(x,\omega) \in A_1\times A_2} = \begin{cases}
\emptyset & (x\notin A_1) \\
A_2 & (x\in A_1)
\end{cases}, \]
which is an element of $\mathcal{A}_2$, so the result follows.

In order to extend the result to the rest of $\mathcal{A}_1\otimes \mathcal{A}_2$, it is enough to prove that the set $\mathcal{B}$ of all $P\subseteq \Omega_1\times \Omega_2$ such that $xP\in\mathcal{A}_2$ is a $\sigma$-algebra

We verify that $\mathcal{B}$ is a $\sigma$-algebra using \ref{setAlgebraCriteria}:
\begin{itemize}
\item We have $\setbuilder{\omega\in\Omega_2}{(x,\omega)\in \Omega_1\times \Omega_2} = \Omega_2 \in\mathcal{A}_2$, so $\Omega_1\times\Omega_2\in\mathcal{B}$.
\item Take $P\in\mathcal{B}$. Then $xP^c = (xP)^c \in \mathcal{A}_2$, so $P^c\in \mathcal{B}$.
\item Take $\seq{P_n}_{n\in\N}\in \mathcal{B}^\N$, then $x\Big(\bigcup_{n\in\N}P_n\Big) = \bigcup_{n\in\N}xP_n \in \mathcal{A}_2$. So $\bigcup_{n\in\N}P_n\in \mathcal{B}$.
\end{itemize}
\end{proof}
\begin{corollary} \label{partialApplicationMeasurable}
Let $\sSet{\Omega_1, \mathcal{A}_1}$, $\sSet{\Omega_2, \mathcal{A}_2}$, $\sSet{\Omega_3, \mathcal{A}_3}$ be measurable sets and $f: \Omega_1\times\Omega_2 \to \Omega_3$ a measurable function. For all $x\in\Omega_1, y\in\Omega_2$,
\begin{enumerate}
\item $f(x,-)$ is $\mathcal{A}_2/\mathcal{A}_3$-measurable;
\item $f(-,y)$ is $\mathcal{A}_1/\mathcal{A}_3$-measurable.
\end{enumerate}
\end{corollary}
\begin{proof}
(1) Take $B\in \mathcal{A}_3$. Then $\big(f(x,-)\big)^{\preimf}(B) = x\big(f^\preimf(B)\big)$. This is an element of $\mathcal{A}_2$ by the proposition and the measurability of $f$.

(2) Similar.
\end{proof}

\section{Measures on topological spaces}
\begin{definition}
Let $\sSet{X, \topology_X}$ be a topological space. Any measure on the Borel-measurable space is called a \udef{Borel} measure. 
\end{definition}


\begin{definition}
Let $\sSet{X, \topology_X}$ be a topological space with Borel $\sigma$-algebra $\mathcal{B}$. A measure $\mu: \mathcal{B} \to [0,\infty]$ is called \udef{locally finite} if every $x\in X$ has a neighbourhood $U_x$ such that $\mu(U_x)$ is finite.
\end{definition}

\subsubsection{Radon measures}
\begin{definition}
Let $\sSet{X, \topology_X}$ be a topological space with associated Borel $\sigma$-algebra $\mathcal{B}$. A \udef{(outer) Radon measure} is a measure $\mu: \mathcal{B}\to [0,\infty]$ such that
\begin{itemize}
\item $\mu$ is locally finite;
\item $\mu(A) = \inf\{\mu(U)\}{\text{$U\supseteq A$ is open}}$ for all $A\in \mathcal{B}$;
\item $\mu(A) = \sup\{\mu(K)\}{\text{$K\subseteq A$ is compact}}$ for all \emph{open} $A\in \mathcal{B}$.
\end{itemize}
We say $\mu$ is \udef{outer regular} and \udef{weakly inner regular}.
\end{definition}


\subsection{Contents and measures on the real line}
\begin{definition}
A subset $I\subseteq \R$ is called \udef{elementary} if it is of one of the following forms:
\begin{itemize}
\item $\interval[c]{a,b}$ for some $a,b\in \overline{\R}$;
\item $\interval[o]{a,b}$ for some $a,b\in \overline{\R}$;
\item $\interval[co]{a,b}$ for some $a,b\in \overline{\R}$;
\item $\interval[oc]{a,b}$ for some $a,b\in \overline{\R}$.
\end{itemize}
We define the \udef{elementary pre-measure} $\lambda$ on the elementary sets by $\lambda(I) = |b-a|$ and $\lambda(\R) = \infty$.

We will call a family of subsets of the real line \udef{admissible} if it contains all elementary sets. We will call a content or measure $\mu$ on the real line \udef{admissible} if it is defined on an admissible family of sets and satisfies $\mu(I) = \lambda(I)$.
\end{definition}

\begin{lemma}
The set of elementary subsets of the real line is a semi-algebra and the elementary pre-measure $\lambda$ is a positive pre-measure on the set of elementary sets.
\end{lemma}
\begin{proof}
Let $\mathcal{E}$ be the family of elementary subsets of the real line. We verify \ref{setAlgebraCriteria}. Take $A,B\in \mathcal{E}$. Let $a_A,b_A$ be the bounds of $A$ and $a_B, b_B$ the bounds of $B$.

Then $A\cap B$ is an interval between $\max\{a_A, a_B\}$ and $\min\{b_A, b_B\}$.

And $A^c$ consists of the disjoint union of the interval from $-\infty$ to $a_A$ and the interval from $b_A$ to $\infty$.

Now we verify that $\lambda$ is a content. Firstly,
\[ \lambda(\emptyset) = \lambda\big(\interval[o]{1,1}\big) = |1-1| = 0. \]
Next suppose $I = I_0\uplus \ldots \uplus I_{k-1}$, where $I,I_0,\ldots, I_{k-1}$ are elementary sets. If $I$ is an interval from $a_0$ to $a_k$, then we can order the other intervals such that $I_m$ is an interval from $a_m$ to $a_{m+1}$ and $a_0 \leq \ldots \leq a_k$.

Then we have
\[ \mu(I) = a_k - a_0 = (a_k - a_{k-1}) + \ldots (a_1 - a_0) = \mu(I_{k-1}) + \ldots + \mu(I_0). \]


TODO extend to $\sigma$-additivity.
\end{proof}

We will be extending this content to much larger algebra's and $\sigma$-algebras in different ways. We can, however, always do the minimal extension to an algebra as detailed in \ref{contentsOnSemiRingToRing}.

From now on we will use ``elementary set'' to be an element of this algebra.

\subsubsection{Translation invariance and uniqueness}
TODO

\subsubsection{The Peano-Jordan content}
\begin{definition}
A subset $A\subseteq \R$ is called \udef{Peano-Jordan measurable} if for all $\epsilon > 0$, there exists a pair of sets elementary $B_\epsilon, C_\epsilon \subseteq \R$ such that
\begin{itemize}
\item $B_\epsilon \subseteq A\subseteq C_\epsilon$;
\item $\lambda(C_\epsilon \setminus B_\epsilon) \leq \epsilon$.
\end{itemize}
The Peano-Jordan content of a Peano-Jordan measurable set $A$ is equal to
\[ \lambda_J(A) \defeq \lim_{\epsilon\to 0}\lambda(B_\epsilon) = \lim_{\epsilon\to 0}\lambda(C_\epsilon). \]
\end{definition}
Notice that $\lambda(C_\epsilon \setminus B_\epsilon)$ is well-defined because $\lambda$ is defined on the whole \emph{algebra} of elementary sets.

\begin{lemma}
Let $A\subseteq \R$ be a Peano-Jordan measurable set. Then the Peano-Jordan content is well-defined, i.e.\ $\lim_{\epsilon\to 0}\lambda(B_\epsilon) = \lim_{\epsilon\to 0}\lambda(C_\epsilon)$.
\end{lemma}
\begin{proof}
If there exists some $\epsilon' >0$ such that $B_{\epsilon'}$ is infinite, then $C_\epsilon$ must be infinite for all $\epsilon >0$. We then need to show that $\lim_{\epsilon\to 0}\lambda(B_\epsilon) = \infty$.

Suppose, towards a contradiction, that $\lambda(B_\epsilon)$ does not tend to infinity. Then there exists a constant $K\geq 0$ such that $\lambda(B_\epsilon) \leq K$ for all $\epsilon >0$. Then we calculate, using \ref{ringPositiveContent},
\[ \lambda(C_\epsilon \setminus B_\epsilon) = \lambda(C_\epsilon) - \lambda(B_\epsilon) \geq \infty - K = \infty > \epsilon. \]
This is a contradiction.

Now assume $\lambda(B_\epsilon)$ is finite for all $\epsilon >0$. Then we can use \ref{ringPositiveContent} to obtain
\[ \lambda(C_\epsilon \setminus B_\epsilon) = \lambda(C_\epsilon) - \lambda(B_\epsilon) \leq \epsilon. \]
We conclude $\lim_{\epsilon\to 0}\lambda(B_\epsilon) = \lim_{\epsilon\to 0}\lambda(C_\epsilon)$ by continuity of subtraction.
\end{proof}

\begin{proposition} \label{supInfPeanoJordanContent}
Take $A\subseteq \R$.
\begin{enumerate}
\item If $A$ is Peano-Jordan measurable, then
\[ \sup_{\substack{B\subseteq A \\ \text{$B$ is elementary}}} \hspace{-1.5em}\lambda(B) \quad = \inf_{\substack{A\subseteq C \\ \text{$C$ is elementary}}} \hspace{-1.5em}\lambda(C) = \lambda_J(A). \]
\item If
\[ \sup_{\substack{B\subseteq A \\ \text{$B$ is elementary}}} \hspace{-1.5em}\lambda(B) \quad = \inf_{\substack{A\subseteq C \\ \text{$C$ is elementary}}} \hspace{-1.5em}\lambda(C) \]
and this quantity is finite, then $A$ is Peano-Jordan measurable.
\end{enumerate}
\end{proposition}
The condition
\[ \sup_{\substack{B\subseteq A \\ \text{$B$ is elementary}}} \hspace{-1.5em}\lambda(B) \quad = \inf_{\substack{A\subseteq C \\ \text{$C$ is elementary}}} \hspace{-1.5em}\lambda(C) \]
is sometimes taken as the (inequivalent) definition of Peano-Jordan measurable. One problem with this is that the Peano-Jordan measurable sets would not form an algebra (see example).
\begin{proof}
(1) By construction it is clear that
\[ \sup_{\substack{B\subseteq A \\ \text{$B$ is elementary}}} \hspace{-1.5em}\lambda(B) \quad \leq \inf_{\substack{A\subseteq C \\ \text{$C$ is elementary}}} \hspace{-1.5em}\lambda(C). \]
Also
\[ \{B_\epsilon\}_{\epsilon > 0} \subseteq \setbuilder{B}{\text{$B\subseteq A$ and $B$ is elementary}} \quad\text{and}\quad \{C_\epsilon\}_{\epsilon > 0} \subseteq \setbuilder{C}{\text{$A\subseteq C$ and $C$ is elementary}}. \]
By compatibility of the order with the convergence, we have
\[ \inf_{\substack{A\subseteq C \\ \text{$C$ is elementary}}} \hspace{-1.5em}\lambda(C) \quad \leq \quad \lim_{\epsilon\to 0}\lambda(C_\epsilon) = \lambda_J(A) = \lim_{\epsilon\to 0}\lambda(B_\epsilon) \quad \leq \sup_{\substack{B\subseteq A \\ \text{$B$ is elementary}}} \hspace{-1.5em}\lambda(B), \]
which proves the assertions.

(2) Set
\[ x = \sup_{\substack{B\subseteq A \\ \text{$B$ is elementary}}} \hspace{-1.5em}\lambda(B) \quad = \inf_{\substack{A\subseteq C \\ \text{$C$ is elementary}}} \hspace{-1.5em}\lambda(C) \]
and take $\epsilon >0$ arbitrary.

We can find an elementary $B_\epsilon \subseteq A$ such that $\lambda(B_\epsilon) \geq x-\epsilon/2$ and $C_\epsilon \supseteq A$ such that $\lambda(C_\epsilon) \leq x+\epsilon/2$. These sets satisfy the definition.
\end{proof}

\begin{example}
\begin{itemize}
\item There are Jordan measurable sets that are not elementary. For example, $\setbuilder{n^{-1}}{n\in (1:)} \cup \{0\}$ is Jordan measurable with Jordan content $0$.

Indeed, take $B_\epsilon = \{0\}$ for all $\epsilon$ and $C_\epsilon = \interval{0,\epsilon} \cup\bigcup_{n=1}^{\floor{\epsilon^{-1}}} \{n^{-1}\}$.
\item The rationals $\Q$ is not Jordan measurable. Indeed all elementary subsets of $\Q$ have zero content and all elementary supersets of $\Q$ have content $\infty$.
\item Point two of \ref{supInfPeanoJordanContent} does not hold if the quantity is infinite. For example, take $A = \Q \cup \interval{0,+\infty}$. This also shows that if we took the condition in \ref{supInfPeanoJordanContent} to be the definition of Peano-Jordan measurability, then the Peano-Jordan measurable sets would not form an algebra.
\end{itemize}
\end{example}

\begin{lemma} \label{PeanoJordanAlgebra}
The set of Peano-Jordan measurable sets is an algebra, which is admissible. The Peano-Jordan content is a content. It is also admissible.
\end{lemma}
\begin{proof}
Admissibility is clear. We need to show that the set of Jordan measurable sets forms an algebra.

We prove this from the fact that elementary sets form an algebra, using \ref{setAlgebraCriteria}.

\begin{itemize}
\item Clearly $\R\in\mathcal{A}$.
\item Let $A$ be Jordan measurable. Then there exist families $B_\epsilon^A$ and $C_\epsilon^{A}$ of elementary sets such that $B_\epsilon^A \subseteq A \subseteq C_\epsilon^{A}$. Then $(B_\epsilon^A)^c$ and $(C_\epsilon^{A})^c$ are also families of elementary sets and $(B_\epsilon^A)^c \subseteq A^c \subseteq (C_\epsilon^{A})^c$. By \ref{setDifferenceComplement}, we have $(B_\epsilon^A)^c \setminus (C_\epsilon^{A})^c = B_\epsilon^A \setminus C_\epsilon^{A}$. This shows that $A^c$ is Jordan measurable.
\item Let $B$ be Jordan measurable. Then there exist families $B_\epsilon^B$ and $C_\epsilon^{B}$ of elementary sets such that $B_\epsilon^B \subseteq B \subseteq C_\epsilon^{B}$. We have
\[ B_{\epsilon/2}^A \cup B_{\epsilon/2}^B \subseteq A\cup B \subseteq C_{\epsilon/2}^A \cup C_{\epsilon/2}^B. \]
Then $\big(C_{\epsilon/2}^A \cup C_{\epsilon/2}^B\big) \setminus \big(B_{\epsilon/2}^A \cup B_{\epsilon/2}^B\big) \subseteq \big(C_{\epsilon/2}^A \setminus B_{\epsilon/2}^A\big) \cup \big(C_{\epsilon/2}^B \setminus B_{\epsilon/2}^B\big)$, so
\begin{align*}
\lambda\Big(\big(C_{\epsilon/2}^A \cup C_{\epsilon/2}^B\big) \setminus \big(B_{\epsilon/2}^A \cup B_{\epsilon/2}^B\big)\Big) &\leq \lambda\big(C_{\epsilon/2}^A \setminus B_{\epsilon/2}^A\big) + \lambda\big(C_{\epsilon/2}^B \setminus B_{\epsilon/2}^B\big) \\
&= \frac{\epsilon}{2} + \frac{\epsilon}{2} = \epsilon,
\end{align*}
by \ref{semiringPositiveContent}.
\end{itemize}

Finally we show that the Peano-Jordan content is a content.
\begin{itemize}
\item The Peano-Jordan content of $\emptyset$ is $0$ by admissibility and the fact that the elementary pre-measure is a pre-measure.
\item Now take disjoint Peano-Jordan measurable sets $A,B$ and families $B_\epsilon^A, C_\epsilon^A, B_\epsilon^B, C_\epsilon^B$ of elementary sets that witness the Peano-Jordan measurability. Clearly $B_\epsilon^A$ and $B_\epsilon^B$ are disjoint.

As before, we may take $B_\epsilon^A\uplus B_\epsilon^B$ and $C_\epsilon^A \cup C_\epsilon^B$ to witness the Peano-Jordan measurability of $A\uplus B$. We can then calculate the Peano-Jordan content as
\begin{align*}
\lambda_J(A\uplus B) &= \lim_{\epsilon \to 0}\lambda(B_\epsilon^A\uplus B_\epsilon^B) \\
&= \lim_{\epsilon \to 0}\lambda(B_\epsilon^A) + \lambda(B_\epsilon^B) \\
&= \lim_{\epsilon \to 0}\lambda(B_\epsilon^A) + \lim_{\epsilon \to 0}\lambda(B_\epsilon^B) \\
&= \lambda_J(A) + \lambda_J(B).
\end{align*}
\end{itemize}
\end{proof}

\begin{proposition}
Let $\seq{A_n}_{n\in \N}$ be a sequence of disjoint Peano-Jordan measurable sets such that $\biguplus_{n\in\N}A_n$ is Peano-Jordan measurable. Then
\[ \mu\Big(\biguplus_{n\in\N}A_n\Big) = \sum_{n\in\N}\mu(A_n). \]
\end{proposition}
\begin{proof}
Given \ref{ringPositiveContent}, we only need to show
\[ \mu\Big(\biguplus_{n\in\N}A_n\Big) \leq \sum_{n\in\N}\mu(A_n). \]

TODO Tannery
\end{proof}

\subsubsection{The Lebesgue measure}
\begin{definition}
Define $\mathfrak{I}$ as the subset of sequences $\seq{(a_n,b_n)}$ in $(\overline{\R}\times\overline{\R})^\N$ such that
\[ \ldots < b_{n-1}< a_n < b_n < a_{n+1} < \ldots \]

The \udef{Lebesgue outer measure} on $\R$, denoted by $\lambda^*$ is defined by
\[ \lambda^*(A) = \inf\setbuilder{\sum_{n\in \N}(b_n-a_n)}{\text{$\seq{(a_n,b_n)}\in \mathfrak{I}$ such that $A \subseteq \bigcup_{n\in\N} \interval[o]{a_n, b_n}$}}. \]

The set of $\lambda^*$-measurable sets is called the \udef{Lebesgue $\sigma$-algebra} and the associated measure $\lambda$ is called the \udef{Lebegue measure}.
\end{definition}
We say $\seq{(a_n,b_n)}\in \mathfrak{I}$ covers $A$ if $A \subseteq \bigcup_{n\in\N} \interval[o]{a_n, b_n}$.

\begin{lemma}
The Lebesgue outer measure on $\R$ is an outer measure on $\R$ and for all $a
\leq b$
\[ \lambda^*([a,b]) = \lambda^*(]a,b]) = \lambda^*([a,b[) = \lambda^*(]a,b[) = b-a. \]
The Lebesgue outer measure of any unbounded interval is $+\infty$.
\end{lemma}
\begin{proof}
We verify the three points in the definition of an outer measure:
\begin{itemize}
\item We have that $\emptyset \subseteq ]0,\epsilon[$ for all $\epsilon > 0$, so  $0 = \inf\setbuilder{\epsilon}{\epsilon > 0} \geq \lambda^*(\emptyset) \geq 0$.
\item If $A\subseteq B$, then any cover of $B$ is a cover of $A$.
\item Let $\seq{A_n}$ be an arbitrary sequence in $\powerset(\Omega)$. If $\sum_{n\in\N}\lambda^*(A_n) = +\infty$, then subadditivity is necessarily satisfied. Now assume $\sum_{n\in\N}\lambda^*(A_n)$ is finite, then each $\lambda^*(A_n)$ is finite. Fix an arbitrary constant $\epsilon > 0$. We can find a $\seq{(a_{n,k},b_{n,k})}_{k\in\N}\in \mathfrak{I}$ that covers $A_n$ and is such that
\[ \sum_{k=0}^\infty(b_{n,k} - a_{n,k}) < \lambda^*(A_n) + \epsilon/2^n. \]
Now $\bigcup_{n\in \N}A_n$ is covered by $\seq{(a_{n,k},b_{n,k})}_{n,k\in\N}$ and
\[ \sum_{n,k \in\N} (b_{n,k} - a_{n,k}) < \sum_{n\in \N}(\lambda^*(A_n) + \epsilon/2^n) = \sum_{n\in \N}\lambda^*(A_n) + \epsilon. \]
Thus $\lambda^*\left(\bigcup_{n\in \N}A_n\right) \leq \sum_{n,k \in\N} (b_{n,k} - a_{n,k}) < \sum_{n\in \N}\lambda^*(A_n) + \epsilon$ for all $\epsilon > 0$. Thus $\lambda^*\left(\bigcup_{n\in \N}A_n\right) \leq \sum_{n\in \N}\lambda^*(A_n)$.
\end{itemize}
It is clear that $\lambda^*(]a,b[) \leq b-a$. For the converse, it is enough to notice that any sequence covering $]a,b[$ must contain a term $(c,d)$ with $c\leq a$ and $d\geq b$. 

We now show $\lambda^*([a,b]) = b-a$. Considering covers of the form $(a-\epsilon, b+\epsilon)$ for arbitrary $\epsilon > 0$, gives $\lambda^*([a,b]) \leq b-a$. For the reverse inequality, we have $b-a = \lambda^*(]a,b[) \leq \lambda^*([a,b])$.

The results for the halfopen intervals follow because 
\[ b-a = \lambda^*([a,b]) \geq \lambda^*(]a,b]) \leq \lambda^*(]a,b[) = b-a \]
and similarly for $\lambda^*([a,b[)$.

The reasoning for unbounded intervals is similar.
\end{proof}
\begin{corollary}
The Lebesgue measure is a measure.
\end{corollary}

\begin{proposition}
Let $\mathcal{B}$ be the Borel $\sigma$-algebra on $\R$ and $\mathcal{A}_{\lambda^*}$ the Lebesgue $\sigma$-algebra.

Then $\sSet{\R, \mathcal{A}_{\lambda^*}, \lambda}$ is the completion of $\sSet{\R, \mathcal{B}, \lambda}$.
\end{proposition}
\begin{proof}
TODO
\end{proof}

\begin{example}
Cantor set: $\sSet{\R, \mathcal{B}, \lambda}$ is not complete.
\end{example}

\begin{proposition}
The Lebesgue measure (restricted to the Borel $\sigma$-algebra) is the only measure $\mu$ on the Borel $\sigma$-algebra such that $\mu([a,b]) = b-a$.
\end{proposition}
\begin{proof}
TODO
\end{proof}

\begin{proposition}
The Lebesgue measure is regular.
\end{proposition}
\begin{proof}
TODO
\end{proof}

\subsection{Pointwise algebras}
\begin{lemma} \label{equalAECongruence}
Let $\sSet{X, \mathcal{X}, \mu}$ be a measure space and $Y$ an $\Omega$-structure. Then the relation $\overset{\text{a.e.}}{=}$ on $(X\to Y)$ is a congruence on the pointwise algebra $(X\to Y)$.
\end{lemma}
\begin{proof}
Take $\omega\in\Omega$ and $x = \seq{(f_i,g_i)}_{i\in(0:\alpha(\omega))}$ a sequence in $(X\to Y)^2$ such that $f_i\mathrel{\overset{\text{a.e.}}{=}} g_i$ for all $i\in \big(0:\alpha(\omega)\big)$. Set $N_i \defeq \setbuilder{x\in X}{f_i(x)\neq g_i(x)}$. This is a null set for all $i\in\big(0:\alpha(\omega)\big)$.

We need to show that $\omega_{X\to Y}(\seq{f_i}_{i\in(0:\alpha(\omega))})\mathrel{\overset{\text{a.e.}}{=}}\omega_{X\to Y}(\seq{f_i}_{i\in(0:\alpha(\omega))})$. Let $N$ be the set $\setbuilder{x\in X}{\omega_{X\to Y}(\seq{f_i(x)}_{i\in(0:\alpha(\omega))}) \neq \omega_{X\to Y}(\seq{g_i(x)}_{i\in(0:\alpha(\omega))})}$.

Clearly $N\subseteq \bigcup_{i\in(0:\alpha(\omega))}N_i$. So $N$ is a null set by subadditivity.
\end{proof}

\section{Lebesgue integration}
\url{https://math.stackexchange.com/questions/2218114/theoretical-advantages-of-lebesgue-integration}
\url{https://math.stackexchange.com/questions/3202630/what-are-the-advantages-of-the-riemann-vs-lebesgue-integral}

We want to define an integral functional $I(f)$.

Riemann: $I(f) = \lim_n I_n(f)$

Lebesgue $I(f) = \lim_n I(f_n)$.


\subsection{Simple functions}
TODO order on function spaces

\begin{definition}
Let $\Omega$ be a set. A \udef{simple function} (or \udef{step function}) on $\Omega$ is a function with a range of finite cardinality.

Let $B$ be a set. We denote the subset of simple functions in $(\Omega\to B)$ by $\SF(\Omega,B)$
\end{definition}

TODO: should $\SF(\Omega, B)$ mean measurable simple function??

\begin{lemma}
Let $s:\Omega\to Y$ be a simple function into a vector space. Then $s$ can be written as
\[ s(x) = \sum_{\lambda \in s[\Omega]}\lambda\cdot \chi_{s^{-1}[\lambda]}(x). \]
Additionally for some $k\in\N$ we can write $s[\Omega] = \bigcup_{i=1}^k\{\lambda_i\}$ and $A_i = s^{-1}[\lambda_i]$. Then the $A_i$ form a partition of $\Omega$ and
\[ s(x) = \sum_{i=1}^k\lambda_i\cdot \chi_{A_i}(x). \]
This is known as the \udef{canonical form} of $s$. Conversely every function of this form is a simple function.
\end{lemma}

\begin{lemma}
Let $(\Omega, \mathcal{A})$ and $(Y, \mathcal{B})$ be measurable spaces such that $\mathcal{B}$ contains all singleton sets. Let $s:\Omega\to Y$ be a simple function.

Then $s$ is measurable \textup{if and only if} $s^{-1}[\lambda]\in\mathcal{A}$ for all $\lambda\in s[\Omega]$.

This is equivalent to saying the partition $\{A_i\}_{i=1}^k$ is a subset of $\mathcal{A}$.
\end{lemma}
\begin{proof}
The direction $\boxed{\Rightarrow}$ is clear, since $\mathcal{B}$ is assumed to contain all singleton sets.

For the $\boxed{\Leftarrow}$ direction, let $B\in \mathcal{B}$. Then
\[ s^{-1}[B] = \bigcup_{\lambda\in s[\Omega]}s^{-1}[B\cap \{\lambda\}], \]
which is a finite union of measurable sets.
\end{proof}

\begin{lemma}
Let $\Omega$ be a set, $G$ an abelian group and $s,t\in\SF(\Omega,G)$. If $s$ and $t$ have canonical forms
\[ s = \sum_{i=1}^k a_i\cdot\chi_{A_i} \qquad\text{and}\qquad t = \sum_{j=1}^l b_j\cdot\chi_{B_j}, \]
then $s+t$ has canonical form
\[ s+t = \sum_{i=1}^k\sum_{j=1}^l (a_i+b_j)\chi_{A_i}\chi_{B_j} = \sum_{i,j \in (1:k)\times(1:l)}(a_i+b_j)\chi_{A_i\cap B_j}. \]
\end{lemma}


TODO: generalise??
\begin{proposition} \label{measurableFunctionPointwiseLimitSimpleFunctions}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and let $f:\Omega\to[0,+\infty]$ be a positive function.

If $f$ is measurable, then there exists an increasing sequence of positive measurable step functions $(s_n)$ that converges point-wise to $f$.
\end{proposition}
The converse is also true and is given by \ref{pointWiseConvergenceMeasurable}.
\begin{proof}
Assume $f$ measurable. If we can find an increasing sequence of positive measurable step functions $(t_n)$ that converges point-wise to $\id:[0,+\infty]\to[0,+\infty]$, then
\[ f = \id\circ f = \lim_{n\to\infty} t_n\circ f = \sup_{n\in\N}(t_n\circ f) \]
and so $s_n = t_n\circ f$ gives the sequence we are looking for. And we can find such a sequence $(t_n)$. For example
\[ t_n = n\chi_{[n,+\infty[}+\sum_{k=1}^{n2^n}\frac{k-1}{2^n}\chi_{[\frac{k-1}{2^n},\frac{k}{2^n}[}. \]
\end{proof}


\subsubsection{Integration of simple functions}
\begin{definition}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and $Y$ a vector space. Let
\[ s:\Omega \to Y: x\mapsto \sum_{\lambda \in \im(s)}\lambda\cdot \chi_{s^{-1}[\lambda]}(x) = \sum_{i=1}^k\lambda_i\cdot\chi_{A_i}(x)  \]
be a measurable simple function. We define the \udef{integral} of $s$ over $\Omega$ w.r.t. $\mu$ as
\[ \int_\Omega s\diff{\mu} \defeq \sum_{\lambda \in \im(s)}\lambda\cdot \mu(s^{-1}[\lambda]) = \sum_{i=1}^k\mu(A_i)\cdot\lambda_j. \]
Using the convention that $0\times \infty = 0$. (TODO: clarify)

We call $s$ \udef{integrable} if the integral is finite (TODO clarify + below).

For any $E\in\mathcal{A}$ we also define the integral some measurable simple function $s:\Omega\to Y$ over $E$ by
\[ \int_E s \diff{\mu} \defeq \int_E s|_E \diff{\mu|_E}, \]
where the last integral is taken over the measure space $(E,\mathcal{A}',\mu|_{\mathcal{A}'})$ as defined in \ref{submeasurespace}.
\end{definition}

The integral can be seen as a map $\SF(\Omega,Y)\to \overline{Y}$, where $\overline{Y}$ is the Dedekind-MacNeille completion (TODO!).

\begin{lemma} \label{measureFromIntegralCharacteristicFunctions}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and $E\in\mathcal{A}$. Then
\[ \mu(E) = \int_\Omega \chi_E \diff{\mu}. \]
\end{lemma}

\begin{lemma} \label{simpleIntegralOverSubset}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $Y$ a vector space over $\F$, $E\in\mathcal{A}$ and $s:\Omega\to Y$ a measurable simple function. Then
\[ \int_E s \diff{\mu} = \int_\Omega s\cdot\chi_{E} \diff{\mu}. \]
\end{lemma}
\begin{proof}
We have
\begin{align*}
\int_E s \diff{\mu} &= \int_E s|_E \diff{\mu|_E}\\
&= \sum_{\lambda \in \im(s|_E)}\lambda\cdot \mu|_E\big(s|_E^{\preimf}(\lambda)\big) \\
&= \sum_{\lambda \in \im(s|_E)}\lambda\cdot \mu\big(s^{\preimf}(\lambda)\cap E\big) \\
&= 0 + \sum_{\lambda \in \im(s|_E)\setminus\{0\}}\lambda\cdot \mu\big(s^{\preimf}(\lambda)\cap E\big) \\
&= 0 + \sum_{\lambda \in \im(s\cdot \chi_E)\setminus\{0\}}\lambda\cdot \mu\big((s\cdot \chi_E)^{\preimf}(\lambda)\big) \\
&= 0\cdot \mu\big((s\cdot \chi_E)^{\preimf}(0)\big) + \sum_{\lambda \in \im(s\cdot \chi_E)\setminus\{0\}}\lambda\cdot \mu\big((s\cdot \chi_E)^{\preimf}(\lambda)\big) \\
&= \sum_{\lambda \in \im(s\cdot \chi_E)}\lambda\cdot \mu\big((s\cdot \chi_E)^{\preimf}(\lambda)\big) \\
&= \int_\Omega s\cdot\chi_E \diff{\mu}.
\end{align*}
\end{proof}


\begin{proposition} \label{integrationLinear} \label{integrationOrderPreserving}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and $Y$ a vector space over $\F$. Then
\begin{enumerate}
\item the integral is linear: $\forall c\in \F$ and $\forall s,t\in\SF(\Omega, Y)$:
\[ \int_\Omega (c\cdot s + t)\diff{\mu} = c\cdot \int_\Omega s\diff{\mu} + \int_\Omega t\diff{\mu}. \]
\end{enumerate}
If $Y$ is a normed space, then
\begin{enumerate} \setcounter{enumi}{1}
\item for all $s\in\SF(\Omega, Y)$:
\[ \int_\Omega \norm{s}\diff{\mu} \leq \norm{\int_\Omega s \diff{\mu}}; \]
\item if $E_1\subseteq E_2$ are events in $\mathcal{A}$, then
\[ \int_{E_1}\norm{s}\diff{\mu} \leq \int_{E_2}\norm{s}\diff{\mu}. \]
\end{enumerate} \setcounter{enumi}{3}
If $Y$ is an ordered space, then
\begin{enumerate}
\item if $s(x)\leq t(x)$ for all $x\in\Omega$, then
\[ \int_\Omega s\diff{\mu} \leq \int_\Omega t\diff{\mu}. \]
\end{enumerate}
\end{proposition}
\begin{proof}
(1) Let $s,t$ have canonical forms
\[ s = \sum_{i=1}^k a_i\cdot\chi_{A_i} \qquad\text{and}\qquad t = \sum_{i=1}^k b_i\cdot\chi_{B_i}. \]
Then we calculate
\begin{align*}
\int_\Omega (c\cdot s + t)\diff{\mu} &= \sum_{i=1}^k\sum_{j=1}^l\mu(A_i\cap B_j)\cdot(c a_i + b_j) \\
&= c\sum_{i=1}^k\sum_{j=1}^l\mu(A_i\cap B_j)\cdot a_i +  \sum_{i=1}^k\sum_{j=1}^l\mu(A_i\cap B_j) \cdot b_j \\
&= c\sum_{i=1}^k\mu(A_i)\cdot a_i +  \sum_{j=1}^l\mu(B_j) \cdot b_j \\
&= c\int_\Omega s\diff{\mu} + \int_\Omega t\diff{\mu}.
\end{align*}

The property (2) is just the triangle inequality. The other properties can be proven in a similar fashion to (1).
\end{proof}

\begin{proposition}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and $s:\Omega\to [0,+\infty[$ a measurable simple function. The map
\[ \nu:\mathcal{A}\to [0,+\infty]: E\mapsto \int_E s\diff{\mu} = \int_\Omega s\cdot \chi_E\diff{\mu} \]
defines a measure.
\end{proposition}
\begin{proof}
From the positive linearity of both measures and integration (\ref{measuresPositiveLinear}, \ref{integrationLinear}) it is enough to consider $s = \chi_A$ for some $A\in\mathcal{A}$. In this case
\[ \nu(E) = \int_\Omega\chi_A\chi_B \diff{\mu} = \int_\Omega\chi_{A\cap B} \diff{\mu} = \mu(A\cap E). \]
It is clear that $\nu(\emptyset) = 0$. For $\sigma$-additivity, let $(E_n)$ be a sequence of disjoint sets in $\mathcal{A}$ and calculate
\[ \nu\left(\biguplus_{n\in\N}E_n\right) = \mu\left(A\cap \biguplus_{n\in\N}E_n\right) = \mu\left(\biguplus_{n\in\N}(A\cap E_n)\right) = \sum_{n\in\N}\mu(A\cap E_n) = \sum_{n\in\N}\nu(E_n). \]
\end{proof}
\begin{corollary} \label{integralContinuousInDomain}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $s:\Omega\to[0,+\infty]$a measurable simple function and $(E_n)$ a converging sequence in $\mathcal{A}$. Then
\[ \lim_{n\to\infty}\int_{E_n}s\diff{\mu} = \int_{\lim_{n\to\infty} E_n}s\diff{\mu}. \]
\end{corollary}
\begin{proof}
Define the measure $\nu: E\mapsto \int_E s\diff{\mu}$. Then by TODO ref
\[ \lim_{n\to\infty}\int_{E_n}s\diff{\mu} = \lim_{n\to\infty}\nu(E_n) = \nu(\lim_{n\to\infty}E_n) =\int_{\lim_{n\to\infty}E_n}s\diff{\mu}. \]
\end{proof}

\subsection{Positive real functions}
\begin{definition}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and let $f:\Omega\to[0,+\infty]$ be a positive measurable function. Define

We define the \udef{Lebesgue integral} of $f$ on $\Omega$ w.r.t. $\mu$ as
\[ \int_\Omega f \diff{\mu} \defeq \sup\setbuilder{\int_\Omega s \diff{\mu}}{s\in\SF(\Omega, [0,+\infty[)\;\land\; s\leq f}. \]
We call $f$ \udef{integrable} when $\int_\Omega f \diff{\mu} < \infty$.
\end{definition}
For simple functions this definition corresponds to the previous one by \ref{integrationOrderPreserving}.

This definition a priori makes sense even when $f$ is not assumed to be measurable. However the integral has undesirable properties in this case, such as not being additive.

\begin{example}
If $\delta_x$ is the Dirac measure associated to a point $x\in\Omega$ in a measurable space, then
\[ \int_\Omega f \diff{\delta_x} = f(x). \]
\end{example}

\begin{lemma} \label{integralOverSubset}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $E\in\mathcal{A}$ and $f:\Omega\to \R^+$ a measurable function. Then
\[ \int_E f \diff{\mu} = \int_\Omega f\cdot\chi_{E} \diff{\mu}. \]
\end{lemma}
\begin{proof}
TODO follows from \ref{simpleIntegralOverSubset}
\end{proof}
\begin{corollary}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $E\in\mathcal{A}$ and $f:\Omega\to \R^+$ a measurable function. Then
\begin{enumerate}
\item $\int_\Omega f\diff{\mu} = \int_{\Omega\setminus E} f\diff{\mu}+\int_E f\diff{\mu}$.
\end{enumerate}
\end{corollary}

\begin{proposition} \label{propertiesIntegralPositiveFunctions}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and let $f,g:\Omega\to[0,+\infty]$ be positive measurable functions. Then
\begin{enumerate}
\item if $f\leq g$, then $\int_\Omega f\diff{\mu} \leq \int_\Omega g\diff{\mu}$;
\item if $E_1\subseteq E_2$ are events in $\mathcal{A}$, then $\int_{E_1}f\diff{\mu} \leq \int_{E_2}f\diff{\mu}$;
\item \textup{(Beppo Levi's lemma)} if $(f_n)$  is an increasing sequence of positive functions that converges to $f$ point-wise, then $(\int_\Omega f_n\diff{\mu})_n$ is an increasing sequence and
\[ \lim_{n\to\infty}\int_\Omega f_n\diff{\mu} = \int_\Omega \lim_{n\to\infty}f_n\diff{\mu} = \int_\Omega f\diff{\mu}; \]
\item the integral is positive linear: $\forall c\geq 0$:
\[ \int_\Omega(cf+g)\diff{\mu} = c\int_\Omega f\diff{\mu} + \int_\Omega g\diff{\mu}. \]
\end{enumerate}
\end{proposition}
\begin{proof}
(1) For all $s\in \SF(\Omega, \interval[co]{0,+\infty})$ we have that $s\leq f$ implies $s\leq g$.

(2) This follows from $f\cdot\chi_{E_1}\leq f\cdot\chi_{E_2}$ and \ref{simpleIntegralOverSubset}.

(3) That the sequence $(\int_\Omega f_n\diff{\mu})_n$ is increasing follows from point 1. For increasing sequences the limits are suprema, by monotone convergence \ref{sequenceMonotoneConvergence}. Also, for all $m\in\N$, we have $f_m\leq\sup_{n\in\N}f_n$, which implies, by point 1., that $\int_\Omega f_m\diff{\mu}\leq \int_\Omega \sup_{n\in\N}f_n\diff{\mu}$. So
\[ \lim_{n\to\infty}\int_\Omega f_n\diff{\mu} = \sup_{n\in\N}\int_\Omega f_n\diff{\mu} \leq \int_\Omega \sup_{n\in\N}f_n\diff{\mu} = \int_\Omega \lim_{n\to\infty}f_n\diff{\mu}. \]
For the other inequality, it is enough to prove that $c\int_\Omega s\diff{\mu} \leq \lim_{n\to\infty}\int_\Omega f_n\diff{\mu}$ for all $0<c<1$ and $s\in\SF(\Omega,[0,+\infty[)$ such that $s\leq f$. Fix such a $c$ and $s = \sum_{i=1}^k\lambda_i\chi_{A_i}$. Consider the sets
\[ E_n = \setbuilder{x\in\Omega}{cs(x)\leq f_n(x)} = \bigcup_{i=1}^k \left(f^{-1}_n[\,[c\lambda_i, +\infty]\,]\cap A_i\right). \]
Then $(E_n)$ is an increasing sequence in $\mathcal{A}$ with $\Omega= \bigcup_{n\in\N}E_n$ and
\[ c\int_\Omega s\diff{\mu} = \int_{\bigcup_n E_n} cs\diff{\mu} = \lim_{n\to\infty}\int_{E_n} cs\diff{\mu} \]
by \ref{integralContinuousInDomain}. Also 
\[ \int_{E_n} cs\diff{\mu} \leq \int_{E_n} f_n\diff{\mu} \leq \int_{\Omega} f_n\diff{\mu} \]
by the previous points and so the result follows from the fact that limits preserve inequalities, \ref{limitPreservesInequality}.

(4) Take sequences $(s_n)$ and $(t_n)$ of positive measurable step functions
that increase pointwise to $f$ and $g$, respectively. Then $cs_n+t_n$ converges pointwise to $cf+g$ by the linearity of the limit and
\begin{align*}
\int_\Omega(cf+g)\diff{\mu} &= \lim_{n\to\infty}\int_\Omega(cs_n+t_n)\diff{\mu} \\
&= \lim_{n\to\infty}\left(c\int_\Omega s_n\diff{\mu}+\int_\Omega t_n\diff{\mu}\right) \\
&= c\lim_{n\to\infty}\int_\Omega s_n\diff{\mu}+\lim_{n\to\infty}\int_\Omega t_n\diff{\mu} \\
&= c\int_\Omega f\diff{\mu} + \int_\Omega g\diff{\mu}.
\end{align*}
\end{proof}

\begin{proposition}[Fatou's lemma] \label{FatouLemma}
Let $\sSet{\Omega, \mathcal{A}, \mu}$ be a measure space and $\seq{h_n}$ any sequence of positive measurable functions in $(\Omega\to[0,+\infty])$. Then
\[ f: \Omega\to[0,+\infty]: x\mapsto \liminf_{n\to\infty}h_n(x) \]
is measurable and
\[ \int_\Omega \liminf_{n\to\infty}h_n\diff{\mu} \leq \liminf_{n\to\infty}\int_\Omega h_n\diff{\mu}. \]
\end{proposition}
\begin{proof}
Consider the sequence $\seq{f_n}$ defined by $f_n(x) = \inf_{k\geq n}h_k(x)$. This is an increasing sequence of positive functions and $f_n \leq h_n$ for all $n\in\N$. Each $f_n$ is measurable because
\[ f_n^{-1}[\,[t,+\infty]\,] = \bigcap_{k=n}^\infty h_k^{-1}[\,[t,+\infty]\,]. \]
This shows that $f$ is measurable by \ref{pointWiseConvergenceMeasurable}. Then we can use Beppo Levi's lemma \ref{propertiesIntegralPositiveFunctions} to obtain
\[ \int_\Omega\liminf_{n\to\infty}h_n\diff{\mu} = \lim_{n\to\infty}\int_\Omega f_n\diff{\mu} = \liminf_{n\to\infty}\int_\Omega f_n\diff{\mu} \leq \liminf_{n\to\infty}\int_\Omega h_n\diff{\mu} \]
using monotonicity of the integral \ref{propertiesIntegralPositiveFunctions} and liminf \ref{propertiesIntegralPositiveFunctions} for the last inequality.
\end{proof}

\begin{proposition} \label{functionPropertiesFromIntegral}
Let $\seq{\Omega, \mathcal{A}, \mu}$ be a measure space and $f:\Omega\to[0,+\infty]$ a positive measurable function. Then
\begin{enumerate}
\item $\int_\Omega f\diff{\mu} = 0$ \textup{if and only if} $f(x) = 0$ a.e.;
\item if $f$ is integrable, then $f(x)< +\infty$ a.e.\
\end{enumerate}
\end{proposition}
\begin{proof}(1) Set $E = \setbuilder{x\in\R}{f(x) \neq 0}$. Then $f(x) = 0$ a.e.\ is equivalent to $\mu(E) = 0$.

Assume $\mu(E) = 0$, then 
\[ \int_\Omega f\diff{\mu} = \int_{\Omega\setminus E} f\diff{\mu} + \int_E f\diff{\mu} = 0+\int_E f\diff{\mu} \leq \sup_{x\in E}(f(x)). \]
Now for all $s\in\SF(\Omega\to \interval[co]{0,+\infty})\cap \downset f$ we have
\[ 0\leq \int_E s \diff{\mu}\leq \max_x(s(x))\mu(E) = 0  \]
and so the supremum $\int_E f\diff{\mu}$ is zero as well.

Now assume $\int_\Omega f\diff{\mu} = 0$. Consider the sets $E_n = f^{-1}[\,]\frac{1}{n},+\infty]\,]$. Then $\frac{1}{n}\chi_{E_n}\in \downset f$ is simple. Hence $\frac{1}{n}\mu(E_n)\leq \int_\Omega f\diff{\mu} = 0$, meaning $\mu(E_n) = 0$ for all $n$. So $\mu(E) = \sup_{n\in\N}\mu(E_n) = 0$.

(2) Towards contraposition, assume the set $E = \setbuilder{x\in\R}{f(x) = +\infty}$ has non-zero measure. Then $a/\mu(E)\chi_E\in\SF(\Omega, \interval[co]{0,+\infty})\cap \downset f$ for all real $a>0$ and
\[  \int_\Omega f\diff{\mu} \geq \int_\Omega \frac{a\chi_E}{\mu(E)}\diff{\mu} = a  \]
so $f$ is not integrable.
\end{proof}

\subsubsection{Tonelli's theorem}

\begin{lemma} \label{tonelliLemma}
Let $\sSet{\Omega_1, \mathcal{A}_1,\mu_1}$, $\sSet{\Omega_2, \mathcal{A}_2, }$ be $\sigma$-finite measure spaces and $Q\in \mathcal{A}_1\otimes\mathcal{A}_2$. Then the section functions
\[ s_1^Q: \Omega_1 \to \overline{\R^+} :x \mapsto \mu_2(xQ) \qquad\text{and}\qquad s_2^Q: \Omega_2 \to \overline{\R^+} :y \mapsto \mu_1(Qy) \]
are measurable. Additionally, we have
\[ (\mu_1\otimes \mu_2)(Q) = \int_{\Omega_1}s_1^Q\diff{\mu_1} = \int_{\Omega_2}s_2^Q\diff{\mu_2}. \]
\end{lemma}
\begin{proof}
The functions are well-defined by \ref{setSectionMeasurable}.

We restrict our attention to $s_1^Q$. The case for $s_2^Q$ is similar. Fix arbitrary $x\in\Omega_1$.

If $Q = A_1\times A_2$ for some $A_1\in\mathcal{A}_1$ and $A_2\in\mathcal{A}_2$, then
\[ s_1^Q(x) = \mu_2\setbuilder{\omega\in\Omega_2}{(x,\omega)\in A_1\times A_2} = \left(\begin{cases}
\mu_2(\emptyset) & (x\notin A_1) \\
\mu_2(A_2) & (x\in A_1)
\end{cases}\right) = \mu_2(A_2)\cdot \chi_{A_1}(x), \]
so $s_1^Q$ is measurable and
\[ \int_{\Omega_1}s_1^Q\diff{\mu_1} = \int_{\Omega_1}\mu_2(A_2)\cdot \chi_{A_1}\diff{\mu_1} = \mu_1(A_1)\cdot\mu_2(A_2), \]
by \ref{measureFromIntegralCharacteristicFunctions}.

Set $\mathcal{C} = \setbuilder{A_1\times A_2}{A_1\in\mathcal{A}_1, A_2\in\mathcal{A}_2}$ let $\mathcal{D}$ be the set of $P\in\Omega_1\times\Omega_2$ such that $s_1^P$ is measurable and $(\mu_1\otimes \mu_2)(Q) = \int_{\Omega_1}s_1^Q\diff{\mu_1}$. We want to prove $\sigma(\mathcal{C}) \subseteq \mathcal{D}$. As $\mathcal{C}$ is a $\pi$-system, it is enough to show that $\mathcal{D}$ is a Dynkin system by the $\pi$-$\lambda$ theorem \ref{piLambdaTheorem}.
We verify:
\begin{itemize}
\item $\Omega_1\times\Omega_2\in\mathcal{D}$, because $\Omega_1\times\Omega_2 \in \mathcal{C}\subseteq \mathcal{D}$;
\item Take $P\in\mathcal{D}$. Fix some monotone sequence $\seq{B_n}_{n\in\N}$ in $\mathcal{A}_2$ of finite measure whose union is $\Omega_2$, as in \ref{sigmaFiniteSequences}. 

We calculate (TODO: fix calculation)
\begin{align*}
s_1^{P^c}(x) &= \mu_2(xP^c) = \mu_2\big((xP)^c\big) = \mu_2\bigg(\Big(\bigcup_{n\in\N} B_n\Big)\setminus xP\bigg) \\
&= \sup_{n\in\N}\mu_2\big(B_n\setminus xP\big) = \sup_{n\in\N}\Big(\mu_2(B_n) - \mu_2(B_n\cap xP)\Big) = \sup_{n\in\N}\Big(\mu_2(B_n) - s_1^P(x)\Big).
\end{align*}
As $s_1^P$ is measurable, $s_1^{P^c}$ is measurable by \ref{operationsOnRealMeasurableFunctions} and \ref{limitOperationsOnRealMeasurableFunctions}.

Now similarly fix some monotone sequence $\seq{C_n}_{n\in\N}$ in $\mathcal{A}_1$ of finite measure whose union is $\Omega_1$. TODO finish proof!!

\item If $\seq{P}_{n\in\N}\in\mathcal{D}^\N$ is a sequence of pairwise disjoint sets, then, by a calculation similar to the one in the proof of \ref{setSectionMeasurable}, we have
\[ s_1^{\biguplus_{n\in\N}P_n}(x) = \mu_2\Big(\biguplus_{n\in\N}xP_n\Big) = \sum_{n\in\N}s_1^{P_n}(x). \]
Thus $s_1^{\biguplus_{n\in\N}P_n}$ is measurable by \ref{infiniteSumMeasurable} and $\biguplus_{n\in\N}P_n\in\mathcal{D}$.
\end{itemize}
\end{proof}

\begin{theorem}[Tonelli's theorem] \label{tonellisTheorem}
Let $\sSet{\Omega_1, \mathcal{A}_1, \mu_1}$, $\sSet{\Omega_2, \mathcal{A}_2, \mu_2}$ be $\sigma$-finite measure spaces and $f: \Omega_1\times\Omega_2 \to \overline{\R^+}$ a measurable function. Then the functions
\[ x\mapsto \int_{\Omega_2}f(x,y)\diff{\mu_2(y)} \qquad\text{and}\qquad y\mapsto \int_{\Omega_1}f(x,y)\diff{\mu_1(x)} \]
are measurable. Also
\[ \int_{\Omega_1\times\Omega_2}f\diff{(\mu_1\otimes\mu_2)} = \int_{\Omega_2}\Big(\int_{\Omega_1}f(x,y)\diff{\mu_1(x)}\Big)\diff{\mu_2(y)} = \int_{\Omega_1}\Big(\int_{\Omega_2}f(x,y)\diff{\mu_2(y)}\Big)\diff{\mu_1(x)}. \]
\end{theorem}
\begin{proof}
Let $s: \Omega_1\times\Omega_2 \to \overline{\R^+}$ be a measurable simple function. Then $s(x,-)$ is a measurable (by \ref{partialApplicationMeasurable}) simple function and we have
\[ \int_{\Omega_2}s(x,y)\diff{\mu_2(y)}  = \sum_{\lambda\in\im\big(s(x,-)\big)}\lambda\cdot\mu_2(xs^{-1}(\lambda)). \]
Thus $x\mapsto \int_{\Omega_2}s(x,y)\diff{\mu_2(y)}$ is, by \ref{tonelliLemma}, a linear combination of measurable functions and thus measurable by \ref{operationsOnRealMeasurableFunctions}.

By \ref{measurableFunctionPointwiseLimitSimpleFunctions} we can approximate $f$ by an increasing sequence $\seq{s_n}$ of simple functions that converges to $f$ pointwise.

By Beppo Levi's lemma \ref{propertiesIntegralPositiveFunctions}, we have
\[ \int_{\Omega_2}f(x,y)\diff{\mu_2(y)} = \lim_{n\to\infty}\int_{\Omega_2}s_n(x,y)\diff{\mu_2(y)}, \]
which is a limit of measurable positive functions and thus measurable by \ref{limitOperationsOnRealMeasurableFunctions}.

Now we calculate, using \ref{tonelliLemma},
\begin{align*}
\int_{\Omega_2}\Big(\int_{\Omega_2}s(x,y)\diff{\mu_2(y)}\Big)\diff{\mu_1(x)} &= \sum_{\lambda\in\im\big(s(x,-)\big)}\lambda\cdot \int_{\Omega_2} \mu_2(xs^{-1}(\lambda)) \diff{\mu_1(x)} \\
&= \sum_{\lambda\in\im(s)}\lambda\cdot (\mu_1\otimes\mu_2)\big(s^{-1}(\lambda)\big) \\
&= \int_{\Omega_1\times\Omega_2}s \diff{(\mu_1\otimes
\mu_2)}.
\end{align*}
For the general case, we again argue using Beppo Levi's lemma \ref{propertiesIntegralPositiveFunctions}.
\end{proof}

\subsubsection{Integral inequalities}
\begin{proposition}[Markov's inequality]
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $f:\Omega\to\R^+$ a positive measurable function and $\alpha>0$. Then
\[ \mu\setbuilder{\omega\in\Omega}{f(\omega)\geq \alpha} \leq \frac{1}{\alpha}\int_\Omega f\diff{\mu}. \]
\end{proposition}
Also called Chebyshev's inequality or Chebyshev's first inequality. The next inequality would then be Chebyshev's second inequality. 
\begin{proof}
We have $\alpha\cdot [f(\omega)\leq \alpha]\leq f(\omega)$, so
\[ \alpha\cdot \mu\setbuilder{\omega\in\Omega}{f(\omega)\geq \alpha} = \alpha \int_{\Omega}[f(\omega)\leq \alpha]\diff{\mu(\omega)} = \int_{\Omega}\alpha[f(\omega)\leq \alpha]\diff{\mu(\omega)} \leq \int_\Omega f\diff{\mu}, \]
using \ref{measureFromIntegralCharacteristicFunctions} and \ref{propertiesIntegralPositiveFunctions}. This implies Markov's inequality.
\end{proof}
\begin{corollary}[Chebyshev's inequality]
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $f:\Omega\to\R$ a measurable function, $\varphi:\im(f) \to \R^+$ a monotone measurable function and $\alpha>0$. Then
\[ \mu\setbuilder{\omega\in\Omega}{f(\omega)\geq \alpha} \leq \frac{1}{\varphi(\alpha)}\int_\Omega \varphi\circ f\diff{\mu}. \]
\end{corollary}
\begin{proof}
Since $\varphi$ is monotone, we have $\setbuilder{\omega\in\Omega}{f(\omega)\geq \alpha} \subseteq \setbuilder{\omega\in\Omega}{\varphi\big(f(\omega)\big)\geq \varphi(\alpha)}$, so
\[ \mu\setbuilder{\omega\in\Omega}{f(\omega)\geq \alpha} \leq \mu\setbuilder{\omega\in\Omega}{\varphi\big(f(\omega)\big)\geq \varphi(\alpha)} \leq \frac{1}{\varphi(\alpha)}\int_\Omega \varphi\circ f\diff{\mu}. \]
\end{proof}
By choosing specific functions $\varphi$, we obtain the following forms of Chebyshev's inequality:
\begin{corollary} \label{ChebyshevInequalityCorollary}
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space, $f:\Omega\to\R^+$ a positive measurable function, $\alpha>0$ and $0<p$. Then
\begin{enumerate}
\item $\mu\setbuilder{\omega\in\Omega}{f(\omega)\geq \alpha} \leq \frac{1}{\alpha^p}\int_\Omega f(\omega)^p\diff{\mu(\omega)}$;
\end{enumerate}
\end{corollary}

\subsection{Complex functions}
Let $\Omega$ be a set and $f:\Omega \to \C$ a function.  Then we can uniquely decompose $f$ into $f= u+iv$ where $u,v: \Omega\to \R$. We can further decompose
\[ \begin{cases}
u = u^+ - u^- & \text{such that $u^+u^- = 0$} \\
v = v^+ - v^- & \text{such that $v^+v^- = 0$.}
\end{cases} \]
If $\Omega $ carries a $\sigma$-algebra such that $f$ is measurable, then $u^+,u^-,v^+,v^-$ are also measurable.
\begin{definition}
Let $\seq{\Omega, \mathcal{A},\mu}$ be a measure space. We say a measurable function $f: \Omega \to \C$ is \udef{integrable}, if $|f|:\Omega\to [0,\infty[$ is integrable. In this case we define the \udef{integral} of $f$ as
\[ \int_\Omega f\diff{\mu} = \int_\Omega u^+\diff{\mu} - \int_\Omega u^-\diff{\mu} + i\int_\Omega v^+\diff{\mu} - i\int_\Omega v^-\diff{\mu}. \]
The set of all integrable functions in $(\Omega \to \C)$ is denoted $\mathcal{L} ^1(\Omega,\mathcal{A},\mu)$ or $\mathcal{L} ^1(\mu)$.
\end{definition}

TODO
\begin{proposition}[Reverse Fatou lemma]
Let $(\Omega, \mathcal{A}, \mu)$ be a measure space and $(h_n)$ any sequence of measurable functions that is dominated by a positive integrable function $g$ (i.e.\ $h_n\leq g$ for all $n\in\N$). Then
\[ f: \Omega\to[0,+\infty]: x\mapsto \limsup_{n\to\infty}h_n(x) \]
is measurable and
\[ \int_\Omega f\diff{\mu} \geq \limsup_{n\to\infty}\int_\Omega h_n\diff{\mu}. \]
\end{proposition}
\begin{proof}
By the corollary $g(x)<+\infty$ a.e.\ and so also $g-h_n<+\infty$ a.e. Applying Fatou's lemma \ref{FatouLemma} gives
\[ \int\liminf g-h_n \leq \liminf\int g-h_n\]
\end{proof}

\begin{theorem}[Dominated convergence]
Let $\sSet{\Omega, \mathcal{A}, \mu}$ be a measure space and $\seq{f_n}$ any sequence of real measurable functions in $(\Omega\to\R)$ that converges pointwise to a function $f$.

If there exists a positive integrable function $g$ such that $|f_n| \leq g$ for all $n\in \N$, then $f$ is integrable and
\[ \lim_{n\to \infty}\int_\Omega f_n \diff{\mu} = \int_\Omega f\diff{\mu}. \]
\end{theorem}
TODO: sufficiency of uniform continuity.
\begin{proof}
TODO
\end{proof}
\begin{corollary}[Bounded convergence theorem] \label{boundedConvergenceTheorem}
Let $\sSet{\Omega, \mathcal{A}, \mu}$ be a finite measure space and $\seq{f_n}$ any sequence of real measurable functions that converges pointwise to a function $f$.
\end{corollary}
TODO: \url{http://mathonline.wikidot.com/summary-of-convergence-theorems-for-lebesgue-integration}

\subsubsection{Fubini's theorem}
\begin{theorem}[Fubini's theorem]
Let $\sSet{\Omega_1, \mathcal{A}_1, \mu_1}$, $\sSet{\Omega_2, \mathcal{A}_2, \mu_2}$ be $\sigma$-finite measure spaces and $f: \Omega_1\times\Omega_2 \to \overline{\R}$ a measurable and integrable function. Then the functions
\[ x\mapsto \int_{\Omega_2}f(x,y)\diff{\mu_2(y)} \qquad\text{and}\qquad y\mapsto \int_{\Omega_1}f(x,y)\diff{\mu_1(x)} \]
are measurable and a.e. integrable. Also
\[ \int_{\Omega_1\times\Omega_2}f\diff{(\mu_1\otimes\mu_2)} = \int_{\Omega_2}\Big(\int_{\Omega_1}f(x,y)\diff{\mu_1(x)}\Big)\diff{\mu_2(y)} = \int_{\Omega_1}\Big(\int_{\Omega_2}f(x,y)\diff{\mu_2(y)}\Big)\diff{\mu_1(x)}. \]
\end{theorem}
\begin{proof}
TODO!
\end{proof}

TODO Fubini for complex- (and vector-)valued functions.

\subsection{Integration of vector-valued functions}
TODO: define integration by
\[ \inner{u, \int T(t)\diff{t} v} \defeq \int\inner{u,T(t)v}\diff{t} \]
??
This case Riemann?? Or only finite dim??

TODO: move

\subsubsection{Weak and strong measurability}
TODO is Bochner measurable measurable with $Y$ given Borel $\sigma$-algebra?

A function $f:X\to B$ is called Bochner-measurable if it is equal $\mu$-almost everywhere to a function $g$ taking values in a separable subspace $B_{0}$ of $B$, and such that the inverse image $g^{-1}[U]$ of every open set $U$ in $B$ belongs to $\Sigma$. Equivalently, $f$ is limit $\mu$-almost everywhere of a sequence of simple functions. 

\begin{theorem}[Pettis measurability theorem]
Let $(\Omega, \mathcal{A},\mu)$ be a measure space and $Y$ a normed vector space. Then $f$ is strongly measurable \textup{if and only if} $f$ is weakly measurable and almost surely separably valued.
\end{theorem}



\subsubsection{Pettis integration}


\section{Further topics}
TODO rename!

\subsection{Absolute continuity and mutual singularity}
\begin{definition}
Let $\mu,\nu$ be measures on the measurable space $(\Omega,\mathcal{A})$. We say
\begin{itemize}
\item $\nu$ is \udef{absolutely continuous} w.r.t. $\mu$ if $\mu(A)=0\implies \nu(A) = 0$ for all $A\in\mathcal{A}$;
\item $\mu$ and $\nu$ are \udef{mutually singular} if there exists a set $A\in\mathcal{A}$ with $\mu(A) = 0$ and $\nu(A^c) = 0$.
\end{itemize}
\end{definition}

\begin{theorem}[Radon-Nikodym]
Let $\mu,\nu$ be measures on the measurable space $(\Omega,\mathcal{A})$. Then $\nu$ is absolutely continuous w.r.t. $\mu$ \textup{if and only if} there exists a measurable function $f:\Omega\to\R$ (or $\C$?) such that
\[ \nu(A) = \int_\Omega f\cdot \chi_A \diff{\mu} \qquad \forall A\in\mathcal{A}. \]
The function $f$ is uniquely determined a.e.\ (w.r.t. $\mu$).
\end{theorem}

\subsection{Lebesgue decomposition}
\begin{theorem}[Lebesgue decomposition theorem]
Let $\mu, \nu$ be two measures on a measurable space $(\Omega, \mathcal{A})$. Then $\nu$ can be written uniquely as
\[ \nu = \nu_\text{ac} + \nu_\text{sing} \]
where $\mu$ and $\nu_\text{sing}$ are mutually singular and $\nu_\text{ac}$ is absolutely continuous w.r.t. $\mu$. 

\end{theorem}

\subsection{Convolution}
TODO Young's convolution inequality

\section{Duality in integration}
Distributions with kernels will be example.

\chapter{Real Analysis}
Dual numbers

Dini theorem

TODO: all versions of homogeneity.

The objects of study in real analysis are real functions, and more generally functions between Euclidean spaces, i.e.\ real, finite-dimensional, normed vector spaces.

\section{Limits}
In this section infinities can appear because we assume $\N$ and $\R$ are embedded in their Dedekind-MacNeille completions $\overline{\N} = \N\cup\{\infty\}$ and $\overline{\R} = \R\cup\{-\infty, +\infty\}$.

\url{https://en.wikipedia.org/wiki/Interchange_of_limiting_operations}


\subsection{Real functions}
Applying the definition of limits to functions in $\R$ gives the so-called $\varepsilon-\delta$ definition of limits:
\begin{proposition}
Let $f:A\subseteq\R\to\R$ be a real function and $p$ a limit point o $A$. Then $L\in \R$ is the limit of $f(x)$ as $x$ approaches $p$ \textup{if and only if}
\[ \forall \varepsilon>0: \exists \delta> 0: \forall x\in A: |x-p| < \delta \implies |f(x)-L|<\varepsilon. \]
\end{proposition}
TODO: criteria for limits involving infinities.

In addition we can define some special types of limits.
\begin{definition}
Let $f:A\subseteq\R\to\R$ be a function and $p$ a limit point of $A$. Then
\begin{itemize}
\item the \udef{left limit} of $f(x)$ as $x$ approaches $p$ is the limit of $f|_{A\cap]-\infty,p]}$ as $x\to p$, denoted
\[ \lim_{x\overset{<}{\to} p}f(x) \qquad \text{or} \qquad \lim_{x\to p^-}f(x); \]
\item the \udef{right limit} of $f(x)$ as $x$ approaches $p$ is the limit of $f|_{A\cap[p,+\infty[}$ as $x\to p$, denoted
\[ \lim_{x\overset{>}{\to} p}f(x) \qquad \text{or} \qquad \lim_{x\to p^+}f(x). \]
\end{itemize}
\end{definition}

\begin{lemma}
Let $f:A\subseteq\R\to\R$ be a function and $p$ a limit point of both $A\cap]-\infty,p]$ and $A\cap[p,+\infty[$. Then $\lim_{x\to p} f(x)$ exists if the left and right limit exist and are equal to each other. In this case
\[ \lim_{x\to p} f(x) = \lim_{x\to p^-} f(x) = \lim_{x\to p^+} f(x). \]
\end{lemma}

\subsection{Properties of limits}
TODO: for functions $X\to \R$.

We enumerate some of the properties for limits here. These properties are valid for all types of limit of real functions, so long as all limits in the equation are limits to the same point (or infinity, TODO elaborate!).  In fact the properties also hold true for sequences of real numbers.
\begin{itemize}
\item Taking the limit is a linear operation:
\[\lim  (f(x) + g(x)) = \lim  f(x) + \lim g(x)\]
\[\lim  (a\cdot f(x)) = a\cdot \lim  f(x) \qquad \forall a \in \R\]
\item The limit of the product:
\[ \lim (f(x)\cdot g(x)) = \left(\lim  f(x)\right) \cdot \left(\lim  g(x)\right) \]
\item The limit of the quotient (assuming $\lim  g(x) \neq 0$):
\[ \lim \left(\frac{f(x)}{g(x)}\right) = \frac{\lim  f(x)}{\lim  g(x)}  \]
\item The limit of a power (with $m$ an integer and $n$ a positive integer):
\[ \lim  [f(x)]^{m/n} = \left(\lim  f(x)\right)^{m/n} \]
\item Partial order is preserved. Assume $f(x) \leq g(x)$ on some interval containing $x_0$. Then
\[ \lim f(x) \leq \lim g(x) \]
The same is not true for the strict order $<$!
\end{itemize}

\subsubsection{The squeeze theorem}

\section{Continuity}
\begin{proposition}
Let $f:A\subseteq\R\to\R$ be a function and $p\in A\cap A'$, where $A'$ is the set of limit points of $A$. Then
\[ \text{$f$ is continuous at $p$} \quad\iff\quad \lim_{x\to p}f(x) = f(x). \]
\end{proposition}

\subsection{Left and right continuity}
TODO

\subsection{Discontinuities}
If a function $f:A\subseteq\R\to\R$ is not continuous at $p$, then $p$ is a limit point of $A$ by \ref{continuityAtIsolatedPoint} and \ref{notLimitPointSingletonOpen}.
\begin{definition}
Let $f:A\subseteq\R\to\R$ be a function and $p\in A$ such that $f$ is not continuous at $p$. Then
\begin{itemize}
\item if $\lim_{x\to p}f(x)$ exists and is finite, we call $p$ a \udef{removable discontinuity};
\item if both $\lim_{x\to p^-}f(x)$ and $\lim_{x\to p^+}f(x)$ exist and are finite, but are different, we call $p$ a \udef{jump discontinuity};
\item if either $\lim_{x\to p^-}f(x)$ or $\lim_{x\to p^+}f(x)$ do not exist, we call $p$ an \udef{essential discontinuity}.
\end{itemize}
Removable and jump discontinuities are also called \udef{discontinuities of the first kind}. Essential discontinuities are also called \udef{discontinuities of the second kind}.
\end{definition}
TODO: should discontinuities of type 1/x be considered essential?

\subsubsection{Jump discontinuities}
\begin{proposition} \label{monotoneDiscontinuities}
Let $f$ be a monotone real-valued function on an interval $I$. Then all discontinuities are jump discontinuities.
\end{proposition}
\begin{theorem}[Darboux-Froda] \label{DarbouxFroda}
Let $f$ be a monotone real-valued function on an interval $I$. Then the set of discontinuities is at most countable.
\end{theorem}

TODO: intervals must be closed / open?? In \ref{monotoneDiscontinuities} and \ref{DarbouxFroda}.


\begin{definition}
Let $f$ be a real function. We define the \udef{difference operator}
\[ \Delta_{x_0}f \defeq \lim_{x\to x_0+} f(x) - \lim_{x\to x_0-} f(x) \]
\end{definition}

\section{Riemann integration}
\subsection{Riemann-Stieltjes}

\begin{lemma} \label{rectanglePartitionedByMonotonicFunction}
Let $f: \R^+ \to \R^+$ be an invertible monotonic function and $a\in\R^+$. Then
\[ a\cdot f(a) = \int_0^a f(x)\diff{x} + \int_0^{f(a)} f^{-1}(y)\diff{y}. \]
\end{lemma}
\begin{proof}
We will be evaluating the integral $a\cdot f(a) = \iint_{(x,y)\in S}\diff{x}\diff{y}$, where $S = \setbuilder{(x,y)\in \R^2}{x\leq a, y\leq f(a)}$. To that end, note the partition
\begin{align*}
S &= \setbuilder{(x,y)\in S}{y\leq f(x)} \uplus \setbuilder{(x,y)\in S}{y > f(x)} \\
&= \setbuilder{(x,y)\in S}{y\leq f(x)} \uplus \setbuilder{(x,y)\in S}{x < f^{-1}(y)} \\
&\eqdef S_1 \uplus S_2.
\end{align*}
Then we can calculate
\begin{align*}
ab = \iint_{(x,y)\in S_1}\diff{x}\diff{y} + \iint_{(x,y)\in S_2}\diff{x}\diff{y} \\
\int_0^a\int_0^{f(x)}\diff{y}\diff{x} + \int_0^{f(a)}\int_0^{f^{-1}(y)}\diff{x}\diff{y} \\
\int_0^a\int_0^{f(x)}\diff{y}\diff{x} + \int_0^{f(a)}\int_0^{f^{-1}(y)}\diff{x}\diff{y} \\
\int_0^a f(x)\diff{x} + \int_0^{f(a)} f^{-1}(y)\diff{y}.
\end{align*}
\end{proof}

\section{Inequalities}

\subsection{Young's inequality}
TODO: compare (+use) Jensen's inequality.

\subsubsection{Hölder conjugates}
\begin{definition}
Two numbers $p,q\in \R^+$ are called \udef{Hölder conjugate} iff $p^{-1} + q^{-1} = 1$.
\end{definition}

\begin{lemma}
Let $p\in \R^+$. Then $p$ is Hölder conjugate to some $q\in \R^+$ \textup{if and only if} $p > 1$.
\end{lemma}

\begin{lemma} \label{HoelderConjugateEquivalents}
Let $p,q\in \R^+$. The following are equivalent:
\begin{enumerate}
\item $p$ and $q$ are Hölder conjugate (i.e.\ $p^{-1}+q^{-1} = 1$);
\item $p+q = pq$;
\item $(p-1)(q-1) = 1$;
\item $(p-1) = (q-1)^{-1}$;
\item $p = \frac{q}{q-1}$;
\item $q = \frac{p}{p-1}$;
\item $pq^{-1} = p-1$;
\item $qp^{-1} = q-1$.
\end{enumerate}
\end{lemma}

\subsubsection{Young's inequality}
\begin{theorem}[Young's inequality] \label{YoungsInequality}
Let $p,q\in \R$ be such that $p>0, q>0$ and $p^{-1} + q^{-1} = 1$. Then for all $a,b \geq 0$, we have
\[ ab \leq \frac{a^p}{p} + \frac{b^q}{q}. \]
Equality holds \textup{if and only if} $b = a^{p-1}$.
\end{theorem}
\begin{proof}[Proof using convexity of exponentiation]
If either $a=0$ or $b =0$, then the result is immediate. Now assume $a>0$ nad $b>0$. Then
\begin{align*}
ab &= e^{\ln(ab)} \\
&= e^{\ln(a)+\ln(b)} \\
&= e^{p^{-1}p\ln(a)+q^{-1}q\ln(b)} \\
&= e^{p^{-1}\ln(a^p)+(1-p^{-1})\ln(b^q)} \\
&\leq p^{-1}e^{\ln(a^p)}+(1-p^{-1})e^{\ln(b^q)} \\
&= \frac{a^p}{p} + \frac{b^q}{q}.
\end{align*}
The inequality is due to the convexity of the exponentiation. It is an equality (TODO ref strict convexity) iff
\begin{align*}
\ln(b^q) = \ln(a^p) &\iff b^q = a^p \\
&\iff b = a^{pq^{-1}} = a^{p-1}.
\end{align*}
The last equality follows from \ref{HoelderConjugateEquivalents}.
\end{proof}
\begin{proof}[Geometric proof]
From \ref{HoelderConjugateEquivalents}, we have $(x\mapsto x^{p-1})^{-1} = y\mapsto y^{q-1}$. These functions are monotone (TODO ref).

We have either $a^{p-1}\leq b$ or $b\leq a^{p-1} \iff b^{q-1} \leq a$. If the second option holds, we swap $a$ with $b$ and $p$ with $q$.

Now we can calculate, using \ref{rectanglePartitionedByMonotonicFunction},
\begin{align*}
ab &= aa^{p-1} + a(b-a^{p-1}) \\
&= \int_0^a x^{p-1}\diff{x} + \int_0^{a^{p-1}} y^{q-1}\diff{y} + a(b-a^{p-1}) \\
&= \int_0^a x^{p-1}\diff{x} + \int_0^{a^{p-1}} y^{q-1}\diff{y} + \int_{a^{p-1}}^b a\diff{y} \\
&\leq \int_0^a x^{p-1}\diff{x} + \int_0^{a^{p-1}} y^{q-1}\diff{y} + \int_{a^{p-1}}^b y^{q-1}\diff{y} \\
&= \int_0^a x^{p-1}\diff{x} + \int_0^{b} y^{q-1}\diff{y} \\
&= \frac{a^p}{p} + \frac{b^q}{q}.
\end{align*}
TODO picture.

We clearly have equality iff $a^{p-1} = b$.
\end{proof}

\section{Maximal functions and differentiation}
\subsection{The Hardy-Littlewood maximal operator}
\begin{definition}
Let $f$ be a locally integrable function on $\R^n$. The function $\HLmax(f): \R^n\to \overline{\R^+}$ defined by
\[ \HLmax(f)(x) = \sup \]
\end{definition}



\chapter{Complex analysis}
\begin{definition}
A \udef{complex function} is a function in $(U\subseteq \C \to \C)$.
\end{definition}
\section{The complex numbers as a real algebra}
The set of complex numbers $\C$ is isomorphic to the algebra $\R^2$ where multiplication is defined by
\[ (a, b)\cdot (x, y) \defeq (ax-by, ay+bx). \]
Thus the regular representation $\rho_{(a,b)}$ has matrix
\[ \begin{pmatrix}
a & -b \\ b & a
\end{pmatrix}. \]

\section{Holomorphic functions}
\begin{definition}
Let $f:U\subseteq \C \to \C$ be a complex function. We say
\begin{enumerate}
\item $f$ is \udef{holomorphic  at $z\in U$} if the limit $\lim_{h\to 0} \dfrac{f(z+h) - f(z)}{h}$
exists;
\item $f$ is \udef{holomorphic in $S\subset U$} if it is holomorphic at every point in $S$;
\item $f$ is \udef{holomorphic} if it is holomorphic at every point in $U$;
\item $f$ is \udef{entire} if $U=\C$ and it is holomorphic at every point in $\C$.
\end{enumerate}
\end{definition}

\begin{lemma}
Holomorphic functions are continuous.
\end{lemma}
\begin{lemma}
Let $f,g$ be holomorphic. Then
\begin{enumerate}
\item $f+g$ is holomorphic and $(f+g)' = f'+g'$;
\item $fg$ is holomorphic and $(fg)' = f'g+fg'$;
\item if $g(z_0)\neq 0$, then $f/g$ is holomorphic at $z_0$ and
\[ (f/g)' = \frac{f'g - fg'}{g^2}; \]
\item the chain rule holds.
\end{enumerate}
\end{lemma}

\subsection{Cauchy-Riemann equations}
The space of complex numbers $\C$ is a real $2$-dimensional vector space.

\begin{lemma}
Let $f: U\subseteq \C \to C$ be a complex function. Then $f$ is holomorphic \textup{if and only if} it is Fréchet differentiable as a function $F: V\subseteq \R^2 \to \R^2$ and $\diff F$ is the regular representation of some $z\in \C$.
\end{lemma}
\begin{corollary}[Cauchy-Riemann equations]
Let $f: U\subseteq \C \to C$ be a complex function. Then $f$ is complex differentiable at $z_0 = a+bi$ \textup{if and only if} the real derivatives
\[ \pd{\Re(f(a + ib))}{a},\; \pd{\Re(f(a + ib))}{b},\;
\pd{\Im(f(a + ib))}{a} \;\;\text{and}\;\; \pd{\Im(f(a + ib))}{b}. \]
exist, are continuous and the equations
\[
\pd{\Re(f(a + ib))}{a} = \pd{\Im(f(a + ib))}{b} \quad\text{and}\quad \pd{\Re(f(a + ib))}{b} = -\pd{\Im(f(a + ib))}{a} \]
hold. In particular
\[ |f'(z_0)|^2 = \det J_f(a,b) \]
where $\det J_f(a,b)$ is the Jacobian determinant of $f$ as a function $V\subseteq \R^2 \to \R^2$.
\end{corollary}
\begin{proof}
We need the Jacobian
\[ \begin{pmatrix}
\pd{\Re(f(a + ib))}{a} & \pd{\Re(f(a + ib))}{b} \\
\pd{\Im(f(a + ib))}{a} & \pd{\Im(f(a + ib))}{b}
\end{pmatrix} \]
to be of the form $\begin{pmatrix}
x & -y \\ y & x
\end{pmatrix}$ in order for it to be a regular representation of some $f' =\pd{\Re(f(a + ib))}{a} + i\pd{\Im(f(a + ib))}{a} \in \C$. TODO ref requirement continuously differentiable.

The Jacobian determinant is a simple calculation:
\begin{align*}
\det J_f(a,b) &= \pd{\Re(f(a + ib))}{a}\pd{\Im(f(a + ib))}{b} - \pd{\Im(f(a + ib))}{a}\pd{\Re(f(a + ib))}{b} \\
&= \pd{\Re(f(a + ib))}{a}^2 + \pd{\Im(f(a + ib))}{a}^2 = |f'|^2.
\end{align*}
\end{proof}

\subsection{Cauchy's theorem, Morera's theorem and the integral formula}

\begin{theorem}[Cauchy's theorem] \label{CauchyTheorem}
Let $f: U\subseteq \C \to \C$ be a holomorphic complex function and $\gamma$ a simple closed Jordan curve whose interior lies in $U$. Then
\[ \oint_\gamma f(z)\diff{z} = 0. \]
\end{theorem}
TODO: looser requirements for $\gamma$
\begin{proof}
TODO: generalised Stokes + Cauchy-Riemann!
\end{proof}
\begin{corollary}
Let $f: U\subseteq \C \to \C$ be a holomorphic complex function. Then there exists a primitive $F: U\to \C$ such that $\od{F}{z} = f$.
\end{corollary}
\begin{proof}
The integral $\int_\gamma f(z)\diff{z}$ depends only on the endpoints of $\gamma$.
\end{proof}

\begin{theorem}[Morera's theorem]
Let $f: U\subseteq \C \to \C$ be a complex function on an open set $U$ such that
\[ \oint_\gamma f(z) \diff{z} = 0 \]
for every closed, piecewise $C^1$ curve $\gamma$ in $U$, then $f$ is holomorphic.
\end{theorem}
\begin{proof}
$\int f(z)\diff{z}$ is a primitive, so $f$ is complex differentiable.
\end{proof}
TODO: triangles enough!

\begin{theorem}[Cauchy's integral formula]
Let $f: U\subseteq \C \to \C$ be a holomorphic complex function and $\gamma$ a simple closed Jordan curve whose interior lies in $U$. Then
\[ f(z) = \frac{1}{2\pi i}\oint_\gamma \frac{f(\zeta)}{\zeta - z}\diff{\zeta} \]
for any point $z$ in the interior of $\gamma$.
\end{theorem}
\begin{proof}
Let $C_{z,\epsilon}$ be a small circle inside $\gamma$ around $z$ of radius $\epsilon$ and opposite orientation (TODO explicate!). Then $\frac{f(\zeta)}{\zeta - z}$ is holomorphic in the region between $\gamma$ and $C_{z,\epsilon}$, so
\begin{align}
\oint_\gamma \frac{f(\zeta)}{\zeta - z}\diff{\zeta} &= -\oint_{C_{z,\epsilon}} \frac{f(\zeta)}{\zeta - z}\diff{\zeta} \\
&= -\oint_{C_{z,\epsilon}} \frac{f(\zeta)-f(z)}{\zeta - z} + \frac{f(z)}{\zeta - z}\diff{\zeta} \\
&= -\oint_{C_{z,\epsilon}} \frac{f(\zeta)-f(z)}{\zeta - z}\diff{\zeta} -\oint_{C_{z,\epsilon}}\frac{f(z)}{\zeta - z}\diff{\zeta}.
\end{align}
In the limit $\epsilon \to 0$, the first part is bounded by
\[ |\oint_{C_{z,\epsilon}} \frac{f(\zeta)-f(z)}{\zeta - z}\diff{\zeta}| \leq \sup_\zeta\left|\frac{f(\zeta)-f(z)}{\zeta - z}\right| \cdot |2\pi\epsilon| \to 0 \]
because $\frac{f(\zeta)-f(z)}{\zeta - z}$ remains bounded. For the second part, we have
\begin{align*}
-\oint_{C_{z,\epsilon}} \frac{f(z)}{\zeta - z}\diff{\zeta} &= f(z)\oint_{C_{z,\epsilon}} \frac{\diff{\zeta}}{\zeta - z} \\
&= f(z)\int_0^{2\pi}\frac{\epsilon ie^{-it}}{\epsilon e^{-it}}\diff{t} \\
&= f(z)2\pi i.
\end{align*}
\end{proof}
\begin{corollary}
Let $f: U\subseteq \C \to \C$ be a holomorphic complex function. Then $f$ has infinitely many complex derivatives and
\[ f^{(n)}(z) = \frac{n!}{2\pi i}\oint_\gamma \frac{f(\zeta)}{(\zeta-z)^{n+1}}\diff{\zeta} \]
for all $z$ in the interior of $\gamma$.
\end{corollary}
\begin{proof}
TODO
\end{proof}

\begin{proposition}
Let $f$ be holomorphic in an open set $\Omega$ and $D$ a
disc centered at $z_0$ whose closure is contained in $\Omega$. Then $f$ has a power series expansion at $z_0$
\[ f(z) = \sum_{n=0}^\infty a_n(z-z_0)^n \]
for all $z\in D$. The coefficients are given by
\[ a_n = \frac{f^{(n)}(z_0)}{n!} \qquad \text{for all $n\geq 0$}. \]
\end{proposition}
\begin{proof}
TODO
\end{proof}
\begin{corollary}
Let $f: \Omega\subseteq \C \to \C$ be a function and $\Omega$ an open set. Then $f$ is holomorphic \textup{if and only if} $f$ is analytic.
\end{corollary}
\begin{corollary}
If $f$ is holomorphic in an open
set that contains the closure of a disc $D$ centered at $z_0$ and of radius $R$,
then
\[  |f^{(n)}(z_0)| \leq \frac{n!\norm{f}_C}{R^n}, \]
where $\norm{f}_C = \sup_{z\in C}|f(z)|$.
\end{corollary}
\begin{proof}
TODO
\end{proof}
Thus the distance from $z_0$ to the nearest singular point is the radius of convergence of the power series.
\begin{corollary}[Liouville's theorem] \label{liouvilleTheoremAnalysis}
If $f$ is entire and bounded, then $f$ is contant.
\end{corollary}
\begin{proof}
It suffices to show that $f'(z_0) = 0$. This can be seen by taking $R\to\infty$ in the previous inequality.
\end{proof}
\begin{corollary}[Fundamental theorem of algebra]
Let $P(z) = a_nz^n + \ldots + a_0$ be a polynomial of degree $n\geq 1$ with complex coefficients. Then $P(z)$ has precisely $n$ roots. If these roots are denoted $w_1, \ldots, w_n$, then we can write
\[ P(z = a_n(z-w_1)(z-w_2)\ldots(z-w_n). \]
\end{corollary}

\begin{proposition}
Let $f: \Omega\subseteq \C\to \C$ be a complex function that is holomorphic in a region $U\subseteq \Omega$ that contains a closed annulus $\setbuilder{z\in \C}{r\leq|z-z_0|\leq R}$ for some $z_0\in \C$ and $r,R\in \R$. Then $f$ has a Laurent series expansion that converges in the interior of the annulus:
\[ f(z) = \sum_{i=-\infty}^\infty a_i(z-z_0)^i \]
for all $z\in \setbuilder{z\in \C}{r < |z-z_0| < R}$.
\end{proposition}
\begin{proof}
TODO
\end{proof}
TODO uniqueness ??? \url{https://en.wikipedia.org/wiki/Laurent_series#Uniqueness}

\subsection{Analytic continuation}
\begin{proposition}
Let $f:\Omega\subseteq \C\to \C$ be a holomorphic function on a connected open set $\Omega$. Suppose there exists a sequence of distinct points with limit point in $\Omega$ on which $f$ vanishes. Then $f = \underline{0}$.
\end{proposition}
\begin{proof}
TODO
\end{proof}
\begin{corollary}
Let $f,g:\Omega\subseteq \C\to \C$ be holomorphic functions on a connected open set $\Omega$. Suppose there exists a sequence of distinct points $\seq{z_n}$ with limit point in $\Omega$ such that $f(z_n) = g(z_n)$ for all $n$. Then $f = g$.
\end{corollary}
In particular this holds if $f$ and $g$ agree on some non-empty open subset of $\Omega$.
\begin{corollary}
Let $f:\Omega\subseteq \C\to \C$ be a holomorphic function on an open set $\Omega$ and $\Omega'\supseteq \Omega$ a connected open subset of $\C$. Then there exists at most one holomorphic function $f'$ on $\Omega'$ such that $f'|_\Omega = f$.
\end{corollary}

\begin{definition}
In this case the function $f'$ is called an \udef{analytic continuation} of $f$ into $\Omega'$.
\end{definition}

\begin{proposition}[Symmetry principle] \label{symmetryPrinciple}
Let $\Omega$ be an open subset of $\C$ such that $\overline{\Omega} = \Omega$. Denote by $\Omega^+$ the part of $\Omega$ that lies in the upper half plane and by $\Omega^-$ the part lying in the lower half plane. Set $I = \R \cap \Omega$.

Let $f^+: \Omega^+ \to \C$ and $f^-: \Omega^- \to \C$ be holomorphic functions that extend continuously to $I$ and
\[ \forall x\in I: \; f^+(x) = f^-(x). \]
Then the compound function
\[ f: \Omega \to \C: z\mapsto f(z) = \begin{cases}
f^+(z) & z\in \Omega^+ \\
f^+(z) = f^-(z) & z\in I \\
f^-(z) & z\in \Omega^-
\end{cases} \]
is holomorphic on all of $\Omega$.
\end{proposition}

\begin{proposition}[Schwarz reflection principle]
Let $\Omega, \Omega^+, \Omega^-$ and $I$ be as in \ref{symmetryPrinciple} and $f: \Omega^+ \to \C$ a holomorphic function that extends continuously to $I$. Then there exists a holomorphic function $g: \Omega\to \C$ such that $g|_{\Omega^+} = f$.
\end{proposition}
\begin{proof}
Idea: define $g|_{\Omega^-}(z) = \overline{f(\overline{z})}$. TODO details.
\end{proof}

\subsubsection{Analytic continuation along a curve}
\begin{theorem}[Monodromy theorem]
Let $f:D\subseteq \C \to \C$ be a holomorphic function and $\Omega$ the set of all points that admit an analytic continuation.

If two curves are homotopic in $\Omega$, then they give the same analytic continuation.
\end{theorem}

\subsection{Limits and holomorphic functions}
\begin{proposition}
Let $\seq{f_n}$ be a sequence of holomorphic functions on $\Omega$ that converges uniformly to a function $f$ in every compact subset of $\Omega$. Then
\begin{enumerate}
\item $f$ is holomorphic in $\Omega$;
\item $\seq{f_n'}$ converges uniformly to $f'$ on every compact subset of $\Omega$;
\item for all $k\in \N$, the sequence $\seq{f_n^{(k)}}$ converges uniformly to $f^{(k)}$ on every compact subset of $\Omega$.
\end{enumerate}
\end{proposition}
\begin{proof}
(1) TODO (+ \url{https://www.math.wustl.edu/~sk/limits.pdf})

(2) TODO

(3) By induction on $k$.
\end{proof}
TODO: this is part of the motivation for the compact-open topology (use this terminology?).

\begin{proposition}
Let $\Omega$ be a open set in $\C$ and $F: \Omega\times[0,1]\to \C$ a function such that
\begin{itemize}
\item $F(\cdot,s)$ is holomorphic (in the first variable) for all $s\in [0,1]$;
\item $F$ is continuous.
\end{itemize}
Then the function
\[ f: \Omega \to \C: z\mapsto f(z) = \int_0^1F(z,s)\diff{s} \]
is holomorphic.
\end{proposition}

\begin{proposition}[Runge's approximation theorem]
Let $K\subseteq \C$ be compact.
\begin{enumerate}
\item Any function holomorphic in a neighbourhood of $K$ can be approximated uniformly on $K$ by rational functions whose singularities are in $K^c$.
\item If $K^c$ is connected, then the approximating functions can be taken to be polynomials.
\item If $K^c$ is not connected, then there exists a function $f$ holomorphic on a neighbourhood of $K$ that cannot be approximated uniformly by polynomials on $K$.
\end{enumerate}
\end{proposition}
If inner and outer part of annulus then Laurent series (i.e.\ particular form of approximating rationals)

\section{Singularities}
\subsection{Laurent series}
\begin{proposition}
Let $f:\Omega \to \C$ be a holomorphic function and let $\Omega$ contain two concentric circles with center $z_0$ and radii $0<r< R$. Then $f$ has a Laurent expansion
\[ f(z) = \sum_{n=-\infty}^{\infty}a_n(z-z_0)^n \]
that converges on the annulus between the concentric circles.
\end{proposition}
\begin{proof}
Call the outer circle $C_1$ and the inner $C_2$. Then we can use the integral formula to write
\[ f(z) = \frac{1}{2\pi i}\oint_{C_1}\frac{f(\zeta)}{\zeta - z}\diff{\zeta} - \frac{1}{2\pi i}\oint_{C_2}\frac{f(\zeta)}{\zeta - z}\diff{\zeta} \]
TODO
\end{proof}

\subsection{Isolated singularities}

\subsection{Non-isolated singularities}

\section{Meromorphic functions}
\subsection{Zeros and poles}
\begin{lemma} \label{holomorphicZeroLemma}
Let $f:\Omega\to \C$ be a holomorphic function on an open set $\Omega$ that has a zero at $z_0\in \Omega$ and does not vanish identically on $\Omega$. Then there exists an open neighbourhood $U\subseteq \Omega$ of $z_0$ such that
\[ f|_U(z) = (z-z_0)^ng(z) \]
for all $z\in U$, some holomorphic $g:U\to \C\setminus\{0\}$ and $n\in \N$.

Additionally, the $n$ is uniquely determined by $f$ and $z_0$; it is independent of $U$.
\end{lemma}
\begin{proof}
TODO
\end{proof}

\begin{definition}
Let $f:\Omega\to \C$ be a function on an open set $\Omega$.
\begin{itemize}
\item If $f$ is holomorphic with a zero at $z_0$, the $n$ in \ref{holomorphicZeroLemma} is called the \udef{multiplicity} or \udef{order} of the zero $z_0$.
\item If $\lim_{z\to z_0} 1/f(z) = 0$ and is $1/f$ holomorphic in a neighbourhood of $z_0$, then $z_0$ is called a \udef{pole} of $f$. The $n$ in the expansion \ref{holomorphicZeroLemma} of $1/f$ is called the \udef{multiplicity} or \udef{order} of the pole $z_0$.
\end{itemize}
If $n = 1$, we call the zero or pole \udef{simple}. 
\end{definition}

Poles lie in $\overline{\Omega}\setminus\Omega$. TODO sort out definition meromorphic function.

\begin{lemma}
Let $f:\Omega\to \C$ be a function on an open set $\Omega$ that has a pole at $z_0\in \overline{\Omega}$. Then there exists a neighbourhood $U$ of $z_0$ such that $f$ is holomorphic on $U\setminus\{z_0\}$.
\end{lemma}
This means a pole in necessarily an isolated singularity (TODO ref later)

\begin{definition}
Let $f: \Omega\subseteq \C \to \C$ be a function. We call $f$ \udef{meromorphic} if either $f$ or $1/f$ is holomorphic at each point $z\in \Omega$.
\end{definition}

\begin{lemma}
Let $f: \Omega\subseteq \C \to \C$ be a function. Then $f$ is meromorphic \textup{if and only if} for each point $z\in \Omega$, either $f$ is holomorphic or $z$ is a pole.
\end{lemma}

\subsection{Laurent series and residues}
\begin{proposition}
Let $f:\Omega\to \C$ be a function on an open set $\Omega$ that has a pole of order $n$ at $z_0$, then the Laurent series of $f$ at $z_0$ is of the form
\[  f(z) = \sum_{i=-n}^\infty a_i(z-z_0)^i \]
and converges on a punctured disk $B(z_0, \epsilon)\setminus\{z_0\}$.
\end{proposition}
\begin{proof}
By \ref{holomorphicZeroLemma} we have that 
\[ (1/f)|_{B(z_0,\epsilon)}(z) = (z-z_0)^ng(z) \]
for some holomorphic, non-vanishing $g$. Thus $f|_{B(z_0,\epsilon)}(z) = (z-z_0)^{-n}1/g(z)$. Now $1/g$ is holomorphic, so we can expand it as a power series. This makes the product a Laurent series starting at $-n$.

To conclude, we remark that the inner radius of the annulus on which the Laurent series converges is zero: by \ref{LaurentSeriesConvergence}
\[ r = \limsup_{i\to\infty}\left(|a_{-i}|^{1/i}\right) = 0. \]
\end{proof}
TODO: pole iff Laurent series has finite principal part!

\subsubsection{Partial fraction decomposition}
\begin{proposition}[Partial fraction decomposition] \label{partialFractionDecomposition}
Let $f: \Omega\subseteq \C \to \C$ be a meromorphic function with finitely many poles $z_0, \ldots z_n$. Let $P_{z_k}(z)$ be the principal part of the Laurent expansion around $z_k$. Then we have the decomposition
\[ f(z) = \sum_{k=0}^nP_k(z) + F(z) \]
where $F(z)$ is a holomorphic function.
\end{proposition}
\begin{proof}
The function $F(z) = f(z) - \sum_{k=0}^nP_k(z)$ has no poles and thus is holomorphic. Indeed, for all $z\in\Omega \setminus \{z_0, \ldots z_n\}$, both $f(z)$ and $\sum_{k=0}^nP_k(z)$ are holomorphic, meaning that $F(z)$ is too.

Take some pole $z_k$. Then the Laurent series of $F(z)$ around $z_k$ is of the form
\[ F(z) = P_k(z) + \sum_{i=0}^\infty a_{k,i}(z-z_k)^i - \sum_{j=0}^n P_j(z) = \sum_{i=0}^\infty a_{k,i}(z-z_k)^i - \sum_{\substack{j=0\\ j\neq k}}^n P_j(z), \]
which has no singularity at $z_k$.
\end{proof}

TODO link with integrals of fractional functions.

\subsubsection{Residues}
\begin{definition}
Let $f: \Omega\subseteq \C \to \C$ have a pole at $z_0$. Given the Laurent series expansion
\[  f(z) = \sum_{i=-n}^\infty a_i(z-z_0)^i, \]
the coefficient $a_{-1}$ is called the \udef{residue} at the pole $z_0$. We write $\Res_{z_0}f \defeq a_{-1}$.
\end{definition}

\begin{proposition}
Let $f$ have a pole of order $n$ at $z_0$, then
\[ \Res_{z_0}f = \lim_{z\to z_0}\frac{1}{(n-1)!}\left(\od{}{z}\right)^{n-1}(z-z_0)f(z). \]
\end{proposition}
\begin{proof}
This follows straight from the series expansion
\[ (z-z_0)^nf(z) = a_{-n} + a_{-n+1}(z-z_0) + \ldots + a_{-1}(z-z_0)^{n-1} + a_0(z-z_0)^n + \ldots \]
\end{proof}
\begin{corollary}
If $f$ has a simple pole at $z_0$, then $\Res_{z_0} f = \lim_{z\to z_0}(z-z_0)f(z)$.
\end{corollary}

\begin{proposition}
Let $f: \Omega\subseteq \C\to \C$ be a meromorphic function that has one pole at $z_0$. Let $\gamma$ be a simple curve such that $z_0\in \int\gamma \subseteq \Omega$. Then
\[ \oint_\gamma f(z) \diff{z} = 2\pi i \Res_{z_0}f. \]
\end{proposition}
\begin{proof}
By truncated Laurent expansion. TODO
\end{proof}
\begin{corollary}[Residue formula]
Let $f: \Omega\subseteq \C\to \C$ be a meromorphic function and $\gamma$ a simple curve that encompasses $N$ poles $z_1, \ldots, z_N$. Then
\[ \oint_{\gamma} f(z)\diff{z} = 2\pi i \sum_{k=1}^N\Res_{z_k}f. \]
\end{corollary}

\subsection{The argument principle}
\begin{proposition}[Argument principle]
Let $f$ be a meromorphic function in an open set containing a simple curve $\gamma$ and its interior. Assume $f$ has no poles or zeros on $\gamma$. Then
\[ \frac{1}{2\pi i}\oint_\gamma \frac{f'(z)}{f(z)}\diff{z} = \text{number of zeros of $f$ inside $\gamma$} \;-\; \text{number of poles of $f$ inside $\gamma$} \]
where the poles and zeros are counted with their multiplicities.
\end{proposition}
\begin{proof}
TODO
\end{proof}

\begin{theorem}[Rouché's theorem]
Let $f$ and $g$ be holomorphic functions on an open set that contains a closed simple curve $\gamma$ and its interior. If
\[ |f(z)| > |g(z)| \qquad \forall z\in \gamma, \]
then $f$ and $f+g$ have the same number of zeros inside $\gamma$.
\end{theorem}
\begin{proof}
For $t\in [0, 1]$ we define
\[ f_t(z) = f(z) + tg(z). \]
This means $f_0 = f$ and $f_1 = f+g$. The condition $|f(z)| > |g(z)|$ ensures that $f_t$ has no zeros on $\gamma$. Also $f_t$ is holomorphic and thus has no poles. So the number of zeros $n_t$ of $f_t$ inside $\gamma$ is given by
\[ n_t = \frac{1}{2\pi i}\oint_\gamma \frac{f_t'(z)}{f_t(z)}\diff{z}. \]
It is then enough to observe that $n_t$ is continuous as a real function of $t$.
\end{proof}
\begin{corollary}[Open mapping theorem]
If $f$ is holomorphic and non-constant, then it is an open map.
\end{corollary}
\begin{proof}
TODO
\end{proof}

\begin{proposition}[Maximum modulus principle]
If $f$ is a non-constant holomorphic function in a simply connected region $\Omega$, then $|f(z)|$ cannot attain a maximum in $\Omega$.
\end{proposition}
\begin{proof}
TODO
\end{proof}
\begin{corollary}
Let $\Omega$ be a simply connected open set with compact closure $\overline{\Omega}$. If $f$ is holomorphic on $\Omega$ and continuous on $\overline{\Omega}$, then
\[ \sup_{z\in \Omega}|f(z)| \leq \sup_{z\in \overline{\Omega}\setminus\Omega}|f(z)|. \]
\end{corollary}

\subsection{The ring of polynomials over $\meromorphic_\Omega$}

\begin{definition}
Let $\Omega\subseteq \C$ be an open set. Let $\meromorphic_\Omega$ be the set of meromorphic functions in $(Omega \to \C)$.
\end{definition}

\begin{proposition}
For any $\Omega \subseteq \C$, the set $\meromorphic_\Omega$ is a field. With
\begin{itemize}
\item as zero the constant function $\underline{0}$;
\item as identity the constant function $\underline{1}$.
\end{itemize}
\end{proposition}

\subsubsection{Poles and roots}
\begin{definition}
We say a polynomial in $\meromorphic_\Omega[X]$ has a pole at $z\in \Omega$, if one of its coefficients has a pole at $z$.
\end{definition}

\begin{lemma} \label{polesProductPolynomial}
Let $p,q\in \meromorphic_\Omega[X]$ be monic and $r = pq$. If either $p$ or $q$ has a pole at $z_0\in \Omega$, then $r$ has a pole at $z_0$ as well.
\end{lemma}
\begin{proof}
Let $h$ be the maximal order of $z_0$ as a pole among the coefficients of $p$ and $k$ the maximal order of $z_0$ as a pole among the coefficients of $q$. Then both $\lim_{z\to z_0}(z-z_0)^h p(z)$ and $\lim_{z\to z_0}(z-z_0)^k q(z)$ are non-zero polynomials (due to being monic) with constant coefficients and $h+k \geq 1$. 

Now assume $r(z)$ is holomorphic at $z_0$, then
\[ 0 = \lim_{z\to z_0}(z-z_0)^{h+k}r(z) = \Big(\lim_{z\to z_0}(z-z_0)^h p(z)\Big)\Big(\lim_{z\to z_0}(z-z_0)^k q(z)\Big) \neq 0, \]
which is a contradiction.
\end{proof}
\begin{corollary}
Let $p \in \meromorphic_\Omega[x]$ be monic and have a prime decomposition $p = \prod_{k=1}^nq_k^{m_k}$. Then $z_0\in \Omega$ is a pole of $p(z)$ \textup{if and only if} it is a pole of one of the $q_k(z)$.
\end{corollary}

\begin{proposition}
Let $p,q\in \meromorphic_\Omega[x]$ be monic and relatively prime, then $p(z)$ and $q(z)$ are relatively prime as polynomials in $\C[X]$ for all $z\in \Omega \setminus (S_p \cup S_q \cup H)$, where
\begin{itemize}
    \item $S_p$ is the set of poles of $p$;
    \item $S_q$ is the set of poles of $q$;
    \item $H$ is isolated and closed in $\Omega$.
\end{itemize}
\end{proposition}
\begin{proof}
By Bézout's identity, we can write $\alpha[x](z)p[x](z) + \beta[x](z)q[x](z) = f(z)$ for some monic $\alpha,\beta\in \meromorphic_\Omega[x]$. Let $H$ be the set of poles and zeros of $f(z)$ (which contains $S_p \cup S_q$ by \ref{polesProductPolynomial}). For all $z_0\notin H$ we have
\[ \left(\frac{\alpha[x](z_0)}{f(z_0)}\right)p[x](z_0) + \left(\frac{\beta[x](z_0)}{f(z_0)}\right)q[x](z_0) = 1, \]
meaning $p[x](z_0)$ and $q[x](z_0)$ are relatively prime (TODO ref).
\end{proof}
\begin{corollary}
Let $p\in \meromorphic_\Omega[x]$ be monic and irreducible. Then $p(z)$ has simple roots for all $z\in\Omega\setminus H$ for some isolated and closed set $H\subseteq \Omega$.
\end{corollary}
\begin{proof}
If the degree of $p$ is $1$, then the result is immediate. Assume the degree of $p$ is greater than $1$.

For any $z\in \Omega$, any non simple root of $p[x](z)$ must also be a root of $\pd{p[x](z)}{x}$. As $p[x]$ is irreducible, $p[x]$ and $\pd{p[x]}{x}$ are relatively prime. By the proposition $p[x](z_0)$ and $\pd{p[x](z_0)}{x}$ are relatively prime for all $z_0\in \Omega\setminus H$, which means they do not share roots.
\end{proof}

\subsubsection{Algebroid functions}

\subsubsection{Puiseux series}

\section{Conformal mappings}

\chapter{Calculus}
\input{calculus}


\chapter{Distributions}
\section{The space of test functions}
\subsection{Canonical LF topology}
\subsubsection{Convergence}
\subsection{The space of test functions}
\begin{definition}
Let $X$ be an open subset of a normed vector space. The space of \udef{test functions} on $X$ is $\cont^\infty_c(X)$ equipped with the canonical LF topology. This space is also commonly denoted $\testFuncs(X)$.
\end{definition}

\begin{example}
The \udef{bump function}
\[ \phi: \R\to\R: x\mapsto \begin{cases}
e^{1/(x^2-1)} & |x|<1 \\ 0 & |x| \geq 1
\end{cases} \]
is a test function in $\testFuncs(\R)$.
\end{example}

\begin{lemma}
Every test function is bounded.
\end{lemma}
\begin{proof}
TODO
\end{proof}

\section{The module of distributions}
\begin{definition}
    Let $X$ be an open subset of a normed vector space.
    A linear map $T: \testFuncs(X) \to \C$ is a \udef{distribution} on $X$ is an element of the topological dual of $\testFuncs(X)$ equipped with the strong dual topology. It is denoted $\dists(X)$.
\end{definition}

\begin{proposition}
    The space of distributions $\dists(X)$ is a module over the ring $\cont^\infty(X)$.
    
    If $T\in \dists(X)$ and $a\in \cont^\infty(X)$, then the multiplication is defined by
    \[ (aT)(\phi) = T(a\phi) \qquad \forall \phi \in \testFuncs(X). \]
\end{proposition}

\subsection{Types of distributions}
\subsubsection{Regular distributions}
\begin{lemma}
Let $X$ be an open subset of a normed vector space and $f: X\to\C$ a locally integrable function in $L^1_\text{loc}(X)$. Then
\[ T_f: \testFuncs(X) \to \C: \phi \mapsto \int_X f(x)\phi(x)\diff{x} \]
is a distribution.
\end{lemma}
\begin{proof}
TODO We just need to show continuity (from boundedness)
\end{proof}

\begin{definition}
Distributions of the form $T_f$ for some $f\in L^1_\text{loc}(X)$ are called \udef{regular distributions}.
\end{definition}


\begin{lemma} \label{uniquenessIntegratedFunction}
Let $f,g: X\to \C$ be locally, absolutely integrable functions. If $T_f = T_g$, then $f(x) = g(x)$ a.e.
\end{lemma}

\subsubsection{Dirac delta distribution}
\begin{definition}
    Let $X$ be an open subset of a normed vector space and $x_0\in X$. The \udef{Dirac delta distribution} at $x_0$ is the distribution
    \[ \delta_{x_0}: \testFuncs(X) \to \C: \phi \mapsto \phi(x_0). \]
    We write $\delta \defeq \delta_0$.
\end{definition}

\begin{proposition}
Let $X$ be an open subset of a normed vector space containing $0$. Suppose $\seq{f_n: X\to \C}$ is a sequence of functions such that
\begin{enumerate}
\item $\int_X f_n(x)\diff{x} = 1$ for all $n$;
\item there exists a constant $C$ such that $\int_X |f_n(x)|\diff{x} \leq C$ for all $n$;
\item $\lim_{n\to \infty} \int_{|x|>r}|f_n(x)|\diff{x} = 0 $ for all $r > 0$.
\end{enumerate}
If $\phi$ is bounded on $X$ and continuous at $0$, then
\[ \lim_{n\to \infty} \int_X f_n(x)\phi(x)\diff{x} = \phi(0) \]
and in particular $f_n\to \delta$ in $\dists(X)$.
\end{proposition}
Notice that the condition of $\phi$ being bounded on $X$ and continuous at $0$ is much less strong than $\phi\in\testFuncs$.
\begin{proof}
TODO + iff? Then we could define delta sequences as sequences that converge to $\delta$.

TODO link with (and formulation of integral mean value theorem)
\end{proof}
Sequences $\seq{f_n}$ satisfying the assumptions of the proposition are called \udef{delta sequences}.

\begin{lemma}
If $f_n$ is such that $\int f_n(x) \diff{x} = 1$ and the support shrinks to zero, then $f_n$ is a delta sequence.
\end{lemma}

\begin{lemma}
Let $f: \R^N\to\C$ be an integrable function with $\int_{\R^N}f(x)\diff{x} = 1$. Then $\seq{n^Nf(nx)}_{n\in \N}$ is a delta sequence.
\end{lemma}

\subsection{The derivative of a distribution}
\begin{definition}
Let $X$ be an open subset of a normed vector space $V$ and let $T\in \dists(X)$. For $u\in V$ we define the directional derivative of $T$ as
\[ \partial_u(T) \defeq - T\circ \partial_u. \]

In particular, if $V = \R$, we define
\[ T' \defeq \od{}{x}(T) \defeq - T\circ \od{}{x}. \]
\end{definition}

\begin{lemma}
Let $T_f$ be an integral distribution such that $\partial_u(f)$ is well-defined on $X$, then
\[ \partial_u(T_f) = T_{\partial_{u}(f)}. \]
\end{lemma}
\begin{proof}
TODO by partial integration.
\end{proof}

\begin{lemma}
Let $X$ be an open subset of $\R^N$ and let $T\in \dists(X)$. Then
\[ D^\alpha T = (-1)^{|\alpha|}T\circ D^\alpha. \]
\end{lemma}

\begin{proposition}
    Let $X$ be an open subset of a normed vector space $V$, $T\in \dists(X)$ and $u\in V$. Then
    \begin{enumerate}
    \item $\partial_{u}T \in \dists(X)$;
    \item $\partial_{u}$ is linear on the module $\dists(X)$.
    \end{enumerate}
\end{proposition}

\begin{proposition}
Let $\theta$ be the Heaviside function. Then
\[ (T_\theta)' = \delta. \]
\end{proposition}

\subsubsection{Jump discontinuities in integral distributions}
\begin{proposition}
Let $f$ be a function that is $\cont^1$ on $]-\infty, x_0[$ and $]x_0, +\infty[$ for some $x_0\in\R$. Then
the derivative of $f$ as distribution is given by
\[ f' = (f|_{\R\setminus\{x_0\}})' + (\Delta_{x_0}f)\delta_{x_0}. \]
\end{proposition}
Note that if $f$ is continuous at $x_0$, this gives $f' = (f|_{\R\setminus\{x_0\}})'$ as distributions.
\begin{proof}
Let $\phi\in\testFuncs(\R)$. Then we calculate
\begin{align*}
f'(\phi) &= \int_{-\infty}^\infty f(x)\phi'(x)\diff{x} = \int_{-\infty}^{x_0} f(x)\phi'(x)\diff{x} + \int_{x_0}^\infty f(x)\phi'(x)\diff{x} \\
&= \Big[f(x)\phi(x)\Big]_{-\infty}^{x_0} - \int_{-\infty}^{x_0} f'(x)\phi(x)\diff{x} + \Big[f(x)\phi(x)\Big]_{x_0}^{+\infty} - \int_{x_0}^{+\infty} f'(x)\phi(x)\diff{x} \\
&= -\int_{\R\setminus\{x_0\}} f'(x)\phi(x)\diff{x} + \lim_{x\to x_0+}f(x)\phi(x)-\lim_{x\to x_0-}f(x)\phi(x) \\
&= \int_{\R}f|_{\R\setminus\{x_0\}}\phi'(x)\diff{x} + \phi(x_0)\lim_{x\to x_0+}f(x)- \phi(x_0)\lim_{x\to x_0-}f(x) = \int_{\R}(f|_{\R\setminus\{x_0\}})'\phi(x)\diff{x} + (\Delta_{x_0}f)\delta_{x_0}.
\end{align*}
\end{proof}
\begin{corollary}
Let $f$ be a function that is $\cont^1$ on $]-\infty, x_0[$ and $]x_0, +\infty[$ for some $x_0\in\R$. Then
the $k^\text{th}$ derivative of $f$ as distribution is given by
\[ f^{(k)} = (f|_{\R\setminus\{x_0\}})^{(k)} + \sum_{j=0}^{k-1}(\Delta_{x_0}f^{(j)})\delta^{(k-1-j)}_{x_0}. \]
\end{corollary}

\subsection{Convolution}


\section{Sobolev spaces}
TODO: after $L^p$ spaces.
\subsection{Weak and strong derivatives}
\begin{definition}
    Let $X$ be an open subset of a normed vector space, $f\in L^p(X)$ and $D^\alpha$ a derivative on $X$. If there exists $g\in L^q(X)$ such that $D^\alpha T_f = T_g$, then $g$ is the \udef{weak $\alpha$ derivative} of $f$ in $L^q(X)$.
\end{definition}
The weak $\alpha$ derivative is unique if it exists, due to \ref{uniquenessIntegratedFunction}.

The definition of weak derivative translates to the requirement
\[ \int_X f D^\alpha \phi \diff{x} = (-1)^{|\alpha|}\int_X g\phi\diff{x} \qquad \forall \phi\in\testFuncs(X). \]

\begin{definition}
    Let $X$ be an open subset of a normed vector space, $f\in L^p(X)$ and $D^\alpha$ a derivative on $X$. We call $g\in L^q(X)$ a \udef{strong $\alpha$ derivative} if there exists a sequence $\seq{f_n} \subset \cont^\infty(X)$  such that
    \begin{itemize}
    \item $f_n \to f$ in $L^p(X)$; and
    \item $D^{\alpha}f_n \to g$ in $L^q(X)$.
    \end{itemize}
\end{definition}

\begin{theorem}
Let $f\in L^p(X)$. Then $g\in L^q(X)$ is a weak $\alpha$ derivative \textup{if and only if} it is a strong $\alpha$ derivative.
\end{theorem}

\subsection{Sobolev spaces}
\begin{definition}
Let $X$ be an open subset of a normed vector space, $1\leq p \leq \infty$ and $k\in\N$. Then the \udef{Sobolev space} $W^{k,p}(X)$ is defined as
\[ W^{k,p}(X) \defeq \setbuilder{T\in \dists(X)}{\text{$T$ has a weak $\alpha$ derivative in $L^p(X)$ for all $|\alpha|\leq k$}}.
 \]
\end{definition}
In particular each distribution in $W^{k,p}(X)$ is an integral distribution $T_f$ for some $f$ in $L^p(X)$.

\begin{lemma}
    Let $X$ be an open subset of a normed vector space, $1\leq p \leq \infty$ and $k\in\N$. Then
    \[ \testFuncs(X) \subset W^{k,p}(X) \subset L^p(X), \]
    so that $W^{p,k}(X)$ is a dense subspace of $L^p(X)$.
\end{lemma}

\begin{proposition}
A Sobolev space $W^{k,p}(X,\diff{\mu})$ is a Banach space with norm
\[ \norm{f}_{W^{k,p}(X,\diff{\mu})} = \begin{cases}
\left(\sum_{|\alpha|\leq k}\norm{D^\alpha f}^p_{L^{p}(X, \diff{\mu})}\right)^{1/p} & 1\leq p < \infty \\
\max_{|\alpha|\leq k} \norm{D^\alpha f}_{L^{\infty}(X, \diff{\mu})} & p = \infty.
\end{cases} \]
If the measure is clear, we may also write $W^{k,p}(X)$.

In particular $W^{k,2}(X, \diff{\mu})$ is a Hilbert space with inner product
\[ \inner{f,g} \sum_{|\alpha| \leq k} \int_X D^\alpha f(x) \overline{D^\alpha g(x)}\diff{\mu(x)}. \]
The Hilbert space $W^{k,2}(X, \diff{\mu})$ is more commonly denoted $H^k(X, \diff{\mu})$.
\end{proposition}
TODO: alternative definition: use ordinary derivative and take completion???

\begin{proposition}
Let $X$ be an open subset of a normed vector space, $1\leq p < \infty$ and $k\in\N$. Then $W^{k,p}(X)$ coincides with the closure of $\cont^\infty(X) \cap W^{k,p}(X)$ in the $W^{k,p}(X)$-norm.
\end{proposition}

\begin{definition}
Let $X$ be an open subset of a normed vector space, $1\leq p < \infty$ and $k\in\N$. We define $W_0^{k,p}(X)$ to be the closure of $\cont^\infty_c(X)$ in the $W^{k,p}(X)$-norm.
\end{definition}